<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>Eliminar foto con sonata_type_colletion</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                                                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="Eliminar foto con sonata_type_colletion">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-4-2" class="forum forum_discussion"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                    <div class="module module-ad module-ad-responsive module-ad-top">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>


    <div itemscope="" itemtype="http://schema.org/Article">
        <div id="discussion" class="col-sm-9 ">
            <h1 class="title" itemprop="name">Eliminar foto con sonata_type_colletion</h1>

            <div id="discussion-content" itemprop="description">
                <p>Muy buenas,</p>
<p>La verdad es que ya no puedo más con esto, me tiene un poco desesperado.</p>
<p>Mi problema es que en el administrador con <code>SonataAdminBundle</code> no puede eliminar ningún campo de la base de datos imágenes y lo más que me mosquea es que tengo otro hecho igual con vídeos y funciona correctamente. Bueno en el de vídeo son solamente enlaces a YouTube, pero es lo mismo. Porque aunque no me eliminara la foto de la carpeta, me podría eliminar el registro.</p>
<p>Expongo mi código haber si me podéis sacar de este aprieto que llevo tres días, para esto leyendo, probando y probando.</p>
<p>Tengo dos entidades una foto y otra messages.</p>
<p>Entidad Fotos:</p>
<pre class="php code"><span class="co4">/**
 * Fotos
 *
 * @ORM\Table(name=&quot;fotos&quot;)
 * @ORM\Entity
 * @ORM\HasLifecycleCallbacks
 */</span>
<span class="kw2">class</span> Fotos
<span class="br0">&#123;</span>
&nbsp;
    <span class="co4">/**
     * @ORM\ManyToOne(targetEntity=&quot;Acme\MessagesBundle\Entity\Messages&quot;, inversedBy=&quot;fotos&quot;)
     * @ORM\JoinColumn(name=&quot;message_id&quot;, referencedColumnName=&quot;id&quot;)
     */</span>
    <span class="kw2">private</span> <span class="re0">$messages</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
<p>Código para FotosAdmin.php</p>
<pre class="php code"><span class="kw2">class</span> FotosAdmin <span class="kw2">extends</span> Admin
<span class="br0">&#123;</span>
    <span class="co4">/**
     * @param FormMapper $formMapper
     */</span>
    <span class="kw2">protected</span> <span class="kw2">function</span> configureFormFields<span class="br0">&#40;</span>FormMapper <span class="re0">$formMapper</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$formMapper</span>
            <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'foto'</span><span class="sy0">,</span> <span class="st_h">'file'</span><span class="sy0">,</span><span class="kw3">array</span><span class="br0">&#40;</span>
                <span class="st_h">'required'</span> <span class="sy0">=&gt;</span> <span class="kw4">false</span><span class="sy0">,</span>
                <span class="st_h">'help'</span> <span class="sy0">=&gt;</span> <span class="re0">$rutaFoto</span><span class="sy0">,</span>
                <span class="st_h">'label'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Foto '</span><span class="sy0">.</span><span class="re0">$numero</span><span class="sy0">.</span><span class="st_h">' '</span><span class="sy0">,</span>
                <span class="st_h">'attr'</span> <span class="sy0">=&gt;</span> <span class="kw3">array</span><span class="br0">&#40;</span>
                    <span class="st_h">'class'</span> <span class="sy0">=&gt;</span> <span class="st_h">'nice_file_field'</span><span class="sy0">,</span>
                    <span class="co1">// 'onchange'=&gt;&quot;readImage(this.form,this)&quot;,</span>
                    <span class="co1">// 'oninvalid'=&gt;&quot;setCustomValidity('Por favor escoge un nombre de usuario valido')&quot;</span>
                <span class="br0">&#41;</span>
            <span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp;
            <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'nombre'</span><span class="sy0">,</span><span class="st_h">'text'</span><span class="sy0">,</span><span class="kw3">array</span><span class="br0">&#40;</span>
                <span class="st_h">'label'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Nombre la foto:'</span><span class="sy0">,</span>
                <span class="st_h">'required'</span> <span class="sy0">=&gt;</span> <span class="kw4">false</span><span class="sy0">,</span>
            <span class="br0">&#41;</span><span class="br0">&#41;</span>
        <span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
<p>Continua en la siguiente respuesta...</p>
            </div>

                            <div id="discussion-tags">
                    <h3>Etiquetas</h3>
                    <ul class="tags-list">
                                                                <li><a href="/foro/bundles/">bundles</a></li>
                                            <li><a href="/foro/sonata/">sonata</a></li>
                                            <li><a href="/foro/sonataadminbundle/">sonataadminbundle</a></li>
                                            <li><a href="/foro/symfony/">symfony</a></li>
                                        </ul>
                </div>
                    </div>

        <div id="discussion-attributes" class="col-sm-3">
            <div class="row">
                <p class="col-xs-3 col-sm-12 avatar">
                    <img width="73" height="73" itemprop="image"
                     src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_bigger.jpeg" />
                </p>

                <p class="col-xs-8 col-sm-12 col-md-12">
                    <span class="login">@jcarlosweb</span>
                    <meta itemprop="author" content="Carlos Campos" />

                    <span class="published">25 de octubre de 2014</span>
                    <meta itemprop="dateCreated" content="2014-10-25T12:31:32+02:00" />
                </p>

                <p id="discussion-actions" class="col-sm-12">
                                    </p>
            </div>
        </div>
    </div>
    
    <div id="discussion-comments" class="col-sm-12">
                    <h2>Respuestas</h2>

                            <div class="row comment"  id="respuesta-1">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-1" title="Enlace permanente a esta respuesta">#1</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_1_html">
                        <p>Continúo con el código, porque me ha dado un error que la pregunta no puede ser tan larga.</p>
<p>Entidad messages:</p>
<pre class="php code"><span class="co4">/**
 * Messages
 *
 * @ORM\Table(name=&quot;messages&quot;)
 * @ORM\Entity
 * @ORM\HasLifecycleCallbacks
 */</span>
&nbsp;
<span class="kw2">class</span> Messages
<span class="br0">&#123;</span>
    <span class="co4">/**
     * @var ArrayCollection $fotos
     *
     * @ORM\OneToMany(
     * targetEntity=&quot;Acme\FotosBundle\Entity\Fotos&quot;,
     * mappedBy=&quot;messages&quot;,
     * cascade={&quot;all&quot;})
     * orphanRemoval=true)
     *@Assert\Valid()
     *
     */</span> 
    <span class="kw2">private</span> <span class="re0">$fotos</span><span class="sy0">;</span>
&nbsp;
    <span class="co4">/**
     * @var ArrayCollection $videos
     *
     * @ORM\OneToMany(
     * targetEntity=&quot;Acme\VideosBundle\Entity\Videos&quot;,
     * mappedBy=&quot;messages&quot;,
     * cascade={&quot;all&quot;},
     * orphanRemoval=true)
     *@Assert\Valid()
     *
     */</span> 
    <span class="kw2">private</span> <span class="re0">$videos</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// ...</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> __construct<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">fotos</span>  <span class="sy0">=</span> <span class="kw2">new</span> ArrayCollection<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">videos</span> <span class="sy0">=</span> <span class="kw2">new</span> ArrayCollection<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// ...</span>
&nbsp;
    <span class="co4">/**
     * Set fotos
     *
     * @param string $fotos
     * @return messages
     */</span>
    <span class="kw2">public</span> <span class="kw2">function</span> setFotos<span class="br0">&#40;</span><span class="re0">$fotos</span> <span class="sy0">=</span> <span class="kw4">null</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="re0">$fotos</span> <span class="kw1">as</span> <span class="re0">$image</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="re0">$image</span><span class="sy0">-&gt;</span><span class="me1">setMessages</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> addFotos<span class="br0">&#40;</span>\Acme\FotosBundle\Entity\Fotos <span class="re0">$fotos</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">if</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">fotos</span><span class="sy0">-&gt;</span><span class="me1">contains</span><span class="br0">&#40;</span><span class="re0">$fotos</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
            <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">fotos</span><span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="re0">$fotos</span><span class="sy0">;</span>
            <span class="re0">$fotos</span><span class="sy0">-&gt;</span><span class="me1">setMessages</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="br0">&#125;</span>
        <span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> removeFotos<span class="br0">&#40;</span>\Acme\FotosBundle\Entity\Fotos <span class="re0">$fotos</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">fotos</span><span class="sy0">-&gt;</span><span class="me1">removeElement</span><span class="br0">&#40;</span><span class="re0">$fotos</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">fotos</span><span class="sy0">-&gt;</span><span class="me1">remove</span><span class="br0">&#40;</span><span class="re0">$fotos</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$fotos</span><span class="sy0">-&gt;</span><span class="me1">setMessages</span><span class="br0">&#40;</span><span class="kw4">null</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$file</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">fotos</span><span class="sy0">-&gt;</span><span class="me1">getUploadRootDir</span><span class="br0">&#40;</span><span class="re0">$id</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw3">unlink</span><span class="br0">&#40;</span><span class="re0">$file</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> removeVideos<span class="br0">&#40;</span>\Acme\VideosBundle\Entity\Videos <span class="re0">$videos</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">videos</span><span class="sy0">-&gt;</span><span class="me1">removeElement</span><span class="br0">&#40;</span><span class="re0">$videos</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
<p>Formulario MessagesAdmin.php para SonataAdmin:</p>
<pre class="php code"><span class="kw2">class</span> MessagesAdmin <span class="kw2">extends</span> Admin
<span class="br0">&#123;</span>
    <span class="co4">/**
     * @param FormMapper $formMapper
     */</span>
    <span class="kw2">protected</span> <span class="kw2">function</span> configureFormFields<span class="br0">&#40;</span>FormMapper <span class="re0">$formMapper</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
&nbsp;
        <span class="co1">// ...</span>
&nbsp;
        <span class="sy0">-&gt;</span><span class="me1">Tab</span><span class="br0">&#40;</span><span class="st_h">'Fotos'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'value'</span><span class="sy0">=&gt;</span><span class="st_h">'Fotos'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>  
            <span class="sy0">-&gt;</span><span class="me1">with</span><span class="br0">&#40;</span><span class="st_h">'Fotos'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
                <span class="st_h">'class'</span>       <span class="sy0">=&gt;</span> <span class="st_h">'col-md-12'</span><span class="sy0">,</span>
                <span class="st_h">'description'</span> <span class="sy0">=&gt;</span> <span class="st_h">''</span><span class="sy0">,</span>
                <span class="st_h">'name'</span>        <span class="sy0">=&gt;</span> <span class="st_h">'Fotos'</span>
            <span class="br0">&#41;</span><span class="br0">&#41;</span>
            <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'fotos'</span><span class="sy0">,</span> <span class="st_h">'sonata_type_collection'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
                <span class="st_h">'by_reference'</span> <span class="sy0">=&gt;</span> <span class="kw4">false</span><span class="sy0">,</span> 
                <span class="co1">//'btn_add' =&gt; false,</span>
                <span class="st_h">'required'</span> <span class="sy0">=&gt;</span> <span class="kw4">false</span><span class="sy0">,</span>
                <span class="st_h">'cascade_validation'</span> <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="sy0">,</span>
                <span class="st_h">'label'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Fotos experiencias'</span><span class="sy0">,</span>
                <span class="st_h">'type_options'</span> <span class="sy0">=&gt;</span> <span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'delete'</span> <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="sy0">,</span><span class="br0">&#41;</span>
            <span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
                <span class="st_h">'edit'</span> <span class="sy0">=&gt;</span> <span class="st_h">'inline'</span><span class="sy0">,</span>
               <span class="co1">// 'inline' =&gt; 'table',</span>
                <span class="st_h">'sortable'</span> <span class="sy0">=&gt;</span> <span class="st_h">'position'</span><span class="sy0">,</span>
            <span class="br0">&#41;</span><span class="br0">&#41;</span>                
            <span class="sy0">-&gt;</span><span class="kw3">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
        <span class="sy0">-&gt;</span><span class="kw3">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp;
    <span class="co1">// ...</span></pre>
<p>Bueno pues cuando marco el checkbox de Delete y lo doy actualizar no hace nada, lo peor de todo es que ni siquiera me da un error. Otra cosa la subida de imagen me va bien.</p>
<p>Pongo una captura de la <a href="http://i.imgur.com/kkqisle.png">imagen del administrador</a>.</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @jcarlosweb
                                </span>

                                <span class="published">
                                    25-oct-14 12:32
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-2">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-2" title="Enlace permanente a esta respuesta">#2</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_2_html">
                        <p>Muy buenas otra vez,</p>
<p>La verdad me gustaría saber si las preguntas que hago son muy obvias o son inutiles.</p>
<p>Ya que al no tener respuesta, no se donde publicarlo y no se quien me podría ayudar. </p>
<p>La unica ayuda que tengo es internet ya que soy autodidacta y Symfony lo estoy aprendiendo así. No si sabeís si para este tipo de preguntas, ¿donde puedo hacerlo?.</p>
<p>Y que me da igual pagar mi unica intencion es aprender.</p>
<p>Un saludo.</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @jcarlosweb
                                </span>

                                <span class="published">
                                    25-oct-14 21:29
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-3">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-3" title="Enlace permanente a esta respuesta">#3</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_3_html">
                        <p>Buenas otra vez,</p>
<p>Ahora sí que me sale error por lo menos. Por lo que se ve no puedo conseguir el <code>id</code> del mensaje relacionado con la foto cuando le doy a eliminar. Me sale el siguiente error:</p>
<pre class="php code">Error<span class="sy0">:</span> Call to a member <span class="kw2">function</span> getId<span class="br0">&#40;</span><span class="br0">&#41;</span> on a non<span class="sy0">-</span>object in <span class="sy0">/</span><span class="kw2">var</span><span class="sy0">/</span>www<span class="sy0">/</span>proyecto<span class="sy0">/</span>src<span class="sy0">/</span>acme<span class="sy0">/</span>FotosBundle<span class="sy0">/</span>Entity<span class="sy0">/</span>Fotos<span class="sy0">.</span>php line <span class="nu0">650</span></pre>
<p>Y la linea 650 es esto donde obtengo la ruta de la foto:</p>
<pre class="php code"><span class="co4">/**
 * Get rutaFoto
 *
 * @return string
 */</span>
<span class="kw2">public</span> <span class="kw2">function</span> getRutaFoto<span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="re0">$ruta</span><span class="sy0">=</span><span class="st0">&quot;fotos/messages/&quot;</span><span class="sy0">.</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getMessages</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">getId</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="st0">&quot;/&quot;</span><span class="sy0">.</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">rutaFoto</span><span class="sy0">;</span>   
&nbsp;
    <span class="kw1">return</span> <span class="re0">$ruta</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
<p>Sabéis porque no puedo conseguir el <code>id</code> en la entidad fotos. La verdad que esto me funciona en todo menos en esto, a la hora de eliminar.</p>
<p>Un saludo.</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @jcarlosweb
                                </span>

                                <span class="published">
                                    24-nov-14 00:02
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-4">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-4" title="Enlace permanente a esta respuesta">#4</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_4_html">
                        <p>Perfecto ya he conseguido sacar el id del mensaje, solamente tenia que crear los setter y getter del campo de relación con el mensaje.</p>
<p>Ahora el problema esta que no se como eliminarlo ya que el problema que tengo no lo puedo solucionar con HasLifecycleCallbacks y PostRemove, ya que esto se ejecuta cuando elimino el mensaje y rollo esta que al administrar el mensaje expongo las fotos y las pre visualizo bien y puedo subir más foto, pero no puedo eliminar, al igual que hago con los videos. Claro los vídeos son campos de textos pero las fotos es solamente un registro que tengo que eliminar de la tabla fotos para eliminar la relación con el mensaje. Es solo eso.</p>
<p>Por ahora he conseguido sacar en el PreUpdate MessagesAdmin.php la foto que viene con la variable delete de esta manera:</p>
<pre class="php code"><span class="kw2">public</span> <span class="kw2">function</span> preUpdate<span class="br0">&#40;</span><span class="re0">$objectif</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
 <span class="re0">$params</span>             <span class="sy0">=</span>  <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getRequest</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">request</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getUniqid</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="re0">$images</span>              <span class="sy0">=</span>  <span class="re0">$params</span><span class="br0">&#91;</span><span class="st_h">'fotos'</span><span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="re0">$images</span> <span class="kw1">as</span> <span class="re0">$key</span><span class="sy0">=&gt;</span><span class="re0">$value</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp;
      <span class="kw1">if</span><span class="br0">&#40;</span><span class="kw3">isset</span><span class="br0">&#40;</span><span class="re0">$images</span><span class="br0">&#91;</span><span class="re0">$key</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="st0">&quot;_delete&quot;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
          <span class="kw1">echo</span> <span class="st0">&quot;yes&quot;</span><span class="sy0">;</span>
<span class="kw3">die</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
<p>Pero el único data que obtengo es esto</p>
<pre class="php code">Content<span class="sy0">-</span>Disposition<span class="sy0">:</span> form<span class="sy0">-</span>data<span class="sy0">;</span> name<span class="sy0">=</span><span class="st0">&quot;s5474db1dc479a[fotos][2][_delete]&quot;</span></pre>
<p>que me lo pasa por Post porque lo he mirado por el Chrome, pero ahora no se como eliminarlo, no tengo ninguna solución ni con HasLifecycleCallbacks ni nada,  ni con la funcion removeFotos de la entidad ni nada.</p>
<p>La verdad estoy haciendo otras cosas de programación, pero llevo ya casi con esto un mes.</p>
<p>Haber si alguien me saca de este embrollo porque la verdad, no se como una cosa tan normal no esta resuelta por ningún sitio.</p>
<p>Gracias!!!</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @jcarlosweb
                                </span>

                                <span class="published">
                                    25-nov-14 20:56
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-5">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-5" title="Enlace permanente a esta respuesta">#5</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_5_html">
                        <p>Buenas,</p>
<p>Prueba a configurar en la asociación OneToMany lo siguiente:</p>
<p><a href="http://doctrine-orm.readthedocs.org/en/latest/reference/working-with-associations.html#orphan-removal">orphan-removal</a></p>
<p>Saludos!</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/454266090743287809/u5bA8gsQ_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @manuel_j555
                                </span>

                                <span class="published">
                                    25-nov-14 21:45
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-6">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-6" title="Enlace permanente a esta respuesta">#6</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_6_html">
                        <p>Gracias @manuel_j555,</p>
<p>Pero ya lo tengo hecho en la entidad <code>Messages.php</code> de este modo</p>
<pre class="php code"><span class="co4">/**
     * @var ArrayCollection $fotos
     *
     * @ORM\OneToMany(
     * targetEntity=&quot;Acme\FotosBundle\Entity\Fotos&quot;,
     * mappedBy=&quot;messages&quot;,
     * cascade={&quot;persist&quot;, &quot;remove&quot;},
     * orphanRemoval=true)
     *@Assert\Valid()
     *
     */</span> 
    <span class="kw2">private</span> <span class="re0">$fotos</span><span class="sy0">;</span>
&nbsp;
  <span class="co1">// continua ...</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> removeFotos<span class="br0">&#40;</span>\Acme\FotosBundle\Entity\Fotos <span class="re0">$fotos</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
&nbsp;
       <span class="kw3">die</span><span class="br0">&#40;</span><span class="st0">&quot;hola&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">fotos</span><span class="sy0">-&gt;</span><span class="me1">removeElement</span><span class="br0">&#40;</span><span class="re0">$fotos</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">fotos</span><span class="sy0">-&gt;</span><span class="me1">remove</span><span class="br0">&#40;</span><span class="re0">$fotos</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$fotos</span><span class="sy0">-&gt;</span><span class="me1">setMessages</span><span class="br0">&#40;</span><span class="kw4">null</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$file</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">fotos</span><span class="sy0">-&gt;</span><span class="me1">getUploadRootDir</span><span class="br0">&#40;</span><span class="re0">$id</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw3">unlink</span><span class="br0">&#40;</span><span class="re0">$file</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
    <span class="br0">&#125;</span></pre>
<p>Pero la función <code>removeFotos</code> ni siquiera si ejecuta ya que no me lanza ni el <code>die()</code>;</p>
<p>Gracias por la ayuda.</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @jcarlosweb
                                </span>

                                <span class="published">
                                    25-nov-14 22:28
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-7">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-7" title="Enlace permanente a esta respuesta">#7</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_7_html">
                        <p>A lo siento, no lo habia visto, bueno prueba a jugar con la opción <a href="http://symfony.com/doc/master/reference/forms/types/collection.html#by-reference">by_reference</a> del tipo collection.</p>
<p>Generalmente con la opción <strong>by_reference</strong> en <strong>false</strong>, lo que se hace es forzar el llamado de los add<em> y remove</em> de la clase padre, en este caso de Messages.</p>
<p>Acá lo explican mejor <a href="http://symfony.com/doc/current/cookbook/form/form_collections.html"><a href="http://symfony.com/doc/current/cookbook/form/form_collections.html">http://symfony.com/doc/current/cookbook/form/form_collections.html</a></a></p>
<p>Saludos!</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/454266090743287809/u5bA8gsQ_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @manuel_j555
                                </span>

                                <span class="published">
                                    26-nov-14 04:45
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-8">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-8" title="Enlace permanente a esta respuesta">#8</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_8_html">
                        <p>@manuel_j555 eres grande!!! Gracias!!!!! Me funciona con <code>'by_reference' =&gt; true</code>, la verdad no entiendo porque me funciona, sinceramente, porque en la llamada en la funcion <code>removeFotos()</code> le tengo puesto <code>die();</code> y no se ejecuta, entonces la verdad no se donde proviene la función que elimina el registro, porque si me gustaría perfilarlo y eliminar la imagen del directorio.</p>
<p>Muchas gracias!!!</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @jcarlosweb
                                </span>

                                <span class="published">
                                    26-nov-14 22:48
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-9">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-9" title="Enlace permanente a esta respuesta">#9</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_9_html">
                        <p>Con by_reference en true?, por defecto está en true, por lo que si lo has puesto como true, realmente no estás haciendo ningún cambio.</p>
<p>Pero en fin, yo creería que el by_reference es más para usarlo en la funcionalidad de agregar que en la de remover, ya que al remover, la clase PersistentCollection fuerza que el elemento removido sea eliminado de la base de datos. uses o no by_reference.</p>
<p>La gracia del by_reference en estos casos es que en true hace algo como:</p>
<pre class="php code"><span class="co1">//para agregar</span>
<span class="re0">$message</span><span class="sy0">-&gt;</span><span class="me1">getFotos</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="re0">$foto</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co1">//para remover</span>
<span class="re0">$message</span><span class="sy0">-&gt;</span><span class="me1">getFotos</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">remove</span><span class="br0">&#40;</span><span class="re0">$foto</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
<p>mientras que en false hace:</p>
<pre class="php code"><span class="co1">//para agregar</span>
<span class="re0">$message</span><span class="sy0">-&gt;</span><span class="me1">addFoto</span><span class="br0">&#40;</span><span class="re0">$foto</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co1">//para remover</span>
<span class="re0">$message</span><span class="sy0">-&gt;</span><span class="me1">removeFoto</span><span class="br0">&#40;</span><span class="re0">$foto</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
<p>Lo que tambien hay que tener en cuenta es si ese método removeFotos lo has creado tú o lo ha creado Symfony con el comando generate entities, ya que cuando el nombre de la propiedad termina con <strong>s</strong> hay casos (mas bien creo que siempre) donde esa s del final es removida. por tanto puede que el método sea <strong>removeFoto</strong> en vez de <strong>removeFotos</strong></p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/454266090743287809/u5bA8gsQ_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @manuel_j555
                                </span>

                                <span class="published">
                                    27-nov-14 02:06
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-10">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-10" title="Enlace permanente a esta respuesta">#10</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_10_html">
                        <p>Hola Manuel,</p>
<p>Gracias de nuevo. Manuel lo tenía en <code>false</code>. Según vi en algunos tutoriales o algunos foros.</p>
<p>Ahora estoy en el trabajo, pero en cuanto llegue a casa ya que Symfony es una cosa propia, lo miro y te comento sobre el caso de la <strong>"s"</strong>.</p>
<p>Muchas gracias de nuevo Manuel.</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @jcarlosweb
                                </span>

                                <span class="published">
                                    27-nov-14 08:58
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-11">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-11" title="Enlace permanente a esta respuesta">#11</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_11_html">
                        <p>Hola de nuevo @manuel_j555,</p>
<p>No encuentro donde se ejecuta la eliminación de la foto, he probado con y sin <strong>"s"</strong> y ademas en todas las entidades que tienen relación con las fotos y añadirle las dos funciones con y sin <strong>s</strong>.</p>
<p>¿Pude ser al ser tipo <code>sonata_type_collection</code> me lo ejecute una función interna de sonata? ¿Cuál puede ser? Esto lo que añado al formulario:</p>
<pre class="php code"><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'fotos'</span><span class="sy0">,</span> <span class="st_h">'sonata_type_collection'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
             <span class="st_h">'by_reference'</span> <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="sy0">,</span> 
             <span class="st_h">'mapped'</span>       <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="sy0">,</span>
             <span class="st_h">'required'</span>     <span class="sy0">=&gt;</span> <span class="kw4">false</span><span class="sy0">,</span>
             <span class="st_h">'cascade_validation'</span> <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="sy0">,</span>
             <span class="st_h">'label'</span> <span class="sy0">=&gt;</span> <span class="st_h">'Fotos experiencias'</span><span class="sy0">,</span>
                <span class="st_h">'type_options'</span> <span class="sy0">=&gt;</span> <span class="kw3">array</span><span class="br0">&#40;</span>
                    <span class="st_h">'delete'</span> <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="sy0">,</span>
                <span class="br0">&#41;</span>
            <span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
                <span class="st_h">'edit'</span> <span class="sy0">=&gt;</span> <span class="st_h">'inline'</span><span class="sy0">,</span>
                <span class="st_h">'sortable'</span> <span class="sy0">=&gt;</span> <span class="st_h">'position'</span><span class="sy0">,</span>
            <span class="br0">&#41;</span><span class="br0">&#41;</span>                
<span class="sy0">-&gt;</span><span class="kw3">end</span><span class="br0">&#40;</span><span class="br0">&#41;</span></pre>
<p>Gracias y un abrazo!!</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @jcarlosweb
                                </span>

                                <span class="published">
                                    27-nov-14 21:48
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-12">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-12" title="Enlace permanente a esta respuesta">#12</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_12_html">
                        <p>Hola,</p>
<p>Con el <code>'by_reference' =&gt; true</code>, no va a llamar nunca a el <code>removeFoto</code> de la entidad. Debe estar en <code>false</code> para que lo haga, por lo que te recomiendo que pruebes lo de la <code>s</code> con el <code>'by_reference' =&gt; false</code>.</p>
<p>Una mejor opción sería eliminar esos métodos <code>add</code> y <code>remove</code> de la entidad, y ejecutar el comando de consola <code>doctrine:generate:entities Bundle:Message</code> para que el framework te los genere correctamente.</p>
<p>Por otro lado, puedes crear un callback en la entidad <code>\Acme\FotosBundle\Entity\Fotos</code> para el evento <code>PostRemove</code> de Doctrine:</p>
<pre class="php code"><span class="co4">/**
 * @ORM\PostRemove()
 */</span>
<span class="kw2">public</span> <span class="kw2">function</span> removeImage<span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="co1">// aquí la lógica para eliminar la imagen.</span>
<span class="br0">&#125;</span></pre>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/454266090743287809/u5bA8gsQ_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @manuel_j555
                                </span>

                                <span class="published">
                                    28-nov-14 16:19
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-13">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-13" title="Enlace permanente a esta respuesta">#13</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_13_html">
                        <p>Manuel tenias totalmente la razón. He aprendido mucho de esta lección que me has dado. Al final he generado de nuevo los <em>getter</em> y <em>setter</em>. Y si eran si la <strong>"s"</strong> y yo lo había puesto a mano. Luego elimino el registro del foto perfectamente y con <code>PostRemove</code> lo elimino del directorio.</p>
<p>Ahora no me gustaría abusar de tu ayuda, pero tengo un problema todavía con las colecciones: cuando le doy botón de <strong>"Añadir nueva foto"</strong> y examino la foto y luego sin actualizar el mensaje le doy añadir de nuevo <strong>"Añadir nueva foto"</strong> y se pierde el valor de de la primera <code>collection</code> que he añadido, tengo que volver a examinar la foto para que suba la foto correctamente.</p>
<p>¿Sabes a que puede ser debido?</p>
<p>Solamente decirte que muchas gracias, creo que sin ti nunca lo hubiera conseguido.</p>
<p>Un abrazo muy fuerte @manuel_j555</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @jcarlosweb
                                </span>

                                <span class="published">
                                    29-nov-14 22:57
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-14">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-14" title="Enlace permanente a esta respuesta">#14</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_14_html">
                        <p>De nada hermano :)</p>
<p>Bueno, creo que eso que comentas es JavaScript, por lo que sería bueno que expongas el código para poder ayudarte mejor, aunque creería que mejor te crees un nuevo post para no ligar las cosas.</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/454266090743287809/u5bA8gsQ_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @manuel_j555
                                </span>

                                <span class="published">
                                    01-dic-14 15:39
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-15">
                                        <i id="ultimo"></i>

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/#respuesta-15" title="Enlace permanente a esta respuesta">#15</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_15_html">
                        <p>Gracias Hermano. Eso haré.</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/378800000671629645/105b0de4571b8ae8926424f14c6c8509_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @jcarlosweb
                                </span>

                                <span class="published">
                                    02-dic-14 11:12
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                    
                    <div id="btn-reply">
                <a rel="nofollow" href="/foro/pregunta/329/eliminar-foto-con-sonata-type-colletion/responder/#tu-respuesta" class="btn btn-lg">
                    Responder pregunta
                </a>
            </div>
            </div>


                </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
