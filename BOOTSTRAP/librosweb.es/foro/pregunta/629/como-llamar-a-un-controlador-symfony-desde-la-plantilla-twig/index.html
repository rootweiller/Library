<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>Cómo llamar a un controlador Symfony desde la plantilla Twig</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                                                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="Cómo llamar a un controlador Symfony desde la plantilla Twig">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-4-2" class="forum forum_discussion"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                    <div class="module module-ad module-ad-responsive module-ad-top">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>


    <div itemscope="" itemtype="http://schema.org/Article">
        <div id="discussion" class="col-sm-9 ">
            <h1 class="title" itemprop="name">Cómo llamar a un controlador Symfony desde la plantilla Twig</h1>

            <div id="discussion-content" itemprop="description">
                <p>Hola, estoy aprendiendo poco a poco a usar Symfony y me surge una duda.</p>
<p>Tengo dos tablas:</p>
<ul>
<li>Provincias: nombre, slug.</li>
<li>Localidades: nombre, slug, provincia.</li>
</ul>
<p>La duda es cómo mostrar dentro de una tabla en una plantilla, todas las provincias, además del número de localidades de cada provincia.</p>
<p>En principio sé que es posible que complicando la consulta SQL pueda hacerlo, pero en principio quiero ver otra forma para resolver la duda que tengo.</p>
<p>Veamos:</p>
<p>En una página muestro una tabla con las regiones usando este controlador:</p>
<pre class="php code"><span class="kw2">public</span> <span class="kw2">function</span> provinciasAction<span class="br0">&#40;</span>Request <span class="re0">$request</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
     <span class="re0">$em</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getDoctrine</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">getManager</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
     <span class="re0">$provincias</span> <span class="sy0">=</span> <span class="re0">$em</span><span class="sy0">-&gt;</span><span class="me1">getRepository</span><span class="br0">&#40;</span><span class="st_h">'AdminBundle:Provincia'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">findAllProvincias</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>          
     <span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">render</span><span class="br0">&#40;</span><span class="st_h">'AdminBundle:Default:provincias.html.twig'</span><span class="sy0">,</span><span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'provincias'</span> <span class="sy0">=&gt;</span> <span class="re0">$provincias</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
<p>Y usando esto en la plantilla twig:</p>
<pre class="twig code">...
   <span class="kw6"><span class="br0">&#123;</span>%</span> <span class="kw1">for</span> <span class="re0">provincia</span> <span class="kw5">in</span> <span class="re0">provincias</span> <span class="kw6">%<span class="br0">&#125;</span></span>
   &lt;tr&gt;
      &lt;td&gt;<span class="kw6"><span class="br0">&#123;</span><span class="br0">&#123;</span></span> <span class="re0">provincia</span><span class="re1">.nombre</span> <span class="kw6"><span class="br0">&#125;</span><span class="br0">&#125;</span></span>&lt;/td&gt;   
      &lt;td&gt;<span class="br0">&#123;</span><span class="br0">&#123;</span>provincia<span class="re1">.slug</span><span class="br0">&#125;</span><span class="br0">&#125;</span>&lt;/td&gt;
      &lt;td&gt;***DUDA: NUMERO DE LOCALIDADES***&lt;/td&gt;
   &lt;/tr&gt;
   <span class="kw6"><span class="br0">&#123;</span>%</span> <span class="kw1">endfor</span> <span class="kw6">%<span class="br0">&#125;</span></span></pre>
<p>Cuál sería la mejor solución para hallar el número de localidades de cada provincia y mostrarlo en la plantilla??? Sería llamando a un controlador desde la plantilla?? </p>
<p>GRACIASSSS!!!</p>
            </div>

                            <div id="discussion-tags">
                    <h3>Etiquetas</h3>
                    <ul class="tags-list">
                                                                <li><a href="/foro/doctrine/">doctrine</a></li>
                                            <li><a href="/foro/symfony/">symfony</a></li>
                                            <li><a href="/foro/twig/">twig</a></li>
                                        </ul>
                </div>
                    </div>

        <div id="discussion-attributes" class="col-sm-3">
            <div class="row">
                <p class="col-xs-3 col-sm-12 avatar">
                    <img width="73" height="73" itemprop="image"
                     src="http://pbs.twimg.com/profile_images/650585570/antonio_carvajal_bigger.JPG" />
                </p>

                <p class="col-xs-8 col-sm-12 col-md-12">
                    <span class="login">@antoniocarvajal</span>
                    <meta itemprop="author" content="antoniocarvajal" />

                    <span class="published">4 de junio de 2015</span>
                    <meta itemprop="dateCreated" content="2015-06-04T16:27:00+02:00" />
                </p>

                <p id="discussion-actions" class="col-sm-12">
                                    </p>
            </div>
        </div>
    </div>
    
    <div id="discussion-comments" class="col-sm-12">
                    <h2>Respuestas</h2>

                            <div class="row comment"  id="respuesta-1">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/629/como-llamar-a-un-controlador-symfony-desde-la-plantilla-twig/#respuesta-1" title="Enlace permanente a esta respuesta">#1</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_1_html">
                        <p>Si tienes las relaciones definidas en tus entidades podría quedar así:</p>
<pre class="html5 code">{% for provincia in provincias %}
   <span class="sc2">&lt;<span class="kw2">tr</span>&gt;</span>
      <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span>{{ provincia.nombre }}<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>   
      <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span>{{ provincia.slug }}<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
      <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span>{{ provincia.localidades|length }}<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
   <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
   {% endfor %}</pre>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/2449870750/uiifzw0yni68arskc6k2_normal.png" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @iBet7o
                                </span>

                                <span class="published">
                                    04-jun-15 20:24
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-2">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/629/como-llamar-a-un-controlador-symfony-desde-la-plantilla-twig/#respuesta-2" title="Enlace permanente a esta respuesta">#2</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_2_html">
                        <p>No lo entiendo muy bien. </p>
<p>En la entidad Provincia no hay nada relacionado con las localidades. </p>
<p>Es en la entidad Localidad donde hay una relación 1 a muchos con la entidad Provincia (una localidad solo puede pertenecer a una provincia, pero una provincia puede tener varias localidades)</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/650585570/antonio_carvajal_normal.JPG" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @antoniocarvajal
                                </span>

                                <span class="published">
                                    05-jun-15 09:51
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-3">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/629/como-llamar-a-un-controlador-symfony-desde-la-plantilla-twig/#respuesta-3" title="Enlace permanente a esta respuesta">#3</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_3_html">
                        <p>Vayamos por partes:</p>
<p>1) La respuesta que te indica @iBet7o es la forma correcta de resolver este problema, pero requiere alguna explicación adicional (sigue leyendo al final de este comentario).</p>
<p>2) La solución que proponías tu también se puede hacer, pero en este caso es muy ineficiente y no merece la pena. En cualquier caso, como referencia, te indico que sería así:</p>
<pre class="twig code"><span class="kw6"><span class="br0">&#123;</span>%</span> <span class="kw1">for</span> <span class="re0">provincia</span> <span class="kw5">in</span> <span class="re0">provincias</span> <span class="kw6">%<span class="br0">&#125;</span></span>
   &lt;tr&gt;
      &lt;td&gt;<span class="kw6"><span class="br0">&#123;</span><span class="br0">&#123;</span></span> <span class="re0">provincia</span><span class="re1">.nombre</span> <span class="kw6"><span class="br0">&#125;</span><span class="br0">&#125;</span></span>&lt;/td&gt;   
      &lt;td&gt;<span class="br0">&#123;</span><span class="br0">&#123;</span>provincia<span class="re1">.slug</span><span class="br0">&#125;</span><span class="br0">&#125;</span>&lt;/td&gt;
      &lt;td&gt;<span class="kw6"><span class="br0">&#123;</span><span class="br0">&#123;</span></span> <span class="re0">render</span><span class="br0">&#40;</span>controller<span class="br0">&#40;</span><span class="st0">'AppBundle:Default:localidades'</span>, <span class="br0">&#123;</span><span class="st0">'provincia'</span><span class="sy0">:</span> <span class="re0">provincia</span><span class="re1">.id</span> <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw6"><span class="br0">&#125;</span><span class="br0">&#125;</span></span>&lt;/td&gt;
   &lt;/tr&gt;
<span class="kw6"><span class="br0">&#123;</span>%</span> <span class="kw1">endfor</span> <span class="kw6">%<span class="br0">&#125;</span></span></pre>
<p>Este código ejecuta el controlador <code>localidadesAction($provinciaId)</code> definido en el <code>DefaultController</code> del bundle <code>AppBundle</code>. Aunque este código funciona bien, sería una locura utilizarlo para resolver este problema porque es muy ineficiente.</p>
<hr />
<p>Como te decía antes, la solución propuesta por @iBet7o es la forma correcta de hacerlo. Pero para ello, tienes que configurar bien las relaciones entre las entidades (o sea, entre las tablas de la base de datos). El problema es que todo esto depende de un proyecto ajeno a Symfony llamado Doctrine y cuya documentación deja mucho que desear.</p>
<p>Lo mejor cuando empiezas es fijarte en algún ejemplo práctico. Si quieres, puedes echar un vistazo a la configuración de las entidades del <a href="https://github.com/javiereguiluz/Cupon">proyecto Cupon</a> que publiqué hace un tiempo:</p>
<ul>
<li>Mi <a href="https://github.com/javiereguiluz/Cupon/blob/2.5/src/Cupon/CiudadBundle/Entity/Ciudad.php">entidad Ciudad</a> sería como tu entidad <code>Provincia</code>.</li>
<li>Mi <a href="https://github.com/javiereguiluz/Cupon/blob/2.5/src/Cupon/OfertaBundle/Entity/Oferta.php">entidad Oferta</a> sería como tu entidad <code>Localidad</code>.</li>
</ul>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/1616936371/avatar_normal.png" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @javiereguiluz
                                </span>

                                <span class="published">
                                    05-jun-15 10:15
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-4">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/629/como-llamar-a-un-controlador-symfony-desde-la-plantilla-twig/#respuesta-4" title="Enlace permanente a esta respuesta">#4</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_4_html">
                        <p>Buenos días Javier, en primer lugar agradecerte todo lo que haces respecto a symfony. No te quepa duda que si no fuese por ti estaría empezando con otro Framework o directamente programando mis proyectos a pelo como hasta ahora venía haciendo.</p>
<p>Tengo el proyecto Cupon descargado y funcional en mi servidor local. Al principio lo seguí a través del libro hasta que adquirí algunos conocimientos, pero la necesidad de empezar con mi propio proyecto me hizo abandonar un poco el seguimiento de Cupon y emprender la aventura por mi cuenta. Por cierto, el proyecto en el que lo voy a poner en marcha es en el rediseño de calendarioslaborales.com, que empezó como una tontería para probar cosas de SEO y ya tiene casi 2 millones de visitas al mes.</p>
<p>Volviendo a la duda. Lo he resuelto como comentáis y funciona perfectamente. El problema es que sólo definía la relación <em>MuchosAUno</em> en la entidad Localidad, y me faltaba definir la relacion <em>UnoAMuchos</em> en la Entidad Provincia. Me imagino que esto me pasa por pensar aún en registros de una tabla de base de datos y no en objetos.</p>
<p>Pongo por aquí como lo he hecho por si alguien tiene la misma duda:</p>
<p>En la entidad Provincia:</p>
<pre class="php code"><span class="sy0">.....</span>
    <span class="co4">/**
     * @ORM\OneToMany(targetEntity=&quot;Calendarios\AdminBundle\Entity\Localidad&quot;, mappedBy=&quot;provincia&quot;)
     */</span>
    <span class="kw2">protected</span> <span class="re0">$localidades</span><span class="sy0">;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> __construct<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">localidades</span> <span class="sy0">=</span> <span class="kw2">new</span> ArrayCollection<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> getLocalidades<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">localidades</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="sy0">.....</span></pre>
<p>En la plantilla Twig</p>
<pre class="twig code"><span class="kw6"><span class="br0">&#123;</span>%</span> <span class="kw1">for</span> <span class="re0">provincia</span> <span class="kw5">in</span> <span class="re0">provincias</span> <span class="kw6">%<span class="br0">&#125;</span></span>
&lt;tr&gt;
   &lt;td&gt;<span class="kw6"><span class="br0">&#123;</span><span class="br0">&#123;</span></span> <span class="re0">provincia</span><span class="re1">.nombre</span> <span class="kw6"><span class="br0">&#125;</span><span class="br0">&#125;</span></span>&lt;/td&gt;
   &lt;td&gt;<span class="kw6"><span class="br0">&#123;</span><span class="br0">&#123;</span></span> <span class="re0">provincia</span><span class="re1">.region</span> <span class="kw6"><span class="br0">&#125;</span><span class="br0">&#125;</span></span>&lt;/td&gt;
   &lt;td&gt;<span class="kw6"><span class="br0">&#123;</span><span class="br0">&#123;</span></span> <span class="re0">provincia</span><span class="re1">.localidades</span><span class="sy0">|</span><span class="kw2">length</span> <span class="kw6"><span class="br0">&#125;</span><span class="br0">&#125;</span></span>&lt;/td&gt;
purple&quot;&gt;&lt;i class=&quot;fa fa-edit&quot;&gt;&lt;/i&gt; Editar &lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
<span class="kw6"><span class="br0">&#123;</span>%</span> <span class="kw1">endfor</span> <span class="kw6">%<span class="br0">&#125;</span></span></pre>
<p>De nuevo muchas gracias a ambos!</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/650585570/antonio_carvajal_normal.JPG" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @antoniocarvajal
                                </span>

                                <span class="published">
                                    05-jun-15 11:28
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-5">
                                        <i id="ultimo"></i>

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/629/como-llamar-a-un-controlador-symfony-desde-la-plantilla-twig/#respuesta-5" title="Enlace permanente a esta respuesta">#5</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_5_html">
                        <p>Buenas, como un aporte más me parece importante destacar que el mostrar el número de localidades puede hacer que se ejecute una nueva consulta por cada provincia que sea mostrada, lo cual dependiendo de la cantidad de provincias en el for, puede ser tambien ineficiente.</p>
<p>Para solventar este inconveniente tienes varias opciones:</p>
<p><strong>1.</strong> Crear una consulta personalizada que pida las provincias y sus localidades de una sola vez. Lee <a href="http://librosweb.es/libro/symfony_2_4/capitulo_8/relaciones_y_asociaciones_de_entidades.html#obteniendo_los_objetos_relacionados">Doctrine: Obteniendo objetos relacionados</a></p>
<p><strong>2.</strong> Cambiar la opción <code>fetch</code> de la asociación para que use &quot;EXTRA_LAZY&quot; ya que por defecto la opción <code>fetch</code> es lazy, y con este último valor al hacer un <code>count</code> de la colección de localidades, se ejecuta un sql y la colección de localidades es cargada en la provincia. </p>
<p>Por el contrario con el <code>fetch="EXTRA_LAZY"</code> cuando se hace un <code>count</code> de una colección, Doctrine ejecuta igualmente un sql en la base de datos, pero no para traerse las localidades, sino que solo ejecuta un <code>SELECT COUNT(...</code> de las localidades, lo cual puede ser un poco más óptimo para tus necesidades. Lee la <a href="http://doctrine-orm.readthedocs.org/en/latest/tutorials/extra-lazy-associations.html#enabling-extra-lazy-associations">doc oficial sobre EXTRA_LAZY</a></p>
<hr />
<p>Por último mi recomendación personal es que aunque uses <code>EXTRA_LAZY</code> hagas la consulta de tal manera que te devuelva las localidades ya cargadas y así evitar consultas adicionales al momento de mostrar el número de dichas localidades.</p>
<p>Saludos!</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/454266090743287809/u5bA8gsQ_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @manuel_j555
                                </span>

                                <span class="published">
                                    05-jun-15 13:55
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                    
                    <div id="btn-reply">
                <a rel="nofollow" href="/foro/pregunta/629/como-llamar-a-un-controlador-symfony-desde-la-plantilla-twig/responder/#tu-respuesta" class="btn btn-lg">
                    Responder pregunta
                </a>
            </div>
            </div>


                </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
