<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>Formulario con un select dependiente de una entidad</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                                                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="Formulario con un select dependiente de una entidad">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-4-2" class="forum forum_discussion"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                    <div class="module module-ad module-ad-responsive module-ad-top">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>


    <div itemscope="" itemtype="http://schema.org/Article">
        <div id="discussion" class="col-sm-9 ">
            <h1 class="title" itemprop="name">Formulario con un select dependiente de una entidad</h1>

            <div id="discussion-content" itemprop="description">
                <p>Buenos dias, mi problema es el siguiente:</p>
<p>Tengo una entidad llamada <code>Reserva</code>, que tiene dos entidades, <code>Usuarios</code> e <code>Invitados</code>.</p>
<p>Los invitados están relacionados con los usuarios. La idea es que me muestre los invitados del usuario seleccionado, que no se puede cambiar, asi que no me hace falta AJAX ni nada similar.</p>
<p>Mi duda es, como puedo pasarle la variable <code>usuario</code> a la consulta personalizada de los invitados. No se si me he explicado correctamente, si necesitáis que publique el código, no hay problema.</p>
<p>Saludos</p>
            </div>

                            <div id="discussion-tags">
                    <h3>Etiquetas</h3>
                    <ul class="tags-list">
                                                                <li><a href="/foro/doctrine/">doctrine</a></li>
                                            <li><a href="/foro/formularios/">formularios</a></li>
                                            <li><a href="/foro/php/">php</a></li>
                                            <li><a href="/foro/symfony/">symfony</a></li>
                                        </ul>
                </div>
                    </div>

        <div id="discussion-attributes" class="col-sm-3">
            <div class="row">
                <p class="col-xs-3 col-sm-12 avatar">
                    <img width="73" height="73" itemprop="image"
                     src="http://pbs.twimg.com/profile_images/505328542633037824/zOqj96RK_bigger.jpeg" />
                </p>

                <p class="col-xs-8 col-sm-12 col-md-12">
                    <span class="login">@TsubasaAkai</span>
                    <meta itemprop="author" content="Carlos" />

                    <span class="published">23 de diciembre de 2014</span>
                    <meta itemprop="dateCreated" content="2014-12-23T09:16:52+01:00" />
                </p>

                <p id="discussion-actions" class="col-sm-12">
                                    </p>
            </div>
        </div>
    </div>
    
    <div id="discussion-comments" class="col-sm-12">
                    <h2>Respuestas</h2>

                            <div class="row comment"  id="respuesta-1">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/392/formulario-con-un-select-dependiente-de-una-entidad/#respuesta-1" title="Enlace permanente a esta respuesta">#1</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_1_html">
                        <p>Las dos alternativas más comunes para hacer esto se explican <a href="http://stackoverflow.com/questions/14668900/how-to-load-custom-query-data-in-select-box-in-symfony-2">en esta pregunta de StackOverflow</a>.</p>
<p>La forma más sencilla sería pasar el usuario como opción desde el controlador al crear el formulario:</p>
<pre class="php code"><span class="re0">$form</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">createForm</span><span class="br0">&#40;</span><span class="kw2">new</span> ReservaType<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw2">new</span> Reserva<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
    <span class="st_h">'usuario'</span> <span class="sy0">=&gt;</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">getUser</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
<p>Y luego ya en el formulario utilizas la opción <code>usuario</code> dentro de la consulta para obtener los invitados:</p>
<pre class="php code"><span class="kw2">use</span> Doctrine\ORM\EntityRepository<span class="sy0">;</span>
<span class="co1">// ...</span>
&nbsp;
<span class="re0">$builder</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'invitados'</span><span class="sy0">,</span> <span class="st_h">'entity'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
    <span class="st_h">'class'</span> <span class="sy0">=&gt;</span> <span class="st_h">'AppBundle:Invitado'</span><span class="sy0">,</span>
    <span class="st_h">'query_builder'</span> <span class="sy0">=&gt;</span> <span class="kw2">function</span><span class="br0">&#40;</span>EntityRepository <span class="re0">$er</span><span class="br0">&#41;</span> <span class="kw2">use</span> <span class="br0">&#40;</span><span class="re0">$usuario</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">return</span> <span class="re0">$er</span><span class="sy0">-&gt;</span><span class="me1">createQueryBuilder</span><span class="br0">&#40;</span><span class="st_h">'i'</span><span class="br0">&#41;</span>
            <span class="sy0">-&gt;</span><span class="me1">where</span><span class="br0">&#40;</span><span class="st_h">'i.invitado =:usuario'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">setParameter</span><span class="br0">&#40;</span><span class="st_h">'usuario'</span><span class="sy0">,</span> <span class="re0">$usuario</span><span class="br0">&#41;</span>
            <span class="sy0">-&gt;</span><span class="me1">orderBy</span><span class="br0">&#40;</span><span class="st_h">'i.nombre'</span><span class="sy0">,</span> <span class="st_h">'ASC'</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
<p>La otra forma de hacerlo es más "profesional", pero te costará mucho más trabajo. La idea consiste en definir el formulario como servicio e inyectar en el constructor del formulario el objeto usuario que se utilizará en la consulta.</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/1616936371/avatar_normal.png" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @javiereguiluz
                                </span>

                                <span class="published">
                                    23-dic-14 09:26
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-2">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/392/formulario-con-un-select-dependiente-de-una-entidad/#respuesta-2" title="Enlace permanente a esta respuesta">#2</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_2_html">
                        <p>La cuestion es que mi formulario es un servicio y necesitaria la opcion compleja.</p>
<p>PD: Gracias por responder tan rapido</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/505328542633037824/zOqj96RK_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @TsubasaAkai
                                </span>

                                <span class="published">
                                    23-dic-14 09:30
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-3">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/392/formulario-con-un-select-dependiente-de-una-entidad/#respuesta-3" title="Enlace permanente a esta respuesta">#3</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_3_html">
                        <p>Si tu formulario ya es un servicio, entonces la otra solución no es "la compleja", sino "la correcta". En tu caso ya tienes casi todo el trabajo hecho, sólo te faltaría inyectar el servicio relacionado con el contexto de la seguridad para poder obtener el objeto del usuario y así poder utilizarlo en la consulta.</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/1616936371/avatar_normal.png" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @javiereguiluz
                                </span>

                                <span class="published">
                                    23-dic-14 09:34
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-4">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/392/formulario-con-un-select-dependiente-de-una-entidad/#respuesta-4" title="Enlace permanente a esta respuesta">#4</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_4_html">
                        <p>¿Y eso como lo hago exactamente?</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/505328542633037824/zOqj96RK_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @TsubasaAkai
                                </span>

                                <span class="published">
                                    23-dic-14 09:36
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-5">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/392/formulario-con-un-select-dependiente-de-una-entidad/#respuesta-5" title="Enlace permanente a esta respuesta">#5</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_5_html">
                        <p><strong>1.</strong> Modifica la definición del servicio de tu formulario para añadir la nueva dependencia del servicio <code>security.context</code>:</p>
<pre class="xml code"><span class="sc3"><span class="re1">&lt;services<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;service</span> <span class="re0">id</span>=<span class="st0">&quot;app.form.reserva.type&quot;</span> <span class="re0">class</span>=<span class="st0">&quot;AppBundle\Form\Type\ReservaType&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;tag</span> <span class="re0">name</span>=<span class="st0">&quot;form.type&quot;</span> <span class="re0">alias</span>=<span class="st0">&quot;reserva&quot;</span> <span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;argument</span> <span class="re0">type</span>=<span class="st0">&quot;service&quot;</span> <span class="re0">id</span>=<span class="st0">&quot;security.context&quot;</span> <span class="re2">/&gt;</span></span> <span class="sc-1">&lt;!-- AÑADE ESTA LÍNEA --&gt;</span>
    <span class="sc3"><span class="re1">&lt;/service<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/services<span class="re2">&gt;</span></span></span></pre>
<p><strong>2.</strong> Añade o modifica el constructor de tu formulario para recoger este nuevo servicio que se le pasa al instanciar el formulario:</p>
<pre class="php code"><span class="kw2">namespace</span> AppBundle\Form\Type<span class="sy0">;</span>
&nbsp;
<span class="kw2">use</span> Symfony\Component\Form\AbstractType<span class="sy0">;</span>
<span class="kw2">use</span> Symfony\Component\Form\FormBuilderInterface<span class="sy0">;</span>
<span class="kw2">use</span> Symfony\Component\OptionsResolver\OptionsResolverInterface<span class="sy0">;</span>
<span class="kw2">use</span> Symfony\Component\Security\Core\SecurityContextInterface<span class="sy0">;</span>
<span class="kw2">use</span> Symfony\Component\Security\Core\User\UserInterface<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> ReservaType <span class="kw2">extends</span> AbstractType
<span class="br0">&#123;</span>
    <span class="co4">/**
     * @var UserInterface
     */</span>
    <span class="kw2">private</span> <span class="re0">$user</span><span class="sy0">;</span>
&nbsp;
    <span class="co4">/**
     * @param string $class
     */</span>
    <span class="kw2">public</span> <span class="kw2">function</span> __construct<span class="br0">&#40;</span>SecurityContextInterface <span class="re0">$securityContext</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">user</span> <span class="sy0">=</span> <span class="re0">$securityContext</span><span class="sy0">-&gt;</span><span class="me1">getRequest</span><span class="sy0">-&gt;</span><span class="me1">getUser</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
<p><strong>3.</strong> Usa la nueva propiedad <code>$user</code> para obtener el nombre del usuario (o su login, su email, etc.) para realizar la consulta:</p>
<pre class="php code"><span class="kw2">namespace</span> AppBundle\Form\Type<span class="sy0">;</span>
&nbsp;
<span class="co1">// ...</span>
&nbsp;
<span class="kw2">class</span> ReservaType <span class="kw2">extends</span> AbstractType
<span class="br0">&#123;</span>
    <span class="co1">// ...</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> buildForm<span class="br0">&#40;</span>FormBuilderInterface <span class="re0">$builder</span><span class="sy0">,</span> <span class="kw3">array</span> <span class="re0">$options</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$username</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">user</span><span class="sy0">-&gt;</span><span class="me1">getUsername</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>    
&nbsp;
        <span class="re0">$builder</span><span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'invitados'</span><span class="sy0">,</span> <span class="st_h">'entity'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
            <span class="st_h">'class'</span> <span class="sy0">=&gt;</span> <span class="st_h">'AppBundle:Invitado'</span><span class="sy0">,</span>
            <span class="st_h">'query_builder'</span> <span class="sy0">=&gt;</span> <span class="kw2">function</span><span class="br0">&#40;</span>EntityRepository <span class="re0">$er</span><span class="br0">&#41;</span> <span class="kw2">use</span> <span class="br0">&#40;</span><span class="re0">$username</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="kw1">return</span> <span class="re0">$er</span><span class="sy0">-&gt;</span><span class="me1">createQueryBuilder</span><span class="br0">&#40;</span><span class="st_h">'i'</span><span class="br0">&#41;</span>
                    <span class="sy0">-&gt;</span><span class="me1">where</span><span class="br0">&#40;</span><span class="st_h">'i.invitado =:usuario'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">setParameter</span><span class="br0">&#40;</span><span class="st_h">'usuario'</span><span class="sy0">,</span> <span class="re0">$username</span><span class="br0">&#41;</span>
                    <span class="sy0">-&gt;</span><span class="me1">orderBy</span><span class="br0">&#40;</span><span class="st_h">'i.nombre'</span><span class="sy0">,</span> <span class="st_h">'ASC'</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span><span class="sy0">,</span>
        <span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/1616936371/avatar_normal.png" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @javiereguiluz
                                </span>

                                <span class="published">
                                    23-dic-14 10:30
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-6">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/392/formulario-con-un-select-dependiente-de-una-entidad/#respuesta-6" title="Enlace permanente a esta respuesta">#6</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_6_html">
                        <p>Muchas gracias!</p>
<p>¿Pero con esto obtengo el usuario logeado o el usuario que tengo seleccionado?</p>
<p>Saludos</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/505328542633037824/zOqj96RK_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @TsubasaAkai
                                </span>

                                <span class="published">
                                    23-dic-14 10:47
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-7">
                                        

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/392/formulario-con-un-select-dependiente-de-una-entidad/#respuesta-7" title="Enlace permanente a esta respuesta">#7</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_7_html">
                        <p>Tienes razón: con este código obtienes el usuario <em>logueado</em> y lo que tu quieres es poder seleccionar el usuario que tú quieras. En ese caso es más sencillo, ya que no tienes que inyectar el servicio de seguridad. Simplemente obtén el usuario en el controlador y pásalo como opción del formulario, tal y como se mostraba en el primer ejemplo de esta discusión.</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/1616936371/avatar_normal.png" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @javiereguiluz
                                </span>

                                <span class="published">
                                    23-dic-14 12:17
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                            <div class="row comment"  id="respuesta-8">
                                        <i id="ultimo"></i>

                    <div class="col-sm-1 col-md-1 permalink">
                        <a href="/foro/pregunta/392/formulario-con-un-select-dependiente-de-una-entidad/#respuesta-8" title="Enlace permanente a esta respuesta">#8</a>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-md-8 content" id="comment_8_html">
                        <p>Muchas gracias, al final lo sulucione de esa manera, pero me acabas de resolver un problme futuro.</p>
<p>Muchas gracias!</p>
                    </div>

                    <div class="col-xs-12 col-sm-11 col-sm-offset-1 col-md-3 col-md-offset-0 comment-attributes">
                        <div class="row">
                            <p class="col-xs-2 col-sm-1 col-md-1 avatar">
                                <img width="48" height="48" src="http://pbs.twimg.com/profile_images/505328542633037824/zOqj96RK_normal.jpeg" />
                            </p>

                            <p class="col-xs-9 col-sm-9 col-md-10">
                                <span class="login">
                                    @TsubasaAkai
                                </span>

                                <span class="published">
                                    24-dic-14 10:53
                                </span>
                            </p>

                            <p class="col-sm-4 col-md-12 comment-actions">
                                                            </p>
                        </div>
                    </div>
                </div>
                    
                    <div id="btn-reply">
                <a rel="nofollow" href="/foro/pregunta/392/formulario-con-un-select-dependiente-de-una-entidad/responder/#tu-respuesta" class="btn btn-lg">
                    Responder pregunta
                </a>
            </div>
            </div>


                </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
