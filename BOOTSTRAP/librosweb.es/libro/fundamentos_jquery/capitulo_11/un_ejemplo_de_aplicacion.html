<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>11.2. Un ejemplo de aplicación (Fundamentos de jQuery)</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                                                    <link rel="prev" href="../capitulo_11.html" />
                    <link rel="next" href="../capitulo_11/conclusion.html" />
                <link rel="start" href="/libro/fundamentos_jquery/" />
                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="11.2. Un ejemplo de aplicación (Fundamentos de jQuery)">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-1-2" class="books book_page fundamentos_jquery"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                                    <div id="main" class="col-sm-9">
                        
    
    <div id="book-toc-anchor" class="well visible-xs">
        <a href="#indice">
            <i class="fa fa-book"></i> Ver índice de contenidos del libro
        </a>
    </div>

    <div id="breadcrumb" class="hidden-xs">
        <ol>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libros/" itemprop="url">
                    <span itemprop="title">Libros</span>
                </a>
            </li>

            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/fundamentos_jquery/" itemprop="url">
                    <span itemprop="title">Fundamentos de jQuery</span>
                </a>
            </li>

                    <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/fundamentos_jquery/capitulo_11.html" itemprop="url">
                    <span itemprop="title">Capítulo 11. Eventos personalizados</span>
                </a>
            </li>
        
            <li class="active">
                <span>11.2. Un ejemplo de aplicación</span>
            </li>
        </ol>
    </div>

    <h1 id="un_ejemplo_de_aplicacion" class="title">
        <span>11.2.</span> Un ejemplo de aplicación
    </h1>

    

<p>Para demostrar el poder de los eventos personalizados, se desarrollará una simple herramienta para buscar en Twitter. Dicha herramienta ofrecerá varias maneras para que el usuario realice una búsqueda: ingresando el término a buscar en una caja de texto o consultando los "temas de moda" de Twitter.</p>

<p>Los resultados de cada término se mostrarán en un contenedor de resultados; dichos resultados podrán expandirse, colapsarse, refrescarse y eliminarse, ya sea de forma individual o conjunta.</p>

<div class="figure" id="figure_11_1">
    <img src="/img/fundamentos_jquery/f1101.png" alt="Aplicación que permite buscar en Twitter" />

    <p class="caption"><strong>Figura 11.1</strong> Aplicación que permite buscar en Twitter</p>
</div>


<p>Se empieza con un HTML básico:</p>

<div class="code html">
<pre class="html5"><span class="sc2">&lt;<span class="kw2">h1</span>&gt;</span>Twitter Search<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">h1</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">input</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;button&quot;</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;get_trends&quot;</span></span>
<span class="sc2">    <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;Load Trending Terms&quot;</span> <span class="sy0">/</span>&gt;</span>
&nbsp;
<span class="sc2">&lt;<span class="kw2">form</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">input</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text&quot;</span> <span class="kw3">class</span><span class="sy0">=</span><span class="st0">&quot;input_text&quot;</span></span>
<span class="sc2">        <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;search_term&quot;</span> <span class="sy0">/</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">input</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;submit&quot;</span> <span class="kw3">class</span><span class="sy0">=</span><span class="st0">&quot;input_submit&quot;</span></span>
<span class="sc2">        <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;Add Search Term&quot;</span> <span class="sy0">/</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">form</span>&gt;</span>
&nbsp;
<span class="sc2">&lt;<span class="kw2">div</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;twitter&quot;</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">div</span> <span class="kw3">class</span><span class="sy0">=</span><span class="st0">&quot;template results&quot;</span>&gt;</span>
        <span class="sc2">&lt;<span class="kw2">h2</span>&gt;</span>Search Results for
        <span class="sc2">&lt;<span class="kw2">span</span> <span class="kw3">class</span><span class="sy0">=</span><span class="st0">&quot;search_term&quot;</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">span</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">h2</span>&gt;</span>
    <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">div</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">div</span>&gt;</span></pre>
</div>

<p>El HTML posee un contenedor (#twitter) para el widget, una plantilla para los resultados (oculto con CSS) y un simple formulario en donde el usuario puede escribir el término a buscar.</p>

<p>Existen dos tipos de elementos en los cuales actuar: los contenedores de resultados y el contenedor Twitter.</p>

<p>Los contenedores de resultados son el corazón de la aplicación. Se creará una extensión para preparar cada contenedor una vez que éste se agrega al contenedor Twitter. Además, entre otras cosas, la extensión vinculará los eventos personalizados por cada contenedor y añadirá en la parte superior derecha de cada contenedor botones que ejecutarán acciones. Cada contenedor de resultados tendrá los siguientes eventos personalizados:</p>

<ul>
<li><code>refresh</code> Señala que la información del contenedor se esta actualizando y dispara la petición que busca los datos para el término de búsqueda.</li>
<li><code>populate</code> Recibe la información JSON y la utiliza para rellenar el contenedor.</li>
<li><code>remove</code> Elimina el contenedor de la página luego de que el usuario confirme la acción. Dicha confirmación puede omitirse si se pasa <code>true</code> como segundo argumento del controlador de evento. El evento además elimina el término asociado con el contenedor de resultados del objeto global que contiene los términos de búsqueda.</li>
<li><code>collapse</code> Añade una clase al contenedor, la cual ocultará el resultado a través de CSS. Además cambiará el botón de <em>Colapsar</em> a <em>Expandir</em>.</li>
<li><code>expand</code> Remueve la clase del contenedor que añade el evento collapse. Además cambiará el botón de <em>Expandir</em> a <em>Colapsar</em>.</li>
</ul>

<p>Además, la extensión es responsable de añadir los botones de acciones al contenedor, vinculando un evento click a cada botón y utilizando la clase de cada ítem para determinar qué evento personalizado será ejecutado en cada contenedor de resultados.</p>

<div class="code javascript">
<pre class="javascript">$.<span class="me1">fn</span>.<span class="me1">twitterResult</span> <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span>settings<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="kw1">this</span>.<span class="me1">each</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">var</span> $results <span class="sy0">=</span> $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span><span class="sy0">,</span>
            $actions <span class="sy0">=</span> $.<span class="me1">fn</span>.<span class="me1">twitterResult</span>.<span class="me1">actions</span> <span class="sy0">=</span>
                $.<span class="me1">fn</span>.<span class="me1">twitterResult</span>.<span class="me1">actions</span> <span class="sy0">||</span>
                $.<span class="me1">fn</span>.<span class="me1">twitterResult</span>.<span class="me1">createActions</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span>
            $a <span class="sy0">=</span> $actions.<span class="me1">clone</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">prependTo</span><span class="br0">&#40;</span>$results<span class="br0">&#41;</span><span class="sy0">,</span>
            term <span class="sy0">=</span> settings.<span class="me1">term</span><span class="sy0">;</span>
&nbsp;
        $results.<span class="me1">find</span><span class="br0">&#40;</span><span class="st0">'span.search_term'</span><span class="br0">&#41;</span>.<span class="me1">text</span><span class="br0">&#40;</span>term<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        $.<span class="me1">each</span><span class="br0">&#40;</span>
            <span class="br0">&#91;</span><span class="st0">'refresh'</span><span class="sy0">,</span> <span class="st0">'populate'</span><span class="sy0">,</span> <span class="st0">'remove'</span><span class="sy0">,</span> <span class="st0">'collapse'</span><span class="sy0">,</span> <span class="st0">'expand'</span><span class="br0">&#93;</span><span class="sy0">,</span>
            <span class="kw1">function</span><span class="br0">&#40;</span>i<span class="sy0">,</span> ev<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                $results.<span class="me1">bind</span><span class="br0">&#40;</span>
                    ev<span class="sy0">,</span>
                    <span class="br0">&#123;</span> term <span class="sy0">:</span> term <span class="br0">&#125;</span><span class="sy0">,</span>
                    $.<span class="me1">fn</span>.<span class="me1">twitterResult</span>.<span class="me1">events</span><span class="br0">&#91;</span>ev<span class="br0">&#93;</span>
                <span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
        <span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">// utiliza la clase de cada acción para determinar</span>
        <span class="co1">// que evento se ejecutará en el panel de resultados</span>
        $a.<span class="me1">find</span><span class="br0">&#40;</span><span class="st0">'li'</span><span class="br0">&#41;</span>.<span class="me1">click</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="co1">// pasa el elemento &lt;li&gt; clickeado en la función</span>
            <span class="co1">// para que se pueda manipular en caso de ser necesario</span>
            $results.<span class="me1">trigger</span><span class="br0">&#40;</span>$<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">attr</span><span class="br0">&#40;</span><span class="st0">'class'</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="br0">&#91;</span> $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span> <span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="sy0">;</span>
&nbsp;
$.<span class="me1">fn</span>.<span class="me1">twitterResult</span>.<span class="me1">createActions</span> <span class="sy0">=</span> <span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> $<span class="br0">&#40;</span><span class="st0">'&lt;ul class=&quot;actions&quot; /&gt;'</span><span class="br0">&#41;</span>.<span class="me1">append</span><span class="br0">&#40;</span>
        <span class="st0">'&lt;li class=&quot;refresh&quot;&gt;Refresh&lt;/li&gt;'</span> <span class="sy0">+</span>
        <span class="st0">'&lt;li class=&quot;remove&quot;&gt;Remove&lt;/li&gt;'</span> <span class="sy0">+</span>
        <span class="st0">'&lt;li class=&quot;collapse&quot;&gt;Collapse&lt;/li&gt;'</span>
    <span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="sy0">;</span>
&nbsp;
$.<span class="me1">fn</span>.<span class="me1">twitterResult</span>.<span class="me1">events</span> <span class="sy0">=</span> <span class="br0">&#123;</span>
    refresh <span class="sy0">:</span> <span class="kw1">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
           <span class="co1">// indica que los resultados se estan actualizando</span>
        <span class="kw1">var</span> $this <span class="sy0">=</span> $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">addClass</span><span class="br0">&#40;</span><span class="st0">'refreshing'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        $this.<span class="me1">find</span><span class="br0">&#40;</span><span class="st0">'p.tweet'</span><span class="br0">&#41;</span>.<span class="me1">remove</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        $results.<span class="me1">append</span><span class="br0">&#40;</span><span class="st0">'&lt;p class=&quot;loading&quot;&gt;Loading ...&lt;/p&gt;'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">// obtiene la información de Twitter en formato jsonp</span>
        $.<span class="me1">getJSON</span><span class="br0">&#40;</span>
            <span class="st0">'http://search.twitter.com/search.json?q='</span> <span class="sy0">+</span>
                escape<span class="br0">&#40;</span>e.<span class="me1">data</span>.<span class="me1">term</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">'&amp;rpp=5&amp;callback=?'</span><span class="sy0">,</span>
            <span class="kw1">function</span><span class="br0">&#40;</span>json<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                $this.<span class="me1">trigger</span><span class="br0">&#40;</span><span class="st0">'populate'</span><span class="sy0">,</span> <span class="br0">&#91;</span> json <span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span>
        <span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
&nbsp;
    populate <span class="sy0">:</span> <span class="kw1">function</span><span class="br0">&#40;</span>e<span class="sy0">,</span> json<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">var</span> results <span class="sy0">=</span> json.<span class="me1">results</span><span class="sy0">;</span>
        <span class="kw1">var</span> $this <span class="sy0">=</span> $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        $this.<span class="me1">find</span><span class="br0">&#40;</span><span class="st0">'p.loading'</span><span class="br0">&#41;</span>.<span class="me1">remove</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        $.<span class="me1">each</span><span class="br0">&#40;</span>results<span class="sy0">,</span> <span class="kw1">function</span><span class="br0">&#40;</span>i<span class="sy0">,</span>result<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">var</span> tweet <span class="sy0">=</span> <span class="st0">'&lt;p class=&quot;tweet&quot;&gt;'</span> <span class="sy0">+</span>
                <span class="st0">'&lt;a href=&quot;http://twitter.com/'</span> <span class="sy0">+</span>
                result.<span class="me1">from_user</span> <span class="sy0">+</span>
                <span class="st0">'&quot;&gt;'</span> <span class="sy0">+</span>
                result.<span class="me1">from_user</span> <span class="sy0">+</span>
                <span class="st0">'&lt;/a&gt;: '</span> <span class="sy0">+</span>
                result.<span class="me1">text</span> <span class="sy0">+</span>
                <span class="st0">' &lt;span class=&quot;date&quot;&gt;'</span> <span class="sy0">+</span>
                result.<span class="me1">created_at</span> <span class="sy0">+</span>
                <span class="st0">'&lt;/span&gt;'</span> <span class="sy0">+</span>
            <span class="st0">'&lt;/p&gt;'</span><span class="sy0">;</span>
&nbsp;
            $this.<span class="me1">append</span><span class="br0">&#40;</span>tweet<span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">// indica que los resultados</span>
        <span class="co1">// ya se han actualizado</span>
        $this.<span class="me1">removeClass</span><span class="br0">&#40;</span><span class="st0">'refreshing'</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
&nbsp;
&nbsp;
    remove <span class="sy0">:</span> <span class="kw1">function</span><span class="br0">&#40;</span>e<span class="sy0">,</span> force<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span>
            <span class="sy0">!</span>force <span class="sy0">&amp;&amp;</span>
            <span class="sy0">!</span>confirm<span class="br0">&#40;</span><span class="st0">'Remove panel for term '</span> <span class="sy0">+</span> e.<span class="me1">data</span>.<span class="me1">term</span> <span class="sy0">+</span> <span class="st0">'?'</span><span class="br0">&#41;</span>
        <span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">return</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
        $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">remove</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="co1">// indica que ya no se tendrá</span>
        <span class="co1">// un panel para el término</span>
        search_terms<span class="br0">&#91;</span>e.<span class="me1">data</span>.<span class="me1">term</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
&nbsp;
    collapse <span class="sy0">:</span> <span class="kw1">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">find</span><span class="br0">&#40;</span><span class="st0">'li.collapse'</span><span class="br0">&#41;</span>.<span class="me1">removeClass</span><span class="br0">&#40;</span><span class="st0">'collapse'</span><span class="br0">&#41;</span>
            .<span class="me1">addClass</span><span class="br0">&#40;</span><span class="st0">'expand'</span><span class="br0">&#41;</span>.<span class="me1">text</span><span class="br0">&#40;</span><span class="st0">'Expand'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">addClass</span><span class="br0">&#40;</span><span class="st0">'collapsed'</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="sy0">,</span>
&nbsp;
    expand <span class="sy0">:</span> <span class="kw1">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">find</span><span class="br0">&#40;</span><span class="st0">'li.expand'</span><span class="br0">&#41;</span>.<span class="me1">removeClass</span><span class="br0">&#40;</span><span class="st0">'expand'</span><span class="br0">&#41;</span>
            .<span class="me1">addClass</span><span class="br0">&#40;</span><span class="st0">'collapse'</span><span class="br0">&#41;</span>.<span class="me1">text</span><span class="br0">&#40;</span><span class="st0">'Collapse'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span>.<span class="me1">removeClass</span><span class="br0">&#40;</span><span class="st0">'collapsed'</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span><span class="sy0">;</span></pre>
</div>

<p>El contenedor Twitter, posee solo dos eventos personalizados:</p>

<p><code>getResults</code> Recibe un término de búsqueda y comprueba si ya no existe un contenedor de resultados para dicho término. En caso de no existir, añade un contenedor utilizando la plantilla de resultados, lo configura utilizando la extensión <code>$.fn.twitterResult</code> (mostrada anteriormente) y luego ejecuta el evento refresh con el fin de cargar correctamente los resultados. Finalmente, guarda el término buscado para no tener volver a pedir los datos sobre la búsqueda.</p>

<p><code>getTrends</code> Consulta a Twitter el listado de los 10 primeros "términos de moda", interactúa con ellos y ejecuta el evento <code>getResults</code> por cada uno, de tal modo que añade un contenedor de resultados por cada término.</p>

<p>Vinculaciones en el contenedor Twitter:</p>

<div class="code javascript">
<pre class="javascript">$<span class="br0">&#40;</span><span class="st0">'#twitter'</span><span class="br0">&#41;</span>
    .<span class="me1">bind</span><span class="br0">&#40;</span><span class="st0">'getResults'</span><span class="sy0">,</span> <span class="kw1">function</span><span class="br0">&#40;</span>e<span class="sy0">,</span> term<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="co1">// se comprueba que ya no exista una caja para el término</span>
        <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>search_terms<span class="br0">&#91;</span>term<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">var</span> $this <span class="sy0">=</span> $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="kw1">var</span> $template <span class="sy0">=</span> $this.<span class="me1">find</span><span class="br0">&#40;</span><span class="st0">'div.template'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
            <span class="co1">// realiza una copia de la plantilla</span>
            <span class="co1">// y la inserta como la primera caja de resultados</span>
            $results <span class="sy0">=</span> $template.<span class="me1">clone</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.
                <span class="me1">removeClass</span><span class="br0">&#40;</span><span class="st0">'template'</span><span class="br0">&#41;</span>.
                <span class="me1">insertBefore</span><span class="br0">&#40;</span>$this.<span class="me1">find</span><span class="br0">&#40;</span><span class="st0">'div:first'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>.
                <span class="me1">twitterResult</span><span class="br0">&#40;</span><span class="br0">&#123;</span>
                    <span class="st0">'term'</span> <span class="sy0">:</span> term
                <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
            <span class="co1">// carga el contenido utilizando el evento personalizado &quot;refresh&quot;</span>
            <span class="co1">// vinculado al contenedor de resultados</span>
            $results.<span class="me1">trigger</span><span class="br0">&#40;</span><span class="st0">'refresh'</span><span class="br0">&#41;</span><span class="sy0">;</span>
            search_terms<span class="br0">&#91;</span>term<span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span>
    .<span class="me1">bind</span><span class="br0">&#40;</span><span class="st0">'getTrends'</span><span class="sy0">,</span> <span class="kw1">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="kw1">var</span> $this <span class="sy0">=</span> $<span class="br0">&#40;</span><span class="kw1">this</span><span class="br0">&#41;</span><span class="sy0">;</span>
        $.<span class="me1">getJSON</span><span class="br0">&#40;</span><span class="st0">'http://search.twitter.com/trends.json?callback=?'</span><span class="sy0">,</span> <span class="kw1">function</span><span class="br0">&#40;</span>json<span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="kw1">var</span> trends <span class="sy0">=</span> json.<span class="me1">trends</span><span class="sy0">;</span>
            $.<span class="me1">each</span><span class="br0">&#40;</span>trends<span class="sy0">,</span> <span class="kw1">function</span><span class="br0">&#40;</span>i<span class="sy0">,</span> trend<span class="br0">&#41;</span> <span class="br0">&#123;</span>
                $this.<span class="me1">trigger</span><span class="br0">&#40;</span><span class="st0">'getResults'</span><span class="sy0">,</span> <span class="br0">&#91;</span> trend.<span class="me1">name</span> <span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
            <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Hasta ahora, se ha escrito una gran cantidad de código que no realiza nada, lo cual no esta mal. Se han especificado todos los comportamientos que se desean para los elementos núcleos y se ha creado un sólido marco para la creación rápida de la interfaz.</p>

<p>A continuación, se conecta la caja de búsqueda y el botón para cargar los <em>Temas de moda</em>. En la caja de texto, se captura el término ingresado y se pasa al mismo tiempo que se ejecuta el evento <code>getResults</code>. Por otro lado, haciendo click en el botón para cargar los <em>Temas de moda</em>, se ejecuta el evento <code>getTrends</code>:</p>

<div class="code javascript">
<pre class="javascript">$<span class="br0">&#40;</span><span class="st0">'form'</span><span class="br0">&#41;</span>.<span class="me1">submit</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    e.<span class="me1">preventDefault</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">var</span> term <span class="sy0">=</span> $<span class="br0">&#40;</span><span class="st0">'#search_term'</span><span class="br0">&#41;</span>.<span class="me1">val</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    $<span class="br0">&#40;</span><span class="st0">'#twitter'</span><span class="br0">&#41;</span>.<span class="me1">trigger</span><span class="br0">&#40;</span><span class="st0">'getResults'</span><span class="sy0">,</span> <span class="br0">&#91;</span> term <span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
$<span class="br0">&#40;</span><span class="st0">'#get_trends'</span><span class="br0">&#41;</span>.<span class="me1">click</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    $<span class="br0">&#40;</span><span class="st0">'#twitter'</span><span class="br0">&#41;</span>.<span class="me1">trigger</span><span class="br0">&#40;</span><span class="st0">'getTrends'</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Añadiendo botones con un ID apropiado, es posible remover, colapsar, expandir y refrescar todos los contenedores de resultados al mismo tiempo. Para el botón que elimina el contenedor, notar que se esta pasando <code>true</code> al controlador del evento como segundo argumento, indicando que no se desea una confirmación del usuario para eliminar el contenedor.</p>

<div class="code javascript">
<pre class="javascript">$.<span class="me1">each</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="st0">'refresh'</span><span class="sy0">,</span> <span class="st0">'expand'</span><span class="sy0">,</span> <span class="st0">'collapse'</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="kw1">function</span><span class="br0">&#40;</span>i<span class="sy0">,</span> ev<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    $<span class="br0">&#40;</span><span class="st0">'#'</span> <span class="sy0">+</span> ev<span class="br0">&#41;</span>.<span class="me1">click</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span> $<span class="br0">&#40;</span><span class="st0">'#twitter div.results'</span><span class="br0">&#41;</span>.<span class="me1">trigger</span><span class="br0">&#40;</span>ev<span class="br0">&#41;</span><span class="sy0">;</span> <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
$<span class="br0">&#40;</span><span class="st0">'#remove'</span><span class="br0">&#41;</span>.<span class="me1">click</span><span class="br0">&#40;</span><span class="kw1">function</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>confirm<span class="br0">&#40;</span><span class="st0">'Remove all results?'</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        $<span class="br0">&#40;</span><span class="st0">'#twitter div.results'</span><span class="br0">&#41;</span>.<span class="me1">trigger</span><span class="br0">&#40;</span><span class="st0">'remove'</span><span class="sy0">,</span> <span class="br0">&#91;</span> <span class="kw2">true</span> <span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>



            <div class="module module-ad module-ad-responsive module-ad-bottom">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-pager">
        <ul class="row pager">
            <li class="col-xs-6 previous ">
                                    <a href="../capitulo_11.html">
                        <strong>&larr; Anterior</strong>
                        <small>Capítulo 11. Eventos personalizados</small>
                    </a>
                            </li>

            <li class="col-xs-6 next ">
                                    <a href="../capitulo_11/conclusion.html">
                        <strong>Siguiente &rarr;</strong>
                        <small>11.3. Conclusión</small>
                    </a>
                            </li>
        </ul>
    </div>

                        </div>

                    <div id="sidebar" class="col-sm-3">
                        
            <div class="module module-share">
        <h3>Compartir</h3>
        <ul>
    <li><a id="share_twitter" href="#" title="Compartir en Twitter">Twitter</a></li>
    <li><a id="share_facebook" href="#" title="Compartir en Facebook">Facebook</a></li>
    <li><a id="share_google" href="#" title="Compartir en Google+">Google+</a></li>
</ul>

<script type="text/javascript">
var title    = '{{ item_social_title }}';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) {
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;

            ga('send', 'social', {
                'socialNetwork' : a.id.substr(6),
                'socialAction'  : 'share',
                'socialTarget'  : window.location
            });

            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

    </div>

            <div class="module module-ad module-ad-responsive module-ad-sidebar">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-toc" class="module">
        <a id="indice"></a>

        <h3>Indice de contenidos</h3>
        <ul class="toc text-links">
                                                                                                                                                                            <li class="level-1">
                <span>2.</span> <a href="../capitulo_2.html"> Conceptos Básicos de JavaScript</a>
            </li>
                                                                                                                                                                                                                                                            <li class="level-1">
                <span>3.</span> <a href="../capitulo_3.html"> Conceptos Básicos de jQuery</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>4.</span> <a href="../capitulo_4.html"> El núcleo de jQuery</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>5.</span> <a href="../capitulo_5.html"> Eventos</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>6.</span> <a href="../capitulo_6.html"> Efectos</a>
            </li>
                                                                                                            <li class="level-1">
                <span>7.</span> <a href="../capitulo_7.html"> Ajax</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>8.</span> <a href="../capitulo_8.html"> Extensiones</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>9.</span> <a href="../capitulo_9.html"> Mejorando el rendimiento</a>
            </li>
                                                                                                                                                                                                                                                            <li class="level-1">
                <span>10.</span> <a href="../capitulo_10.html"> Organización del código</a>
            </li>
                                                                                                            <li class="level-1 ">
                <a href="../capitulo_11.html">
                    <span>Capítulo 11.</span> Eventos personalizados
                </a>
            </li>
                                            <li class="level-2 active">
                <a href="../capitulo_11/un_ejemplo_de_aplicacion.html">
                    <span>11.2.</span> Un ejemplo de aplicación
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_11/conclusion.html">
                    <span>11.3.</span> Conclusión
                </a>
            </li>
                        </ul>
    </div>
                    </div>
                            </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
