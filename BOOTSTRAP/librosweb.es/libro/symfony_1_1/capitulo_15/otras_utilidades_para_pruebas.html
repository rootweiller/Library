<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>15.5. Otras utilidades para pruebas (Symfony 1.1, la guía definitiva)</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                                                    <link rel="prev" href="../capitulo_15/recomendaciones_sobre_el_nombre_de_las_pruebas.html" />
                    <link rel="next" href="../capitulo_15/resumen.html" />
                <link rel="start" href="/libro/symfony_1_1/" />
                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="15.5. Otras utilidades para pruebas (Symfony 1.1, la guía definitiva)">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-1-2" class="books book_page symfony_1_1"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                                    <div id="main" class="col-sm-9">
                        
    
    <div id="book-toc-anchor" class="well visible-xs">
        <a href="#indice">
            <i class="fa fa-book"></i> Ver índice de contenidos del libro
        </a>
    </div>

    <div id="breadcrumb" class="hidden-xs">
        <ol>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libros/" itemprop="url">
                    <span itemprop="title">Libros</span>
                </a>
            </li>

            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/symfony_1_1/" itemprop="url">
                    <span itemprop="title">Symfony 1.1, la guía definitiva</span>
                </a>
            </li>

                    <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/symfony_1_1/capitulo_15.html" itemprop="url">
                    <span itemprop="title">Capítulo 15. Pruebas unitarias y funcionales</span>
                </a>
            </li>
        
            <li class="active">
                <span>15.5. Otras utilidades para pruebas</span>
            </li>
        </ol>
    </div>

    <h1 id="otras_utilidades_para_pruebas" class="title">
        <span>15.5.</span> Otras utilidades para pruebas
    </h1>

    

<p>Las herramientas que incluye Symfony para realizar pruebas unitarias y funcionales son suficientes para la mayoría de casos. No obstante, se muestran a continuación algunas técnicas adicionales para resolver problemas comunes con las pruebas automatizadas: ejecutar pruebas en un entorno independiente, acceder a la base de datos desde las pruebas, probar la cache y realizar pruebas de las interacciones en el lado del cliente.</p>

<h3 id="ejecutando_las_pruebas_en_grupos">15.5.1. Ejecutando las pruebas en grupos</h3>

<p>Las tareas <code>test:unit</code> y <code>test:functional</code> ejecutan una sola prueba o un conjunto de pruebas. Sin embargo, si se ejecutan las tareas sin indicar ningún parámetro, se lanzan todas las pruebas unitarias y funcionales del directorio <code>test/</code>. Para evitar el riesgo de <em>intereferencias</em> de unas pruebas a otras, cada prueba se ejecuta en un entorno de ejecución independiente. Además, cuando se ejecutan todas las pruebas, el resultado que se muestra no es el mismo que el que genera cada prueba de forma independiente, ya que en este caso la salida estaría formada por miles de líneas. Lo que se hace es generar una salida resumida especialmente preparada. Por este motivo, la ejecución de un gran número de pruebas utiliza un <em>test harness</em>, que es un framework de pruebas con algunas características especiales. El <em>test harness</em> depende de un componente del framework Lime llamado <code>lime_harness</code>. Como se muestra en el listado 15-32, la salida producida indica el estado de las pruebas archivo por archivo y al final se muestra un resumen de todas las pruebas que se han pasado y el número total de pruebas.</p>

<p><strong>Listado 15-32 - Ejecutando todas las pruebas mediante el <em>test harness</em></strong></p>

<div class="code cli">
<pre class="cli">&gt; php symfony test:all
&nbsp;
unit/miFuncionTest.php.................ok
unit/miSegundaFuncionTest.php..........ok
unit/foo/barTest.php...................not ok
&nbsp;
Failed Test                     Stat  Total   Fail  List of Failed
------------------------------------------------------------------
unit/foo/barTest.php               0      2      2  62 63
Failed 1/3 test scripts, 66.66% okay. 2/53 subtests failed, 96.22% okay.</pre>
</div>

<p>Las pruebas se ejecutan de la misma forma que si se lanzaran una a una, solamente es la salida la que se resume para hacerla más útil. De hecho, la estadística final se centra en las pruebas que no han tenido éxito y ayuda a localizarlas.</p>

<p>Incluso es posible lanzar todas las pruebas de cualquier tipo mediante la tarea <code>test:all</code>, que también hace uso del <em>test harness</em>, como se muestra en el listado 15-33. Una buena práctica consiste en ejecutar esta tarea antes de realizar el paso a producción del nuevo código, ya que asegura que no se ha introducido ningún nuevo error desde la versión anterior.</p>

<p><strong>Listado 15-33 - Ejecutando todas las pruebas de un proyecto</strong></p>

<div class="code cli">
<pre class="cli">&gt; php symfony test:all</pre>
</div>

<h3 id="acceso_a_la_base_de_datos">15.5.2. Acceso a la base de datos</h3>

<p>Normalmente, las pruebas unitarias necesitan acceder a la base de datos. Cuando se llama al método <code>sfTestBrowser::get()</code> por primera vez, se inicializa una conexión con la base de datos. No obstante, si se necesita acceder a la base de datos antes de utilizar <code>sfTestBrowser</code>, se debe inicializar el objeto <code>sfDabataseManager</code> a mano, como muestra el listado 15-34.</p>

<p><strong>Listado 15-34 - Inicializando la base de datos en una prueba</strong></p>

<div class="code php">
<pre class="php"><span class="re0">$databaseManager</span> <span class="sy0">=</span> <span class="kw2">new</span> sfDatabaseManager<span class="br0">&#40;</span><span class="re0">$configuration</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$databaseManager</span><span class="sy0">-&gt;</span><span class="me1">loadConfiguration</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co1">// Opcionalmente, se puede obtener la conexión con la base de datos</span>
<span class="re0">$con</span> <span class="sy0">=</span> Propel<span class="sy0">::</span><span class="me2">getConnection</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Antes de comenzar las pruebas, se suele cargar la base de datos con datos de prueba, también llamados <em>fixtures</em>. El objeto <code>sfPropelData</code> permite realizar esta carga. No solamente es posible utilizar este objeto para cargar datos a partir de un archivo (como con la tarea <code>propel:data-load</code>) sino que también es posible hacerlo desde un array, como muestra el listado 15-35.</p>

<p><strong>Listado 15-35 - Cargando datos en la base de datos desde una prueba</strong></p>

<div class="code php">
<pre class="php"><span class="re0">$data</span> <span class="sy0">=</span> <span class="kw2">new</span> sfPropelData<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// Cargar datos desde un archivo</span>
<span class="re0">$data</span><span class="sy0">-&gt;</span><span class="me1">loadData</span><span class="br0">&#40;</span>sfConfig<span class="sy0">::</span><span class="me2">get</span><span class="br0">&#40;</span><span class="st_h">'sf_data_dir'</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="st_h">'/fixtures/test_data.yml'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// Cargar datos desde un array</span>
<span class="re0">$fixtures</span> <span class="sy0">=</span> <span class="kw3">array</span><span class="br0">&#40;</span>
  <span class="st_h">'Article'</span> <span class="sy0">=&gt;</span> <span class="kw3">array</span><span class="br0">&#40;</span>
    <span class="st_h">'article_1'</span> <span class="sy0">=&gt;</span> <span class="kw3">array</span><span class="br0">&#40;</span>
      <span class="st_h">'title'</span>      <span class="sy0">=&gt;</span> <span class="st_h">'foo title'</span><span class="sy0">,</span>
      <span class="st_h">'body'</span>       <span class="sy0">=&gt;</span> <span class="st_h">'bar body'</span><span class="sy0">,</span>
      <span class="st_h">'created_at'</span> <span class="sy0">=&gt;</span> <span class="kw3">time</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span>
    <span class="br0">&#41;</span><span class="sy0">,</span>
    <span class="st_h">'article_2'</span>    <span class="sy0">=&gt;</span> <span class="kw3">array</span><span class="br0">&#40;</span>
      <span class="st_h">'title'</span>      <span class="sy0">=&gt;</span> <span class="st_h">'foo foo title'</span><span class="sy0">,</span>
      <span class="st_h">'body'</span>       <span class="sy0">=&gt;</span> <span class="st_h">'bar bar body'</span><span class="sy0">,</span>
      <span class="st_h">'created_at'</span> <span class="sy0">=&gt;</span> <span class="kw3">time</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span>
    <span class="br0">&#41;</span><span class="sy0">,</span>
  <span class="br0">&#41;</span><span class="sy0">,</span>
<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$data</span><span class="sy0">-&gt;</span><span class="me1">loadDataFromArray</span><span class="br0">&#40;</span><span class="re0">$fixtures</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Una vez cargados los datos, se pueden utilizar los objetos Propel necesarios como en cualquier aplicación normal. Las pruebas unitarias deben incluir los archivos correspondientes a esos objetos (se puede utilizar la clase <code>sfSimpleAutoload</code> para automatizar la carga, como se explicó en la sección anterior "Stubs, Fixtures y carga automática de clases"). Los objetos de Propel se cargan automáticamente en las pruebas funcionales.</p>

<h3 id="probando_la_cache">15.5.3. Probando la cache</h3>

<p>Cuando se habilita la cache para una aplicación, las pruebas funcionales se encargan de verificar que las acciones guardadas en la cache se comportan como deberían.</p>

<p>En primer lugar, se habilita la cache para el entorno de pruebas (en el archivo <code>settings.yml</code>). Una vez habilitada, se puede utilizar el método <code>isCached()</code> del objeto <code>sfTestBrowser</code> para comprobar si una página se ha obtenido directamente de la cache o ha sido generada en ese momento. El listado 15-36 muestra cómo utilizar este método.</p>

<p><strong>Listado 15-36 - Probando la cache con el método <code>isCached()</code></strong></p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span>
&nbsp;
<span class="kw1">include</span><span class="br0">&#40;</span><span class="kw3">dirname</span><span class="br0">&#40;</span><span class="kw4">__FILE__</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="st_h">'/../../bootstrap/functional.php'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// Create a new test browser</span>
<span class="re0">$b</span> <span class="sy0">=</span> <span class="kw2">new</span> sfTestBrowser<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="re0">$b</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'/mymodule'</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$b</span><span class="sy0">-&gt;</span><span class="me1">isCached</span><span class="br0">&#40;</span><span class="kw4">true</span><span class="br0">&#41;</span><span class="sy0">;</span>       <span class="co1">// Comprueba si la respuesta viene de la cache</span>
<span class="re0">$b</span><span class="sy0">-&gt;</span><span class="me1">isCached</span><span class="br0">&#40;</span><span class="kw4">true</span><span class="sy0">,</span> <span class="kw4">true</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="co1">// Comprueba si la respuesta de la cache incluye el layoutlayout</span>
<span class="re0">$b</span><span class="sy0">-&gt;</span><span class="me1">isCached</span><span class="br0">&#40;</span><span class="kw4">false</span><span class="br0">&#41;</span><span class="sy0">;</span>      <span class="co1">// Comprueba que la respuesta no venga de la cache</span></pre>
</div>

<div class="admonition note"><p><strong class="title">Nota</strong> No es necesario borrar la cache antes de realizar la prueba funcional, ya que el proceso de arranque utilizado por la prueba se encarga de hacerlo automáticamente.</p></div>

<h3 id="probando_las_interacciones_en_el_lado_del_cliente">15.5.4. Probando las interacciones en el lado del cliente</h3>

<p>El principal inconveniente de las técnicas descritas anteriormente es que no pueden simular el comportamiento de JavaScript. Si se definen interacciones muy complejas, como por ejemplo interacciones con Ajax, es necesario reproducir de forma exacta los movimientos del ratón y las pulsaciones de teclado que realiza el usuario y ejecutar los scripts de JavaScript. Normalmente, estas pruebas se hacen a mano, pero cuestan mucho tiempo y son propensas a cometer errores.</p>

<p>La solución a estos problemas se llama Selenium (http://www.openqa.org/selenium/), que consiste en un framework de pruebas escrito completamente en JavaScript. Selenium permite realizar una serie de acciones en la página de la misma forma que las haría un usuario normal. La ventaja de Selenium sobre el objeto <code>sfBrowser</code> es que Selenium es capaz de ejecutar todo el código JavaScript de la página, incluidas las interacciones creadas con Ajax.</p>

<p>Symfony no incluye Selenium por defecto. Para instalarlo, se crea un directorio llamado <code>selenium/</code> en el directorio <code>web/</code> del proyecto y se descomprime el contenido del archivo descargado desde http://www.openqa.org/selenium-core/download.action. Como Selenium se basa en JavaScript y la mayoría de navegadores tienen unas restricciones de seguridad muy estrictas, es importante ejecutar Selenium desde el mismo servidor y el mismo puerto que el que utiliza la propia aplicación.</p>

<div class="admonition note"><p><strong class="title">Nota</strong> Debe ponerse especial cuidado en no subir el directorio <code>selenium/</code> al servidor de producción, ya que estaría disponible para cualquier usuario que acceda a la raíz del servidor desde un navegador web.</p></div>

<p>Las pruebas de Selenium se escriben en HTML y se guardan en el directorio <code>web/selenium/tests/</code>. El listado 15-37 muestra un ejemplo de prueba funcional en la que se carga la página principal, se pulsa el enlace "pinchame" y se busca el texto "Hola Mundo" en el contenido de la respuesta. Para acceder a la aplicación en el entorno <code>test</code>, se debe utilizar el controlador frontal llamado <code>frontend_test.php</code>.</p>

<p><strong>Listado 15-37 - Un ejemplo de prueba de Selenium, en <code>web/selenium/test/testIndex.html</code></strong></p>

<div class="code html5">
<pre class="html5"><span class="sc0">&lt;!DOCTYPE html PUBLIC &quot; *W3C*DTD HTML 4.01 Transitional//EN&quot;&gt;</span>
<span class="sc2">&lt;<span class="kw2">html</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">head</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">meta</span> <span class="kw3">content</span><span class="sy0">=</span><span class="st0">&quot;text/html; charset=UTF-8&quot;</span> <span class="kw3">http-equiv</span><span class="sy0">=</span><span class="st0">&quot;content-type&quot;</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">title</span>&gt;</span>Index tests<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">title</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">head</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">body</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">table</span> <span class="kw3">cellspacing</span><span class="sy0">=</span><span class="st0">&quot;0&quot;</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">tbody</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">tr</span>&gt;&lt;<span class="kw2">td</span> <span class="kw3">colspan</span><span class="sy0">=</span><span class="st0">&quot;3&quot;</span>&gt;</span>First step<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">tr</span>&gt;&lt;<span class="kw2">td</span>&gt;</span>open<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>              <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span>/frontend_test.php/<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span> <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span><span class="sc1">&amp;nbsp;</span><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">tr</span>&gt;&lt;<span class="kw2">td</span>&gt;</span>clickAndWait<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>      <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span>link=pinchame<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>    <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span><span class="sc1">&amp;nbsp;</span><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">tr</span>&gt;&lt;<span class="kw2">td</span>&gt;</span>assertTextPresent<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span> <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span>Hola Mundo<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>    <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span><span class="sc1">&amp;nbsp;</span><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tbody</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">table</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">body</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">html</span>&gt;</span></pre>
</div>

<p>Cada caso de prueba consiste en una página HTML con una tabla de 3 columnas: comando, destino y valor. No obstante, no todos los comandos indican un valor. En caso de que no se utilice un valor, es recomendable incluir el valor <code>&amp;nbsp;</code> en esa columna (para que la tabla se vea mejor). El sitio web de Selenium dispone de la lista completa de comandos que se pueden utilizar.</p>

<p>También es necesario añadir esta prueba al conjunto completo de pruebas, insertando una nueva línea en la tabla del archivo <code>TestSuite.html</code> del mismo directorio. El listado 15-38 muestra cómo hacerlo.</p>

<p><strong>Listado 15-38 - Añadiendo un archivo de pruebas al conjunto de pruebas, en <code>web/selenium/test/TestSuite.html</code></strong></p>

<div class="code html5">
<pre class="html5">...
<span class="sc2">&lt;<span class="kw2">tr</span>&gt;&lt;<span class="kw2">td</span>&gt;&lt;<span class="kw2">a</span> <span class="kw3">href</span><span class="sy0">=</span><span class="st0">'./testIndex.html'</span>&gt;</span>Mi primera prueba<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">a</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
...</pre>
</div>

<p>Para ejecutar la prueba, solamente es necesario acceder a la página:</p>

<div class="code code">
<pre class="code">http://miaplicacion.ejemplo.com/selenium/index.html</pre>
</div>

<p>Si se selecciona la <em>"Main Test Suite"</em> y se pulsa sobre el botón de ejecutar todas las pruebas, el navegador reproducirá automáticamente todos los pasos que se han indicado.</p>

<div class="admonition note"><p><strong class="title">Nota</strong> Como las pruebas de Selenium se ejecutan en el propio navegador, permiten descubrir las inconsistencias entre navegadores. Si se construye la prueba para un solo navegador, se puede lanzar esa prueba sobre todos los navegadores y comprobar su funcionamiento.</p></div>

<p>Como las pruebas de Selenium se crean con HTML, acaba siendo muy aburrido escribir todo ese código HTML. Afortunadamente, existe una extensión de Selenium para Firefox (http://seleniumrecorder.mozdev.org/) que permite <em>grabar</em> todos los movimientos y acciones realizadas sobre una página y guardarlos como una prueba. Mientras se graba una sesión de navegación, se pueden añadir pruebas de tipo asertos pulsando el botón derecho sobre la ventana del navegador y seleccionando la opción apropiada del menún <em>"Append Selenium Command"</em>.</p>

<p>Una vez realizados todos los movimientos y añadidos todos los comandos, se pueden guardar en un archivo HTML para añadirlo al conjunto de pruebas. La extensión de Firefox incluso permite ejecutar las pruebas de Selenium que se han creado con la extensión.</p>

<div class="admonition note"><p><strong class="title">Nota</strong> No debe olvidarse reinicializar los datos de prueba antes de lanzar cada prueba de Selenium.</p></div>



            <div class="module module-ad module-ad-responsive module-ad-bottom">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-pager">
        <ul class="row pager">
            <li class="col-xs-6 previous ">
                                    <a href="../capitulo_15/recomendaciones_sobre_el_nombre_de_las_pruebas.html">
                        <strong>&larr; Anterior</strong>
                        <small>15.4. Recomendaciones sobre el nombre de las pruebas</small>
                    </a>
                            </li>

            <li class="col-xs-6 next ">
                                    <a href="../capitulo_15/resumen.html">
                        <strong>Siguiente &rarr;</strong>
                        <small>15.6. Resumen</small>
                    </a>
                            </li>
        </ul>
    </div>

                        </div>

                    <div id="sidebar" class="col-sm-3">
                        
            <div class="module module-share">
        <h3>Compartir</h3>
        <ul>
    <li><a id="share_twitter" href="#" title="Compartir en Twitter">Twitter</a></li>
    <li><a id="share_facebook" href="#" title="Compartir en Facebook">Facebook</a></li>
    <li><a id="share_google" href="#" title="Compartir en Google+">Google+</a></li>
</ul>

<script type="text/javascript">
var title    = '{{ item_social_title }}';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) {
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;

            ga('send', 'social', {
                'socialNetwork' : a.id.substr(6),
                'socialAction'  : 'share',
                'socialTarget'  : window.location
            });

            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

    </div>

            <div class="module module-ad module-ad-responsive module-ad-sidebar">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-toc" class="module">
        <a id="indice"></a>

        <h3>Indice de contenidos</h3>
        <ul class="toc text-links">
                                            <li class="level-1">
                <span>1.</span> <a href="../capitulo_1.html"> Introducción a Symfony</a>
            </li>
                                                                                            <li class="level-1">
                <span>2.</span> <a href="../capitulo_2.html"> Explorando el interior de Symfony</a>
            </li>
                                                                                                            <li class="level-1">
                <span>3.</span> <a href="../capitulo_3.html"> Ejecutar aplicaciones Symfony</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>4.</span> <a href="../capitulo_4.html"> Introducción a la creación de páginas</a>
            </li>
                                                                                                            <li class="level-1">
                <span>5.</span> <a href="../capitulo_5.html"> Configurar Symfony</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>6.</span> <a href="../capitulo_6.html"> El Controlador</a>
            </li>
                                                                                                                                                                                            <li class="level-1">
                <span>7.</span> <a href="../capitulo_7.html"> La Vista</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>8.</span> <a href="../capitulo_8.html"> El modelo</a>
            </li>
                                                                                                                                                                                            <li class="level-1">
                <span>9.</span> <a href="../capitulo_9.html"> Enlaces y sistema de enrutamiento</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>10.</span> <a href="../capitulo_10.html"> Formularios</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>11.</span> <a href="../capitulo_11.html"> Integración con Ajax</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>12.</span> <a href="../capitulo_12.html"> Uso de la cache</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>13.</span> <a href="../capitulo_13.html"> Internacionalización y localización</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>14.</span> <a href="../capitulo_14.html"> Generador de la parte de administración</a>
            </li>
                                                                                                                            <li class="level-1 ">
                <a href="../capitulo_15.html">
                    <span>Capítulo 15.</span> Pruebas unitarias y funcionales
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_15/automatizacion_de_pruebas.html">
                    <span>15.1.</span> Automatización de pruebas
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_15/pruebas_unitarias.html">
                    <span>15.2.</span> Pruebas unitarias
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_15/pruebas_funcionales.html">
                    <span>15.3.</span> Pruebas funcionales
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_15/recomendaciones_sobre_el_nombre_de_las_pruebas.html">
                    <span>15.4.</span> Recomendaciones sobre el nombre de las pruebas
                </a>
            </li>
                                            <li class="level-2 active">
                <a href="../capitulo_15/otras_utilidades_para_pruebas.html">
                    <span>15.5.</span> Otras utilidades para pruebas
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_15/resumen.html">
                    <span>15.6.</span> Resumen
                </a>
            </li>
                                            <li class="level-1">
                <span>16.</span> <a href="../capitulo_16.html"> Herramientas para la administración de aplicaciones</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>17.</span> <a href="../capitulo_17.html"> Personalizar Symfony</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>18.</span> <a href="../capitulo_18.html"> Rendimiento</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>19.</span> <a href="../capitulo_19.html"> Configuración avanzada</a>
            </li>
                                                                                                        </ul>
    </div>
                    </div>
                            </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
