<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>14.7. Gestores de configuración propios (Más con Symfony)</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                                                    <link rel="prev" href="../capitulo_14/anadiendo_pruebas_unitarias.html" />
                    <link rel="next" href="../capitulo_14/haciendo_uso_de_formularios_embebidos.html" />
                <link rel="start" href="/libro/mas_con_symfony/" />
                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="14.7. Gestores de configuración propios (Más con Symfony)">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-1-2" class="books book_page mas_con_symfony"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                                    <div id="main" class="col-sm-9">
                        
    
    <div id="book-toc-anchor" class="well visible-xs">
        <a href="#indice">
            <i class="fa fa-book"></i> Ver índice de contenidos del libro
        </a>
    </div>

    <div id="breadcrumb" class="hidden-xs">
        <ol>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libros/" itemprop="url">
                    <span itemprop="title">Libros</span>
                </a>
            </li>

            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/mas_con_symfony/" itemprop="url">
                    <span itemprop="title">Más con Symfony</span>
                </a>
            </li>

                    <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/mas_con_symfony/capitulo_14.html" itemprop="url">
                    <span itemprop="title">Capítulo 14. Jugando con la cache de configuración de Symfony</span>
                </a>
            </li>
        
            <li class="active">
                <span>14.7. Gestores de configuración propios</span>
            </li>
        </ol>
    </div>

    <h1 id="gestores_de_configuracion_propios" class="title">
        <span>14.7.</span> Gestores de configuración propios
    </h1>

    

<p>El código mostrado anteriormente recorre, para cada variable que se pasa a la
plantilla, todas las clases de formulario configuradas en <code>forms.yml</code>. Aunque
es una solución que funciona bien, penaliza mucho el rendimiento de la aplicación
cuando se pasan muchos formularios a la plantilla o si se dispone de una lista
muy larga de formularios configurados en el archivo YAML. Se trata de una buena
oportunidad para crear un gestor propio de configuración que permita optimizar
este proceso.</p>

<div class="admonition sidebar"><p><strong class="title">¿Por qué crear un gestor propio?</strong> Desarrollar un gestor propio de configuración no es nada fácil. Como sucede
con cualquier otro generador de código, los gestores de configuración son
propensos a los errores y muy difíciles de probar, pero tienen muchas ventajas.
Crear código ejecutable de forma dinámica es una solución perfecta que combina
la gran flexibilidad de YAML con la extrema rapidez de ejecución del código PHP.
Si además se añade una cache de código (como por ejemplo <a href="http://pecl.php.net/apc">APC</a>
o <a href="http://xcache.lighttpd.net/">XCache</a>) los gestores de configuración son
prácticamente imbatibles por su facilidad de uso y su gran rendimiento.</p></div>

<p>La mayor parte de la <em>magia</em> de los gestores de configuración se produce
internamente. La cache de configuración se encarga de la lógica de la cache antes
de ejecutar el gestor de configuración apropiado, por lo que nos podemos centrar
exclusivamente en generar el código necesario para aplicar la configuración
YAML.</p>

<p>Todos los gestores de configuración deben implementar los siguientes dos métodos:</p>

<ul>
<li><code>static public function getConfiguration(array $configFiles)</code></li>
<li><code>public function execute($configFiles)</code></li>
</ul>

<p>Al primer método, <code>::getConfiguration()</code>, se le pasa un array de rutas de
archivos, para que los procese y junte sus contenidos en un único gran archivo.
En la <code>sfSimpleYamlConfigHandler</code> utilizada anteriormente este método sólo
utiliza una línea:</p>

<div class="code php">
<pre class="php">static <span class="kw2">public</span> <span class="kw2">function</span> getConfiguration<span class="br0">&#40;</span><span class="kw3">array</span> <span class="re0">$configFiles</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="kw1">return</span> <span class="kw2">self</span><span class="sy0">::</span><span class="me2">parseYamls</span><span class="br0">&#40;</span><span class="re0">$configFiles</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>La clase <code>sfSimpleYamlConfigHandler</code> extiende la clase abstracta <code>sfYamlConfigHandler</code>,
que incluye varios métodos útiles para procesar los archivos de configuración
YAML:</p>

<ul>
<li><code>::parseYamls($configFiles)</code></li>
<li><code>::parseYaml($configFile)</code></li>
<li><code>::flattenConfiguration($config)</code></li>
<li><code>::flattenConfigurationWithEnvironment($config)</code></li>
</ul>

<p>Los dos primeros métodos implementan la
<a href="http://www.symfony-project.org/reference/1_2/en/03-Configuration-Files-Principles#chapter_03_configuration_cascade">configuración en cascada</a>.
de Symfony. El segundo implementa el mecanismo de
<a href="http://www.symfony-project.org/reference/1_2/en/03-Configuration-Files-Principles#chapter_03_environment_awareness">configuración basada en entornos</a>.</p>

<p>El método <code>::getConfiguration()</code> de nuestro gestor de configuración necesita un
método propio para unir toda la configuración en un único archivo. Crea un
método llamado <code>::applyInheritance()</code> para encapsular toda esta lógica:</p>

<div class="code php">
<pre class="php">// lib/config/sfFormYamlEnhancementsConfigHandler.class.php
class sfFormYamlEnhancementsConfigHandler extends sfYamlConfigHandler
{
  public function execute($configFiles)
  {
    $config = self::getConfiguration($configFiles);
&nbsp;
    // compile data
    $retval = &quot;<span class="kw2">&lt;?php</span>\n<span class="st0">&quot;.
              &quot;</span><span class="co1">// auto-generated by %s\n&quot;.</span>
              <span class="st0">&quot;// date: <span class="es6">%s</span><span class="es1">\n</span>return <span class="es6">%s</span>;<span class="es1">\n</span>&quot;</span><span class="sy0">;</span>
    <span class="re0">$retval</span> <span class="sy0">=</span> <span class="kw3">sprintf</span><span class="br0">&#40;</span><span class="re0">$retval</span><span class="sy0">,</span> <span class="kw4">__CLASS__</span><span class="sy0">,</span> <span class="kw3">date</span><span class="br0">&#40;</span><span class="st_h">'Y/m/d H:i:s'</span><span class="br0">&#41;</span><span class="sy0">,</span>
      <span class="kw3">var_export</span><span class="br0">&#40;</span><span class="re0">$config</span><span class="sy0">,</span> <span class="kw4">true</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">return</span> <span class="re0">$retval</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
&nbsp;
  static <span class="kw2">public</span> <span class="kw2">function</span> getConfiguration<span class="br0">&#40;</span><span class="kw3">array</span> <span class="re0">$configFiles</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="kw2">self</span><span class="sy0">::</span><span class="me2">applyInheritance</span><span class="br0">&#40;</span><span class="kw2">self</span><span class="sy0">::</span><span class="me2">parseYamls</span><span class="br0">&#40;</span><span class="re0">$configFiles</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
&nbsp;
  static <span class="kw2">public</span> <span class="kw2">function</span> applyInheritance<span class="br0">&#40;</span><span class="re0">$config</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$classes</span> <span class="sy0">=</span> <span class="kw3">array_keys</span><span class="br0">&#40;</span><span class="re0">$config</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="re0">$merged</span> <span class="sy0">=</span> <span class="kw3">array</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="re0">$classes</span> <span class="kw1">as</span> <span class="re0">$class</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw3">class_exists</span><span class="br0">&#40;</span><span class="re0">$class</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="re0">$merged</span><span class="br0">&#91;</span><span class="re0">$class</span><span class="br0">&#93;</span> <span class="sy0">=</span> <span class="re0">$config</span><span class="br0">&#91;</span><span class="re0">$class</span><span class="br0">&#93;</span><span class="sy0">;</span>
        <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="kw3">array_intersect</span><span class="br0">&#40;</span><span class="kw3">class_parents</span><span class="br0">&#40;</span><span class="re0">$class</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="re0">$classes</span><span class="br0">&#41;</span> <span class="kw1">as</span> <span class="re0">$parent</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
          <span class="re0">$merged</span><span class="br0">&#91;</span><span class="re0">$class</span><span class="br0">&#93;</span> <span class="sy0">=</span> sfToolkit<span class="sy0">::</span><span class="me2">arrayDeepMerge</span><span class="br0">&#40;</span>
            <span class="re0">$config</span><span class="br0">&#91;</span><span class="re0">$parent</span><span class="br0">&#93;</span><span class="sy0">,</span>
            <span class="re0">$merged</span><span class="br0">&#91;</span><span class="re0">$class</span><span class="br0">&#93;</span>
          <span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="br0">&#125;</span>
      <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">return</span> <span class="re0">$merged</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Ahora ya se dispone de un array cuyos valores se han unido mediante la herencia
de clases. De esta forma se evita tener que filtrar la configuración mediante
una instrucción <code>instanceof</code> para cada objeto de formulario. Además, esta
unión de archivos se realiza en el gestor de configuración, por lo que sólo se
realiza una vez y después se guarda en la cache.</p>

<p>Aplicando una lógica muy sencilla, ya es posible aplicar este array a un objeto
de formulario:</p>

<div class="code php">
<pre class="php"><span class="kw2">class</span> sfFormYamlEnhancer
<span class="br0">&#123;</span>
  <span class="kw2">protected</span>
    <span class="re0">$configCache</span> <span class="sy0">=</span> <span class="kw4">null</span><span class="sy0">;</span>
&nbsp;
  <span class="kw2">public</span> <span class="kw2">function</span> __construct<span class="br0">&#40;</span>sfConfigCache <span class="re0">$configCache</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">configCache</span> <span class="sy0">=</span> <span class="re0">$configCache</span><span class="sy0">;</span>
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">configCache</span><span class="sy0">-&gt;</span><span class="me1">registerConfigHandler</span><span class="br0">&#40;</span><span class="st_h">'config/forms.yml'</span><span class="sy0">,</span>
      <span class="st_h">'sfFormYamlEnhancementsConfigHandler'</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
&nbsp;
  <span class="co1">// ...</span>
&nbsp;
  <span class="kw2">public</span> <span class="kw2">function</span> enhance<span class="br0">&#40;</span>sfForm <span class="re0">$form</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$config</span> <span class="sy0">=</span> <span class="kw1">include</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">configCache</span><span class="sy0">-&gt;</span><span class="me1">checkConfig</span><span class="br0">&#40;</span><span class="st_h">'config/forms.yml'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="re0">$class</span> <span class="sy0">=</span> <span class="kw3">get_class</span><span class="br0">&#40;</span><span class="re0">$form</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="kw3">isset</span><span class="br0">&#40;</span><span class="re0">$config</span><span class="br0">&#91;</span><span class="re0">$class</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="re0">$fieldConfigs</span> <span class="sy0">=</span> <span class="re0">$config</span><span class="br0">&#91;</span><span class="re0">$class</span><span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$overlap</span> <span class="sy0">=</span> <span class="kw3">array_intersect</span><span class="br0">&#40;</span><span class="kw3">class_parents</span><span class="br0">&#40;</span><span class="re0">$class</span><span class="br0">&#41;</span><span class="sy0">,</span>
      <span class="kw3">array_keys</span><span class="br0">&#40;</span><span class="re0">$config</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="re0">$fieldConfigs</span> <span class="sy0">=</span> <span class="re0">$config</span><span class="br0">&#91;</span><span class="kw3">current</span><span class="br0">&#40;</span><span class="re0">$overlap</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw1">else</span>
    <span class="br0">&#123;</span>
      <span class="kw1">return</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="re0">$fieldConfigs</span> <span class="kw1">as</span> <span class="re0">$fieldName</span> <span class="sy0">=&gt;</span> <span class="re0">$fieldConfig</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="co1">// ...</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Antes de volver a ejecutar el script de las pruebas, se añade una comprobación
para la nueva lógica de herencia de clases.</p>

<div class="code yaml">
<pre class="yaml"><span class="co1"># config/forms.yml</span>
&nbsp;
<span class="co1"># ...</span>
<span class="co4">
BaseForm</span>:<span class="co4">
  body</span>:<span class="co4">
    errors</span>:<span class="co3">
      min_length</span><span class="sy2">: </span>A base min_length message<span class="co3">
      required</span><span class="sy2">: </span>  A base required message</pre>
</div>

<p>A continuación se comprueba mediante las pruebas unitarias que se está aplicando
un mensaje de tipo <code>required</code> al formulario y que también se está aplicando ese
mensaje a todos los formularios que heredan de un formulario padre, aunque ellos
mismos no tengan configurado ese mensaje.</p>

<div class="code php">
<pre class="php"><span class="re0">$t</span> <span class="sy0">=</span> <span class="kw2">new</span> lime_test<span class="br0">&#40;</span><span class="nu0">5</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// ...</span>
&nbsp;
<span class="re0">$form</span> <span class="sy0">=</span> <span class="kw2">new</span> CommentForm<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">bind</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$enhancer</span><span class="sy0">-&gt;</span><span class="me1">enhance</span><span class="br0">&#40;</span><span class="re0">$form</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$t</span><span class="sy0">-&gt;</span><span class="me1">like</span><span class="br0">&#40;</span><span class="re0">$form</span><span class="br0">&#91;</span><span class="st_h">'body'</span><span class="br0">&#93;</span><span class="sy0">-&gt;</span><span class="me1">renderError</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st_h">'/A base required message/'</span><span class="sy0">,</span>
  <span class="st_h">'-&gt;enhance() considers inheritance'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> SpecialCommentForm <span class="kw2">extends</span> CommentForm <span class="br0">&#123;</span> <span class="br0">&#125;</span>
<span class="re0">$form</span> <span class="sy0">=</span> <span class="kw2">new</span> SpecialCommentForm<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">bind</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$enhancer</span><span class="sy0">-&gt;</span><span class="me1">enhance</span><span class="br0">&#40;</span><span class="re0">$form</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$t</span><span class="sy0">-&gt;</span><span class="me1">like</span><span class="br0">&#40;</span><span class="re0">$form</span><span class="br0">&#91;</span><span class="st_h">'body'</span><span class="br0">&#93;</span><span class="sy0">-&gt;</span><span class="me1">renderLabel</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st_h">'/Please enter your comment/'</span><span class="sy0">,</span>
  <span class="st_h">'-&gt;enhance() applies parent config'</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Ejecuta de nuevo las pruebas unitarias para comprobar que el sistema de mejora
de formularios sigue funcionando correctamente.</p>

<div class="figure" id="figure_14_4">
    <img src="/img/mas_con_symfony/config_cache_tests_5_ok.png" alt="Las pruebas pasan correctamente" />

    <p class="caption"><strong>Figura 14.4</strong> Las pruebas pasan correctamente</p>
</div>




    
    <div id="book-pager">
        <ul class="row pager">
            <li class="col-xs-6 previous ">
                                    <a href="../capitulo_14/anadiendo_pruebas_unitarias.html">
                        <strong>&larr; Anterior</strong>
                        <small>14.6. Añadiendo pruebas unitarias</small>
                    </a>
                            </li>

            <li class="col-xs-6 next ">
                                    <a href="../capitulo_14/haciendo_uso_de_formularios_embebidos.html">
                        <strong>Siguiente &rarr;</strong>
                        <small>14.8. Haciendo uso de formularios embebidos</small>
                    </a>
                            </li>
        </ul>
    </div>

                        </div>

                    <div id="sidebar" class="col-sm-3">
                        
            <div class="module module-share">
        <h3>Compartir</h3>
        <ul>
    <li><a id="share_twitter" href="#" title="Compartir en Twitter">Twitter</a></li>
    <li><a id="share_facebook" href="#" title="Compartir en Facebook">Facebook</a></li>
    <li><a id="share_google" href="#" title="Compartir en Google+">Google+</a></li>
</ul>

<script type="text/javascript">
var title    = '{{ item_social_title }}';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) {
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;

            ga('send', 'social', {
                'socialNetwork' : a.id.substr(6),
                'socialAction'  : 'share',
                'socialTarget'  : window.location
            });

            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

    </div>

            <div class="module module-ad module-ad-responsive module-ad-sidebar">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-toc" class="module">
        <a id="indice"></a>

        <h3>Indice de contenidos</h3>
        <ul class="toc text-links">
                                            <li class="level-1">
                <span>1.</span> <a href="../capitulo_1.html"> Introducción</a>
            </li>
                                                                                                            <li class="level-1">
                <span>2.</span> <a href="../capitulo_2.html"> Enrutamiento avanzado</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>3.</span> <a href="../capitulo_3.html"> Mejora tu productividad</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>4.</span> <a href="../capitulo_4.html"> Emails</a>
            </li>
                                                                                                                                                                                                                            <li class="level-1">
                <span>5.</span> <a href="../capitulo_5.html"> Widgets y validadores propios</a>
            </li>
                                                                                                            <li class="level-1">
                <span>6.</span> <a href="../capitulo_6.html"> Formularios avanzados</a>
            </li>
                                                                                                                                                                                                                                                            <li class="level-1">
                <span>7.</span> <a href="../capitulo_7.html"> Mejorando la barra de depuración web</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>8.</span> <a href="../capitulo_8.html"> Uso avanzado de Doctrine</a>
            </li>
                                                                                            <li class="level-1">
                <span>9.</span> <a href="../capitulo_9.html"> Utilizando la herencia de tablas de Doctrine</a>
            </li>
                                                                                            <li class="level-1">
                <span>10.</span> <a href="../capitulo_10.html"> Funcionamiento interno de Symfony</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>11.</span> <a href="../capitulo_11.html"> Windows y Symfony</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>12.</span> <a href="../capitulo_12.html"> Desarrollando aplicaciones Facebook</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>13.</span> <a href="../capitulo_13.html"> Descubriendo el poder de la línea de comandos</a>
            </li>
                                                                                                                                                                                                                                                                                                                                            <li class="level-1 ">
                <a href="../capitulo_14.html">
                    <span>Capítulo 14.</span> Jugando con la cache de configuración de Symfony
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_14/cadenas_de_texto_de_los_formularios.html">
                    <span>14.1.</span> Cadenas de texto de los formularios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_14/la_solucion_yaml.html">
                    <span>14.2.</span> La solución YAML
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_14/filtrando_las_variables_de_la_plantilla.html">
                    <span>14.3.</span> Filtrando las variables de la plantilla
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_14/aplicando_la_configuracion_yaml.html">
                    <span>14.4.</span> Aplicando la configuración YAML
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_14/la_cache_de_configuracion.html">
                    <span>14.5.</span> La cache de configuración
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_14/anadiendo_pruebas_unitarias.html">
                    <span>14.6.</span> Añadiendo pruebas unitarias
                </a>
            </li>
                                            <li class="level-2 active">
                <a href="../capitulo_14/gestores_de_configuracion_propios.html">
                    <span>14.7.</span> Gestores de configuración propios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_14/haciendo_uso_de_formularios_embebidos.html">
                    <span>14.8.</span> Haciendo uso de formularios embebidos
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_14/comparando_el_rendimiento.html">
                    <span>14.9.</span> Comparando el rendimiento
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_14/creando_un_plugin.html">
                    <span>14.10.</span> Creando un plugin
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_14/conclusion.html">
                    <span>14.11.</span> Conclusión
                </a>
            </li>
                                            <li class="level-1">
                <span>15.</span> <a href="../capitulo_15.html"> Trabajando con la comunidad Symfony</a>
            </li>
                                                                                            <li class="level-1">
                <span>A.</span> <a href="../apendice_a.html"> Código JavaScript de sfWidgetFormGMapAddress</a>
            </li>
                                            <li class="level-1">
                <span>B.</span> <a href="../apendice_b.html"> Ejemplo de instalador propio</a>
            </li>
                                            <li class="level-1">
                <span>C.</span> <a href="../apendice_c.html"> Licencia</a>
            </li>
                                        </ul>
    </div>
                    </div>
                            </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
