<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>2.2. Validadores (Los formularios de Symfony 1.4)</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                                                    <link rel="prev" href="../capitulo_2/antes_de_comenzar.html" />
                    <link rel="next" href="../capitulo_2/personalizando_los_validadores.html" />
                <link rel="start" href="/libro/symfony_formularios/" />
                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="2.2. Validadores (Los formularios de Symfony 1.4)">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-1-2" class="books book_page symfony_formularios"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                                    <div id="main" class="col-sm-9">
                        
    
    <div id="book-toc-anchor" class="well visible-xs">
        <a href="#indice">
            <i class="fa fa-book"></i> Ver índice de contenidos del libro
        </a>
    </div>

    <div id="breadcrumb" class="hidden-xs">
        <ol>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libros/" itemprop="url">
                    <span itemprop="title">Libros</span>
                </a>
            </li>

            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/symfony_formularios/" itemprop="url">
                    <span itemprop="title">Los formularios de Symfony 1.4</span>
                </a>
            </li>

                    <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/symfony_formularios/capitulo_2.html" itemprop="url">
                    <span itemprop="title">Capítulo 2. Validación de formularios</span>
                </a>
            </li>
        
            <li class="active">
                <span>2.2. Validadores</span>
            </li>
        </ol>
    </div>

    <h1 id="validadores" class="title">
        <span>2.2.</span> Validadores
    </h1>

    

<p>Los formularios de Symfony están formados por campos. En el capítulo 1, se explica cómo se identifican los campos mediante un nombre único. Para mostrar el formulario al usuario, se asocia un tipo de widget a cada campo. De la misma forma, ahora se van a aplicar las reglas de validación a cada campo.</p>

<h3 id="la_clase_sfvalidatorbase">2.2.1. La clase sfValidatorBase</h3>

<p>La validación de los campos se realiza mediante objetos que heredan de la clase <code>sfValidatorBase</code>. Para validar el formulario de contacto, se define un objeto validador para cada uno de los cuatro campos: <code>nombre</code>, <code>email</code>, <code>asunto</code>, y <code>mensaje</code>. El listado 2-2 muestra cómo crear estos validadores en la clase del formulario utilizando el método <code>setValidators()</code>.</p>

<p><strong>Listado 2-2 - Añadiendo validadores en la clase <code>ContactoForm</code></strong></p>

<div class="code php">
<pre class="php"><span class="co1">// lib/form/ContactoForm.class.php</span>
<span class="kw2">class</span> ContactoForm <span class="kw2">extends</span> sfForm
<span class="br0">&#123;</span>
  <span class="kw2">protected</span> static <span class="re0">$asuntos</span> <span class="sy0">=</span> <span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'Asunto A'</span><span class="sy0">,</span> <span class="st_h">'Asunto B'</span><span class="sy0">,</span> <span class="st_h">'Asunto C'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
  <span class="kw2">public</span> <span class="kw2">function</span> configure<span class="br0">&#40;</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">setWidgets</span><span class="br0">&#40;</span><span class="kw3">array</span><span class="br0">&#40;</span>
      <span class="st_h">'nombre'</span>  <span class="sy0">=&gt;</span> <span class="kw2">new</span> sfWidgetFormInput<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span>
      <span class="st_h">'email'</span>   <span class="sy0">=&gt;</span> <span class="kw2">new</span> sfWidgetFormInput<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span>
      <span class="st_h">'asunto'</span>  <span class="sy0">=&gt;</span> <span class="kw2">new</span> sfWidgetFormSelect<span class="br0">&#40;</span><span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'choices'</span> <span class="sy0">=&gt;</span> <span class="kw2">self</span><span class="sy0">::</span><span class="re0">$asuntos</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">,</span>
      <span class="st_h">'mensaje'</span> <span class="sy0">=&gt;</span> <span class="kw2">new</span> sfWidgetFormTextarea<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span>
    <span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">widgetSchema</span><span class="sy0">-&gt;</span><span class="me1">setNameFormat</span><span class="br0">&#40;</span><span class="st_h">'contacto[%s]'</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">setValidators</span><span class="br0">&#40;</span><span class="kw3">array</span><span class="br0">&#40;</span>
      <span class="st_h">'nombre'</span>  <span class="sy0">=&gt;</span> <span class="kw2">new</span> sfValidatorString<span class="br0">&#40;</span><span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'required'</span> <span class="sy0">=&gt;</span> <span class="kw4">false</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">,</span>
      <span class="st_h">'email'</span>   <span class="sy0">=&gt;</span> <span class="kw2">new</span> sfValidatorEmail<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span>
      <span class="st_h">'asunto'</span>  <span class="sy0">=&gt;</span> <span class="kw2">new</span> sfValidatorChoice<span class="br0">&#40;</span><span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'choices'</span> <span class="sy0">=&gt;</span> <span class="kw3">array_keys</span><span class="br0">&#40;</span><span class="kw2">self</span><span class="sy0">::</span><span class="re0">$asuntos</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">,</span>
      <span class="st_h">'mensaje'</span> <span class="sy0">=&gt;</span> <span class="kw2">new</span> sfValidatorString<span class="br0">&#40;</span><span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'min_length'</span> <span class="sy0">=&gt;</span> <span class="nu0">4</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">,</span>
    <span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>El código anterior utiliza tres validadores diferentes:</p>

<ul>
<li><code>sfValidatorString</code>: valida una cadena de texto</li>
<li><code>sfValidatorEmail</code> : valida un email</li>
<li><code>sfValidatorChoice</code>: valida que el valor se encuentra entre una lista de valores predefinidos</li>
</ul>

<p>Los validadores aceptan como primer argumento una lista de opciones. Al igual que los widgets, a pesar de su nombre algunas opciones son opcionales y otras obligatorias. El validador <code>sfValidatorChoice</code> por ejemplo dispone de una opción obligatoria llamada <code>choices</code>. Todos los validadores pueden establecer las opciones <code>required</code> y <code>trim</code>, que definen sus valores por defecto en la clase <code>sfValidatorBase</code>:</p>

<div class="table" id="table_2_1">

    <table>
<thead>
<tr>
  <th>Opción</th>
  <th>Valor por defecto</th>
  <th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>required</code></td>
  <td><code>true</code></td>
  <td>Indica que es obligatorio rellenar este campo</td>
</tr>
<tr>
  <td><code>trim</code></td>
  <td><code>false</code></td>
  <td>Indica si se deben eliminar los espacios en blanco del principio y del final antes de validar el valor del campo</td>
</tr>
</tbody>
</table>
</div>


<p>A continuación se muestran las opciones de los validadores del ejemplo anterior:</p>

<div class="table" id="table_2_2">

    <table>
<thead>
<tr>
  <th>Validador</th>
  <th>Opciones obligatorias</th>
  <th>Otras opciones</th>
</tr>
</thead>
<tbody>
<tr>
  <td><code>sfValidatorString</code></td>
  <td>-</td>
  <td><code>max_length</code>, <code>min_length</code></td>
</tr>
<tr>
  <td><code>sfValidatorEmail</code></td>
  <td>-</td>
  <td><code>pattern</code></td>
</tr>
<tr>
  <td><code>sfValidatorChoice</code></td>
  <td><code>choices</code></td>
  <td>-</td>
</tr>
</tbody>
</table>
</div>


<p>Si se envía ahora el formulario con valores incorrectos, no se produce ningún cambio respecto al comportamiento sin la validación. El motivo es que se debe modificar el módulo <code>contacto</code> para que aplique las reglas de validación, tal y como se muestra en el listado 2-3.</p>

<p><strong>Listado 2-3 - Añadiendo la validación en el módulo <code>contacto</code></strong></p>

<div class="code php">
<pre class="php"><span class="kw2">class</span> contactoActions <span class="kw2">extends</span> sfActions
<span class="br0">&#123;</span>
  <span class="kw2">public</span> <span class="kw2">function</span> executeIndex<span class="br0">&#40;</span><span class="re0">$request</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">formulario</span> <span class="sy0">=</span> <span class="kw2">new</span> ContactoForm<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$request</span><span class="sy0">-&gt;</span><span class="me1">isMethod</span><span class="br0">&#40;</span><span class="st_h">'post'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">formulario</span><span class="sy0">-&gt;</span><span class="me1">bind</span><span class="br0">&#40;</span><span class="re0">$request</span><span class="sy0">-&gt;</span><span class="me1">getParameter</span><span class="br0">&#40;</span><span class="st_h">'contacto'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
      <span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">formulario</span><span class="sy0">-&gt;</span><span class="me1">isValid</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">redirect</span><span class="br0">&#40;</span><span class="st_h">'contacto/gracias?'</span><span class="sy0">.</span><span class="kw3">http_build_query</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">formulario</span><span class="sy0">-&gt;</span><span class="me1">getValues</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
      <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
&nbsp;
  <span class="kw2">public</span> <span class="kw2">function</span> executeGracias<span class="br0">&#40;</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>El listado 2-3 incluye numerosos conceptos nuevos:</p>

<ul>
<li>Cuando se realiza la petición <code>GET</code> inicial, se inicializa el formulario y se pasa a la plantilla para mostrarlo al usuario. En este caso, el formulario se encuentra en el <strong>estado inicial</strong>:</li>
</ul>

<div class="code php">
<pre class="php"><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">formulario</span> <span class="sy0">=</span> <span class="kw2">new</span> ContactoForm<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<ul>
<li>Cuando el usuario envía el formulario mediante una petición <code>POST</code>, el método <code>bind()</code> asocia el formulario con los datos introducidos por el usuario y ejecuta el mecanismo de validación. En este caso, el formulario se encuentra en el <strong>estado asociado</strong>.</li>
</ul>

<div class="code php">
<pre class="php"><span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$request</span><span class="sy0">-&gt;</span><span class="me1">isMethod</span><span class="br0">&#40;</span><span class="st_h">'post'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">formulario</span><span class="sy0">-&gt;</span><span class="me1">bind</span><span class="br0">&#40;</span><span class="re0">$request</span><span class="sy0">-&gt;</span><span class="me1">getParameter</span><span class="br0">&#40;</span><span class="st_h">'contacto'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Una vez asociado, el formulario se puede validar mediante el método <code>isValid()</code>.
Si el valor devuelto por el método es <code>true</code>, el formulario es válido y se
redirige al usuario a la página de agradecimiento:</p>

<div class="code php">
<pre class="php"><span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">formulario</span><span class="sy0">-&gt;</span><span class="me1">isValid</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">redirect</span><span class="br0">&#40;</span><span class="st_h">'contacto/gracias?'</span><span class="sy0">.</span><span class="kw3">http_build_query</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">formulario</span><span class="sy0">-&gt;</span><span class="me1">getValues</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>En caso contrario, se vuelve a mostrar la plantilla <code>indexSuccess</code> como al principio. El proceso de validación añade los mensajes de error al formulario para que se muestren al usuario.</p>

<div class="admonition note"><p><strong class="title">Nota</strong> Cuando el formulario se encuentra en el estado inicial, el método <code>isValid()</code> siempre devuelve <code>false</code> y el método <code>getValues()</code> siempre devuelve un array vacío.</p></div>

<p>La figura 2-3 muestra el código que se ejecuta durante la interacción entre la aplicación y el usuario.</p>

<div class="figure" id="figure_2_3">
    <img src="/img/symfony_formularios/f0203.png" alt="Código que se ejecuta durante la interacción entre la aplicación y el usuario" />

    <p class="caption"><strong>Figura 2.3</strong> Código que se ejecuta durante la interacción entre la aplicación y el usuario</p>
</div>


<h3 id="la_finalidad_de_los_validadores">2.2.2. La finalidad de los validadores</h3>

<p>En el código anterior, durante la redirección a la página de agradecimiento, no se utiliza la instrucción <code>$request-&gt;getParameter('contacto')</code> sino que se emplea <code>$this-&gt;formulario-&gt;getValues()</code>. De hecho, la instrucción <code>$request-&gt;getParameter('contacto')</code> devuelve los datos enviados por el usuario y la instrucción <code>$this-&gt;formulario-&gt;getValues()</code> devuelve los datos validados.</p>

<p>Y si el formulario es válido, ¿por qué las dos instrucciones anteriores no son equivalentes? En realidad, los validadores realizan dos tareas: la tarea de validación y la tarea de limpieza. Por tanto, el método <code>getValues()</code> devuelve los datos validados y limpios.</p>

<p>A su vez, el proceso de limpieza de datos se compone de dos acciones: normalización y conversión de datos.</p>

<p>La opción <code>trim</code> explicada anteriormente es un caso de normalización de datos. No obstante, la normalización es un proceso mucho más importante por ejemplo para las fechas. El validador <code>sfValidatorDate</code> se encarga de validar fechas y permite introducir la fecha con muchos formatos (un <em>timestamp</em>, un formato que sigue una expresión regular, etc.). Este validador no devuelve directamente el valor introducido, sino que por defecto lo convierte al formato <code>Y-m-d H:i:s</code>. Por lo tanto, el programador puede estar seguro de obtener siempre el mismo formato para las fechas, independientemente del formato en el que el usuario introdujo la fecha. Este mecanismo ofrece una gran flexibilidad a los usuarios y asegura la consistencia a los programadores.</p>

<p>Respecto a la conversión de datos, se muestra a continuación el caso de un fichero subido. La validación de los archivos subidos por los usuarios se realiza con el validador <code>sfValidatorFile</code>. Una vez que el archivo se ha subido, este validador no devuelve simplemente el nombre del archivo, sino que devuelve un objeto de tipo <code>sfValidatedFile</code>, que facilita el acceso a la información del archivo. Más adelante en este capítulo se muestra cómo utilizar este validador.</p>

<div class="admonition note"><p><strong class="title">Nota</strong> El método <code>getValues()</code> devuelve un array con todos los datos validados y limpios. Sin embargo, como en ocasiones es muy útil acceder sólo a un valor, también existe el método <code>getValue()</code>. Ejemplo de uso: <code>$email = $this-&gt;formulario-&gt;getValue('email')</code>.</p></div>

<h3 id="formularios_invalidos">2.2.3. Formularios inválidos</h3>

<p>Cuando alguno de los campos del formulario contiene información inválida, se muestra la plantilla <code>indexSuccess</code>. La figura 2-4 muestra el resultado obtenido cuando se envían datos inválidos.</p>

<div class="figure" id="figure_2_4">
    <img src="/img/symfony_formularios/f0204.png" alt="Formulario inválido" />

    <p class="caption"><strong>Figura 2.4</strong> Formulario inválido</p>
</div>


<p>La instrucción <code>&lt;?php echo $formulario ?&gt;</code> tiene en cuenta los mensajes de error asociados a cada campo y vuelve a mostrar los datos introducidos por el usuario después de pasar por el proceso de limpieza de datos.</p>

<p>Cuando se asocia el formulario con datos externos mediante el método <code>bind()</code>, el formulario pasa al estado asociado y se ejecutan las siguientes acciones:</p>

<ul>
<li>Se ejecuta el proceso de validación</li>
<li>Los mensajes de error se almacenan en el formulario para que estén disponibles en la plantilla</li>
<li>Los valores iniciales del formulario se reemplazan por los valores resultantes del proceso de limpieza de datos</li>
</ul>

<p>La información necesaria para mostrar los mensajes de error o los datos introducidos por el usuario se puede acceder fácilmente mediante la variable <code>formulario</code> en la plantilla.</p>

<div class="admonition note"><p><strong class="title">Nota</strong> Como se explica en el capítulo 1, el constructor de la clase del formulario admite que se le pasen los valores por defecto. Después de enviar un formulario con datos inválidos, estos valores por defecto se sustituyen por los datos enviados, de forma que el usuario pueda ver los errores que ha cometido. Por lo tanto, no se deben utilizar los datos introducidos como si fueran datos por defecto, como por ejemplo en la siguiente instrucción: <code>$this-&gt;formulario-&gt;setDefaults($peticion-&gt;getParameter('contacto'))</code></p></div>



            <div class="module module-ad module-ad-responsive module-ad-bottom">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-pager">
        <ul class="row pager">
            <li class="col-xs-6 previous ">
                                    <a href="../capitulo_2/antes_de_comenzar.html">
                        <strong>&larr; Anterior</strong>
                        <small>2.1. Antes de comenzar</small>
                    </a>
                            </li>

            <li class="col-xs-6 next ">
                                    <a href="../capitulo_2/personalizando_los_validadores.html">
                        <strong>Siguiente &rarr;</strong>
                        <small>2.3. Personalizando los validadores</small>
                    </a>
                            </li>
        </ul>
    </div>

                        </div>

                    <div id="sidebar" class="col-sm-3">
                        
            <div class="module module-share">
        <h3>Compartir</h3>
        <ul>
    <li><a id="share_twitter" href="#" title="Compartir en Twitter">Twitter</a></li>
    <li><a id="share_facebook" href="#" title="Compartir en Facebook">Facebook</a></li>
    <li><a id="share_google" href="#" title="Compartir en Google+">Google+</a></li>
</ul>

<script type="text/javascript">
var title    = '{{ item_social_title }}';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) {
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;

            ga('send', 'social', {
                'socialNetwork' : a.id.substr(6),
                'socialAction'  : 'share',
                'socialTarget'  : window.location
            });

            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

    </div>

            <div class="module module-ad module-ad-responsive module-ad-sidebar">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-toc" class="module">
        <a id="indice"></a>

        <h3>Indice de contenidos</h3>
        <ul class="toc text-links">
                                            <li class="level-1">
                <span>1.</span> <a href="../capitulo_1.html"> Creación de formularios</a>
            </li>
                                                                                            <li class="level-1 ">
                <a href="../capitulo_2.html">
                    <span>Capítulo 2.</span> Validación de formularios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_2/antes_de_comenzar.html">
                    <span>2.1.</span> Antes de comenzar
                </a>
            </li>
                                            <li class="level-2 active">
                <a href="../capitulo_2/validadores.html">
                    <span>2.2.</span> Validadores
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_2/personalizando_los_validadores.html">
                    <span>2.3.</span> Personalizando los validadores
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_2/seguridad_de_los_validadores.html">
                    <span>2.4.</span> Seguridad de los validadores
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_2/validadores_logicos.html">
                    <span>2.5.</span> Validadores lógicos
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_2/validadores_globales.html">
                    <span>2.6.</span> Validadores globales
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_2/subiendo_archivos.html">
                    <span>2.7.</span> Subiendo archivos
                </a>
            </li>
                                            <li class="level-1">
                <span>3.</span> <a href="../capitulo_3.html"> Formularios para diseñadores web</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>4.</span> <a href="../capitulo_4.html"> Integración con Propel</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>5.</span> <a href="../capitulo_5.html"> Sin título</a>
            </li>
                                            <li class="level-1">
                <span>6.</span> <a href="../capitulo_6.html"> Sin título</a>
            </li>
                                            <li class="level-1">
                <span>7.</span> <a href="../capitulo_7.html"> Sin título</a>
            </li>
                                            <li class="level-1">
                <span>8.</span> <a href="../capitulo_8.html"> Internacionalización y localización</a>
            </li>
                                                                                                            <li class="level-1">
                <span>9.</span> <a href="../capitulo_9.html"> Sin título</a>
            </li>
                                            <li class="level-1">
                <span>10.</span> <a href="../capitulo_10.html"> Sin título</a>
            </li>
                                            <li class="level-1">
                <span>11.</span> <a href="../capitulo_11.html"> Integrando Doctrine</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>12.</span> <a href="../capitulo_12.html"> Referencia de Widgets</a>
            </li>
                                                                                                                                                                                            <li class="level-1">
                <span>13.</span> <a href="../capitulo_13.html"> Validadores</a>
            </li>
                                                                                                                                                                        </ul>
    </div>
                    </div>
                            </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
