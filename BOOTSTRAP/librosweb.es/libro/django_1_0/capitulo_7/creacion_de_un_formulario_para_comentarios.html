<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>7.3. Creación de un formulario para comentarios (El libro de Django 1.0)</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                                                    <link rel="prev" href="../capitulo_7/el_formulario_perfecto.html" />
                    <link rel="next" href="../capitulo_7/procesamiento_de_los_datos_suministrados.html" />
                <link rel="start" href="/libro/django_1_0/" />
                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="7.3. Creación de un formulario para comentarios (El libro de Django 1.0)">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-1-2" class="books book_page django_1_0"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                                    <div id="main" class="col-sm-9">
                        
    
    <div id="book-toc-anchor" class="well visible-xs">
        <a href="#indice">
            <i class="fa fa-book"></i> Ver índice de contenidos del libro
        </a>
    </div>

    <div id="breadcrumb" class="hidden-xs">
        <ol>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libros/" itemprop="url">
                    <span itemprop="title">Libros</span>
                </a>
            </li>

            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/django_1_0/" itemprop="url">
                    <span itemprop="title">El libro de Django 1.0</span>
                </a>
            </li>

                    <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/django_1_0/capitulo_7.html" itemprop="url">
                    <span itemprop="title">Capítulo 7. Procesamiento de formularios</span>
                </a>
            </li>
        
            <li class="active">
                <span>7.3. Creación de un formulario para comentarios</span>
            </li>
        </ol>
    </div>

    <h1 id="creacion_de_un_formulario_para_comentarios" class="title">
        <span>7.3.</span> Creación de un formulario para comentarios
    </h1>

    

<p>La mejor forma de construir un sitio que guste a la gente es atendiendo a
sus comentarios. Muchos sitios parecen olvidar esto y ocultan los
detalles de su contacto lo máximo posible.</p>

<p>Cuando tu sitio tiene millones de usuarios, esto puede ser una
estrategia razonable. En cambio, cuando intentas formarte una
audiencia, deberías pedir comentarios cada vez que se presente la
oportunidad. Escribamos entonces un simple formulario para
comentarios, y usémoslo para entender cómo funciona el <em>framework</em>
de Django.</p>

<p>Comenzaremos agregando <code>(r'^contact/$', 'mysite.books.views.contact')</code> al 
URLconf, y luego definamos nuestro formulario. Los formularios en Django se 
crean de una manera similar a los modelos: declarativamente, empleando una 
clase de Python. He aquí la clase para nuestro simple formulario. Por 
convención, lo insertaremos en un nuevo archivo <code>forms.py</code> dentro del 
directorio de nuestra aplicación:</p>

<div class="code python">
<pre class="python"><span class="kw1">from</span> django <span class="kw1">import</span> newforms <span class="kw1">as</span> forms
&nbsp;
TOPIC_CHOICES <span class="sy0">=</span> <span class="br0">&#40;</span>
    <span class="br0">&#40;</span><span class="st0">'general'</span><span class="sy0">,</span> <span class="st0">'General enquiry'</span><span class="br0">&#41;</span><span class="sy0">,</span>
    <span class="br0">&#40;</span><span class="st0">'bug'</span><span class="sy0">,</span> <span class="st0">'Bug report'</span><span class="br0">&#41;</span><span class="sy0">,</span>
    <span class="br0">&#40;</span><span class="st0">'suggestion'</span><span class="sy0">,</span> <span class="st0">'Suggestion'</span><span class="br0">&#41;</span><span class="sy0">,</span>
<span class="br0">&#41;</span>
&nbsp;
<span class="kw1">class</span> ContactForm<span class="br0">&#40;</span>forms.<span class="me1">Form</span><span class="br0">&#41;</span>:
    topic <span class="sy0">=</span> forms.<span class="me1">ChoiceField</span><span class="br0">&#40;</span>choices<span class="sy0">=</span>TOPIC_CHOICES<span class="br0">&#41;</span>
    message <span class="sy0">=</span> forms.<span class="me1">CharField</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
    sender <span class="sy0">=</span> forms.<span class="me1">EmailField</span><span class="br0">&#40;</span>required<span class="sy0">=</span><span class="kw2">False</span><span class="br0">&#41;</span></pre>
</div>

<div class="admonition sidebar"><p><strong class="title"> ¿Qué es "New Forms"?</strong> Cuando Django fue lanzado al público por primera vez, poseía un
sistema de formularios complicado y confuso. Como hacía muy
dificultosa la producción de formularios, fue rescrito y ahora se
llama <em>"newforms"</em> (nuevos formularios). Sin embargo, como todavía
hay cierta cantidad de código que depende del "viejo" sistema de
formularios, Django actualmente viene con ambos paquetes.</p>

<p>En el momento de escribir ese libro, el viejo sistema de formularios
de Django sigue disponible como <code>django.forms</code>, y el nuevo
paquete como <code>django.newforms</code>. En algún momento esto va a
cambiar, y <code>django.forms</code> hará referencia al nuevo paquete de
formularios. Sin embargo, para estar seguros de que los ejemplos
de este libro funcionen lo más ampliamente posible, todos harán
referencia a <code>django.newforms</code>.</p></div>

<p>Un formulario de Django es una subclase de <code>django.newforms.Form</code>,
tal como un modelo de Django es una subclase de
<code>django.db.models.Model</code>. El módulo <code>django.newforms</code> también
contiene cierta cantidad de clases <code>Field</code> para los campos. Una
lista completa de éstas últimas se encuentra disponible en la
documentación de Django.</p>

<p>Nuestro <code>ContactForm</code> consiste de tres campos: un asunto (<code>topic</code>), que se
puede elegir entre tres opciones; un mensaje (<code>message</code>), que es un campo de
caracteres; y un remitente (<code>sender</code>), que es un campo de correo electrónico y 
es opcional (porque incluso los comentarios anónimos pueden ser
útiles). Hay una cantidad de otros tipos de campos disponibles, y
puedes escribir nuevos tipos si ninguno cubre tus necesidades.</p>

<p>El objeto formulario sabe cómo hacer una cantidad de cosas útiles por
sí mismo. Puede validar una colección de datos, puede generar sus
propios <em>"widgets"</em> de HTML, puede construir un conjunto de mensajes
de error útiles. Y si no quieres diseñar el formulario a mano, puede
incluso renderizar el formulario entero. Incluyamos esto en una vista y 
veámoslo en acción. En <code>views.py</code>:</p>

<div class="code python">
<pre class="python"><span class="kw1">from</span> django.<span class="me1">db</span>.<span class="me1">models</span> <span class="kw1">import</span> Q
<span class="kw1">from</span> django.<span class="me1">shortcuts</span> <span class="kw1">import</span> render_to_response
<span class="kw1">from</span> models <span class="kw1">import</span> Book
<span class="kw1">from</span> forms <span class="kw1">import</span> ContactForm
&nbsp;
<span class="kw1">def</span> search<span class="br0">&#40;</span>request<span class="br0">&#41;</span>:
    query <span class="sy0">=</span> request.<span class="me1">GET</span>.<span class="me1">get</span><span class="br0">&#40;</span><span class="st0">'q'</span><span class="sy0">,</span> <span class="st0">''</span><span class="br0">&#41;</span>
    <span class="kw1">if</span> query:
        qset <span class="sy0">=</span> <span class="br0">&#40;</span>
            Q<span class="br0">&#40;</span>title__icontains<span class="sy0">=</span>query<span class="br0">&#41;</span> |
            Q<span class="br0">&#40;</span>authors__first_name__icontains<span class="sy0">=</span>query<span class="br0">&#41;</span> |
            Q<span class="br0">&#40;</span>authors__last_name__icontains<span class="sy0">=</span>query<span class="br0">&#41;</span>
        <span class="br0">&#41;</span>
        results <span class="sy0">=</span> Book.<span class="me1">objects</span>.<span class="kw2">filter</span><span class="br0">&#40;</span>qset<span class="br0">&#41;</span>.<span class="me1">distinct</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="kw1">else</span>:
        results <span class="sy0">=</span> <span class="br0">&#91;</span><span class="br0">&#93;</span>
    <span class="kw1">return</span> render_to_response<span class="br0">&#40;</span><span class="st0">&quot;books/search.html&quot;</span><span class="sy0">,</span> <span class="br0">&#123;</span>
        <span class="st0">&quot;results&quot;</span>: results<span class="sy0">,</span>
        <span class="st0">&quot;query&quot;</span>: query
    <span class="br0">&#125;</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">def</span> contact<span class="br0">&#40;</span>request<span class="br0">&#41;</span>:
    form <span class="sy0">=</span> ContactForm<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="kw1">return</span> render_to_response<span class="br0">&#40;</span><span class="st0">'contact.html'</span><span class="sy0">,</span> <span class="br0">&#123;</span><span class="st0">'form'</span>: form<span class="br0">&#125;</span><span class="br0">&#41;</span></pre>
</div>

<p>y en <code>contact.html</code>:</p>

<div class="code html">
<pre class="html5"><span class="sc0">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot;&gt;</span>
<span class="sc2">&lt;<span class="kw2">html</span> <span class="kw3">lang</span><span class="sy0">=</span><span class="st0">&quot;en&quot;</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">head</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">title</span>&gt;</span>Contact us<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">title</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">head</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">body</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">h1</span>&gt;</span>Contact us<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">h1</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">form</span> <span class="kw3">action</span><span class="sy0">=</span><span class="st0">&quot;.&quot;</span> <span class="kw3">method</span><span class="sy0">=</span><span class="st0">&quot;POST&quot;</span>&gt;</span>
        <span class="sc2">&lt;<span class="kw2">table</span>&gt;</span>
            {&#123; form.as_table &#125;}
        <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">table</span>&gt;</span>
        <span class="sc2">&lt;<span class="kw2">p</span>&gt;&lt;<span class="kw2">input</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;submit&quot;</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;Submit&quot;</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">p</span>&gt;</span>
    <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">form</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">body</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">html</span>&gt;</span></pre>
</div>

<p>La línea más interesante aquí es <code>{&#123; form.as_table &#125;}</code>. <code>form</code> es
nuestra instancia de <code>ContactForm</code>, que fue pasada al
<code>render_to_response</code>. <code>as_table</code> es un método de ese objeto que
reproduce el formulario como una secuencia de renglones de una tabla
(también pueden usarse <code>as_ul</code> y <code>as_p</code>). El HTML generado se ve
así:</p>

<div class="code html">
<pre class="html5"><span class="sc2">&lt;<span class="kw2">tr</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">th</span>&gt;&lt;<span class="kw2">label</span> <span class="kw3">for</span><span class="sy0">=</span><span class="st0">&quot;id_topic&quot;</span>&gt;</span>Topic:<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">label</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">th</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span>
        <span class="sc2">&lt;<span class="kw2">select</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">&quot;topic&quot;</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;id_topic&quot;</span>&gt;</span>
            <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;general&quot;</span>&gt;</span>General enquiry<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
            <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;bug&quot;</span>&gt;</span>Bug report<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
            <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;suggestion&quot;</span>&gt;</span>Suggestion<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
        <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">select</span>&gt;</span>
    <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">tr</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">th</span>&gt;&lt;<span class="kw2">label</span> <span class="kw3">for</span><span class="sy0">=</span><span class="st0">&quot;id_message&quot;</span>&gt;</span>Message:<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">label</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">th</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">td</span>&gt;&lt;<span class="kw2">input</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text&quot;</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">&quot;message&quot;</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;id_message&quot;</span> <span class="sy0">/</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">tr</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">th</span>&gt;&lt;<span class="kw2">label</span> <span class="kw3">for</span><span class="sy0">=</span><span class="st0">&quot;id_sender&quot;</span>&gt;</span>Sender:<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">label</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">th</span>&gt;</span>
    <span class="sc2">&lt;<span class="kw2">td</span>&gt;&lt;<span class="kw2">input</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text&quot;</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">&quot;sender&quot;</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;id_sender&quot;</span> <span class="sy0">/</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span></pre>
</div>

<p>Observa que las etiquetas <code>&lt;table&gt;</code> y <code>&lt;form&gt;</code> no se han incluido;
debes definirlas por tu cuenta en la plantilla. Esto te da control
sobre el comportamiento del formulario. Los elementos <em>label</em> sí se
incluyen, y permiten mejorar la accesibilidad de los formularios.</p>

<p>Nuestro formulario actualmente utiliza un <em>widget</em> <code>&lt;input type="text"&gt;</code> para el campo del mensaje. Pero no queremos restringir a nuestros usuarios a una 
sola línea de texto, así que la cambiaremos por un <em>widget</em> <code>&lt;textarea&gt;</code>:</p>

<div class="code python">
<pre class="python"><span class="kw1">class</span> ContactForm<span class="br0">&#40;</span>forms.<span class="me1">Form</span><span class="br0">&#41;</span>:
    topic <span class="sy0">=</span> forms.<span class="me1">ChoiceField</span><span class="br0">&#40;</span>choices<span class="sy0">=</span>TOPIC_CHOICES<span class="br0">&#41;</span>
    message <span class="sy0">=</span> forms.<span class="me1">CharField</span><span class="br0">&#40;</span>**widget<span class="sy0">=</span>forms.<span class="me1">Textarea</span><span class="br0">&#40;</span><span class="br0">&#41;</span>**<span class="br0">&#41;</span>
    sender <span class="sy0">=</span> forms.<span class="me1">EmailField</span><span class="br0">&#40;</span>required<span class="sy0">=</span><span class="kw2">False</span><span class="br0">&#41;</span></pre>
</div>

<p>El <em>framework</em> de formularios divide la lógica de presentación para
cada campo, en un conjunto de <em>widgets</em>. Cada tipo de campo tiene un
<em>widget</em> por defecto, pero puedes sobreescribirlo fácilmente, o
proporcionar uno nuevo desarrollado por ti.</p>

<p>Por el momento, si se suministra el formulario, no sucede
nada. Agreguemos nuestras reglas de validación:</p>

<div class="code python">
<pre class="python"><span class="kw1">def</span> contact<span class="br0">&#40;</span>request<span class="br0">&#41;</span>:
    <span class="kw1">if</span> request.<span class="me1">method</span> <span class="sy0">==</span> <span class="st0">'POST'</span>:
        form <span class="sy0">=</span> ContactForm<span class="br0">&#40;</span>request.<span class="me1">POST</span><span class="br0">&#41;</span>
    <span class="kw1">else</span>:
        form <span class="sy0">=</span> ContactForm<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="kw1">return</span> render_to_response<span class="br0">&#40;</span><span class="st0">'contact.html'</span><span class="sy0">,</span> <span class="br0">&#123;</span><span class="st0">'form'</span>: form<span class="br0">&#125;</span><span class="br0">&#41;</span></pre>
</div>

<p>Una instancia de formulario puede estar en uno de dos estados: <em>bound</em>
(vinculado) o <em>unbound</em> (no vinculado). Una instancia <em>bound</em> se
construye con un diccionario (o un objeto que funcione como un
diccionario) y sabe cómo validar y volver a representar sus datos. Un
formulario <em>unbound</em> no tiene datos asociados y simplemente sabe cómo
representarse a sí mismo.</p>

<p>Intenta hacer clic en <em>Submit</em> en el formulario vacío. La página se
volverá a cargar, mostrando un error de validación que informa que
nuestro campo de mensaje es obligatorio.</p>

<p>Intenta también ingresar una dirección de correo electrónico
inválida. El <code>EmailField</code> sabe cómo validar estas direcciones, por
lo menos a un nivel razonable.</p>

<div class="admonition sidebar"><p><strong class="title"> Cómo establecer los datos iniciales del formulario</strong> Al pasar datos directamente al constructor del formulario, estos
se vinculan, y se indica que la validación debe ser efectuada. A
menudo, necesitamos mostrar un formulario inicial con algunos
campos previamente rellenados — por ejemplo, en un formulario
"editar". Podemos hacerlo con el argumento de palabras claves
<code>initial</code>:</p>

<div class="code python">
<pre class="python">form <span class="sy0">=</span> CommentForm<span class="br0">&#40;</span>initial<span class="sy0">=</span><span class="br0">&#123;</span><span class="st0">'sender'</span>: <span class="st0">'<a class="__cf_email__" href="/cdn-cgi/l/email-protection" data-cfemail="fe8b8d9b8cbe9b869f938e929bd09d9193">[email&#160;protected]</a><script cf-hash='f9e31' type="text/javascript">
/* <![CDATA[ */!function(){try{var t="currentScript"in document?document.currentScript:function(){for(var t=document.getElementsByTagName("script"),e=t.length;e--;)if(t[e].getAttribute("cf-hash"))return t[e]}();if(t&&t.previousSibling){var e,r,n,i,c=t.previousSibling,a=c.getAttribute("data-cfemail");if(a){for(e="",r=parseInt(a.substr(0,2),16),n=2;a.length-n;n+=2)i=parseInt(a.substr(n,2),16)^r,e+=String.fromCharCode(i);e=document.createTextNode(e),c.parentNode.replaceChild(e,c)}}}catch(u){}}();/* ]]> */</script>'</span><span class="br0">&#125;</span><span class="br0">&#41;</span></pre>
</div>

<p>Si nuestro formulario <em>siempre</em> usará los mismos valores por defecto,
podemos configurarlos en la definición misma del formulario:</p>

<div class="code python">
<pre class="python">message <span class="sy0">=</span> forms.<span class="me1">CharField</span><span class="br0">&#40;</span>widget<span class="sy0">=</span>forms.<span class="me1">Textarea</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span>
                          initial<span class="sy0">=</span><span class="st0">&quot;Replace with your feedback&quot;</span><span class="br0">&#41;</span></pre>
</div>

<p></p></div>



            <div class="module module-ad module-ad-responsive module-ad-bottom">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-pager">
        <ul class="row pager">
            <li class="col-xs-6 previous ">
                                    <a href="../capitulo_7/el_formulario_perfecto.html">
                        <strong>&larr; Anterior</strong>
                        <small>7.2. El formulario perfecto</small>
                    </a>
                            </li>

            <li class="col-xs-6 next ">
                                    <a href="../capitulo_7/procesamiento_de_los_datos_suministrados.html">
                        <strong>Siguiente &rarr;</strong>
                        <small>7.4. Procesamiento de los datos suministrados</small>
                    </a>
                            </li>
        </ul>
    </div>

                        </div>

                    <div id="sidebar" class="col-sm-3">
                        
            <div class="module module-share">
        <h3>Compartir</h3>
        <ul>
    <li><a id="share_twitter" href="#" title="Compartir en Twitter">Twitter</a></li>
    <li><a id="share_facebook" href="#" title="Compartir en Facebook">Facebook</a></li>
    <li><a id="share_google" href="#" title="Compartir en Google+">Google+</a></li>
</ul>

<script type="text/javascript">
var title    = '{{ item_social_title }}';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) {
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;

            ga('send', 'social', {
                'socialNetwork' : a.id.substr(6),
                'socialAction'  : 'share',
                'socialTarget'  : window.location
            });

            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

    </div>

            <div class="module module-ad module-ad-responsive module-ad-sidebar">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-toc" class="module">
        <a id="indice"></a>

        <h3>Indice de contenidos</h3>
        <ul class="toc text-links">
                                            <li class="level-1">
                <span>1.</span> <a href="../capitulo_1.html"> Introducción a Django</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>2.</span> <a href="../capitulo_2.html"> Empezando</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>3.</span> <a href="../capitulo_3.html"> Los principios de las páginas Web dinámicas</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>4.</span> <a href="../capitulo_4.html"> El sistema de plantillas de Django</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>5.</span> <a href="../capitulo_5.html"> Interactuar con una base de datos: Modelos</a>
            </li>
                                                                                                                                                                                                                                                                            <li class="level-1">
                <span>6.</span> <a href="../capitulo_6.html"> El sitio de Administración Django</a>
            </li>
                                                                                                                                                            <li class="level-1 ">
                <a href="../capitulo_7.html">
                    <span>Capítulo 7.</span> Procesamiento de formularios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_7/busquedas.html">
                    <span>7.1.</span> Búsquedas
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_7/el_formulario_perfecto.html">
                    <span>7.2.</span> El formulario perfecto
                </a>
            </li>
                                            <li class="level-2 active">
                <a href="../capitulo_7/creacion_de_un_formulario_para_comentarios.html">
                    <span>7.3.</span> Creación de un formulario para comentarios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_7/procesamiento_de_los_datos_suministrados.html">
                    <span>7.4.</span> Procesamiento de los datos suministrados
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_7/nuestras_propias_reglas_de_validacion.html">
                    <span>7.5.</span> Nuestras propias reglas de validación
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_7/una_presentacion_personalizada.html">
                    <span>7.6.</span> Una presentación personalizada
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_7/creando_formularios_a_partir_de_modelos.html">
                    <span>7.7.</span> Creando formularios a partir de Modelos
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_7/que_sigue.html">
                    <span>7.8.</span> ¿Qué sigue?
                </a>
            </li>
                                            <li class="level-1">
                <span>8.</span> <a href="../capitulo_8.html"> Vistas avanzadas y URLconfs</a>
            </li>
                                                                                            <li class="level-1">
                <span>9.</span> <a href="../capitulo_9.html"> Vistas genéricas</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>10.</span> <a href="../capitulo_10.html"> Extender el sistema de plantillas</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>11.</span> <a href="../capitulo_11.html"> Generación de contenido no HTML</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>12.</span> <a href="../capitulo_12.html"> Sesiones, usuario e inscripciones</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>13.</span> <a href="../capitulo_13.html"> Cache</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>14.</span> <a href="../capitulo_14.html"> Otros sub-frameworks contribuidos</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>15.</span> <a href="../capitulo_15.html"> Middleware</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>16.</span> <a href="../capitulo_16.html"> Integración con Base de datos y Aplicaciones existentes</a>
            </li>
                                                                                                            <li class="level-1">
                <span>17.</span> <a href="../capitulo_17.html"> Extender la Interfaz de Administración de Django</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>18.</span> <a href="../capitulo_18.html"> Internacionalización</a>
            </li>
                                                                                                                                                                                            <li class="level-1">
                <span>19.</span> <a href="../capitulo_19.html"> Seguridad</a>
            </li>
                                                                                                                                                                                                            <li class="level-1">
                <span>20.</span> <a href="../capitulo_20.html"> Puesta en marcha de Django en un servidor</a>
            </li>
                                                                                                                                        </ul>
    </div>
                    </div>
                            </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
