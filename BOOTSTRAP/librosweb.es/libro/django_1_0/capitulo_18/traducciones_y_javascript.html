<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>18.7. Traducciones y JavaScript (El libro de Django 1.0)</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                                                    <link rel="prev" href="../capitulo_18/usando_traducciones_en_tus_propios_proyectos.html" />
                    <link rel="next" href="../capitulo_18/notas_para_usuarios_familiarizados_con_gettext.html" />
                <link rel="start" href="/libro/django_1_0/" />
                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="18.7. Traducciones y JavaScript (El libro de Django 1.0)">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-1-2" class="books book_page django_1_0"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                                    <div id="main" class="col-sm-9">
                        
            <div class="module module-ad module-ad-responsive module-ad-top">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-toc-anchor" class="well visible-xs">
        <a href="#indice">
            <i class="fa fa-book"></i> Ver índice de contenidos del libro
        </a>
    </div>

    <div id="breadcrumb" class="hidden-xs">
        <ol>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libros/" itemprop="url">
                    <span itemprop="title">Libros</span>
                </a>
            </li>

            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/django_1_0/" itemprop="url">
                    <span itemprop="title">El libro de Django 1.0</span>
                </a>
            </li>

                    <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/django_1_0/capitulo_18.html" itemprop="url">
                    <span itemprop="title">Capítulo 18. Internacionalización</span>
                </a>
            </li>
        
            <li class="active">
                <span>18.7. Traducciones y JavaScript</span>
            </li>
        </ol>
    </div>

    <h1 id="traducciones_y_javascript" class="title">
        <span>18.7.</span> Traducciones y JavaScript
    </h1>

    

<p>El agregar traducciones a JavaScript plantea algunos problemas:</p>

<ul>
<li>El código JavaScript no tiene acceso a una implementación de <code>gettext</code>.</li>
<li>El código JavaScript no tiene acceso a los archivos <code>.po</code> o <code>.mo</code>; los
mismos necesitan ser enviados desde el servidor.</li>
<li>Los catálogos de traducción para JavaScript deben ser mantenidos tan
pequeños como sea posible.</li>
</ul>

<p>Django provee una solución integrada para esos problemas: convierte las
traducciones a JavaScript, de manera que puedas llamar a <code>gettext</code> y demás
desde JavaScript.</p>

<h3 id="la_vista_javascript_catalog">18.7.1. La vista javascript_catalog</h3>

<p>La solución principal a esos problemas es la vista <code>javascript_catalog</code>, que
genera una librería de código JavaScript con funciones que emulan la interfaz
<code>gettext</code> más un arreglo de cadenas de traducción. Dichas cadenas de
traducción se toman desde la aplicación, el proyecto o el núcleo de Django, de
acuerdo a lo que especifiques ya sea en el <code>info_dict</code> o en la URL.</p>

<p>La forma de usar esto es asi:</p>

<div class="code python">
<pre class="python">js_info_dict <span class="sy0">=</span> <span class="br0">&#123;</span>
    <span class="st0">'packages'</span>: <span class="br0">&#40;</span><span class="st0">'your.app.package'</span><span class="sy0">,</span><span class="br0">&#41;</span><span class="sy0">,</span>
<span class="br0">&#125;</span>
&nbsp;
urlpatterns <span class="sy0">=</span> patterns<span class="br0">&#40;</span><span class="st0">''</span><span class="sy0">,</span>
    <span class="br0">&#40;</span>r<span class="st0">'^jsi18n/$'</span><span class="sy0">,</span> <span class="st0">'django.views.i18n.javascript_catalog'</span><span class="sy0">,</span> js_info_dict<span class="br0">&#41;</span><span class="sy0">,</span>
<span class="br0">&#41;</span></pre>
</div>

<p>Cada cadena en <code>package</code> debe seguir la sintaxis paquete separados por puntos
de Python (el mismo formato que las cadenas en <code>INSTALLED_APPS</code>) y deben
referirse a un paquete que contenga un directorio <code>locale</code>. Si especificas
múltiples paquetes, todos esos catálogos son fusionados en un catálogo único.
esto es útil si usas JavaScript que usa cadenas de diferentes aplicaciones.</p>

<p>Puedes hacer que la vista sea dinámica colocando los paquetes en el patrón de 
la URL:</p>

<div class="code python">
<pre class="python">urlpatterns <span class="sy0">=</span> patterns<span class="br0">&#40;</span><span class="st0">''</span><span class="sy0">,</span>
    <span class="br0">&#40;</span>r<span class="st0">'^jsi18n/(?P&lt;packages&gt;<span class="es0">\S</span>+?)/$'</span><span class="sy0">,</span> <span class="st0">'django.views.i18n.javascript_catalog'</span><span class="br0">&#41;</span><span class="sy0">,</span>
<span class="br0">&#41;</span></pre>
</div>

<p>Con esto, especificas los paquetes como una lista de nombres de paquetes
delimitados por un símbolo <code>+</code> en la URL. Esto es especialmente útil si tus
páginas usan código de diferentes aplicaciones, este cambia frecuentemente y no
deseas tener que descargar un único gran catálogo. Como una medida de
seguridad, esos valores pueden solo tomar los valores <code>django.conf</code> o
cualquier paquete de la variable de configuración <code>INSTALLED_APPS</code>.</p>

<h3 id="usando_el_catalogo_de_traducciones_javascript">18.7.2. Usando el catálogo de traducciones JavaScript</h3>

<p>Para usar el catálogo simplemente descarga el script generado dinámicamente de
la siguiente forma:</p>

<div class="code html">
<pre class="html5"><span class="sc2">&lt;<span class="kw2">script</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text/javascript&quot;</span> <span class="kw3">src</span><span class="sy0">=</span><span class="st0">&quot;/path/to/jsi18n/&quot;</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">script</span>&gt;</span></pre>
</div>

<p>Esta es la forma en la que el sitio de administración obtiene el catálogo de
traducciones desde el servidor. Una vez que se ha cargado el catálogo, tu
código JavaScript puede usar la interfaz estándar <code>gettext</code> para acceder al 
mismo:</p>

<div class="code js">
<pre class="js">document.write(gettext('this is to be translated'));</pre>
</div>

<p>Existe incluso una interfaz <code>ngettext</code> y una función de interpolación de
cadenas::</p>

<div class="code js">
<pre class="js">d = {
    count: 10
};
s = interpolate(ngettext('this is %(count)s object', 'this are %(count)s objects', d.count), d);</pre>
</div>

<p>La función <code>interpolate</code> admite tanto interpolación posicional como
interpolación con nombres. De manera que el código de arriba podría haber sido
escrito de la siguiente manera:</p>

<div class="code js">
<pre class="js">s = interpolate(ngettext('this is %s object', 'this are %s objects', 11), [11]);</pre>
</div>

<p>La sintaxis de interpolación se tomó prestada de Python. Sin embargo, no debes
exagerar con el uso de la interpolación de cadenas — esto sigue siendo
JavaScript así que el código tendrá que realizar múltiples sustituciones de
expresiones regulares. Esto no es tan rápido como la interpolación de cadenas 
en Python, de manera que deberías reservarlo para los casos en los que 
realmente lo necesites (por ejemplo en combinación con <code>ngettext</code> para generar
pluralizaciones en forma correcta).</p>

<h3 id="creando_catalogos_de_traducciones_javascript">18.7.3. Creando catálogos de traducciones JavaScript</h3>

<p>Los catálogos de traducciones se crean y actualizan de la misma manera que el
resto de los catálogos de traducciones de Django: con la herramienta
<code>make-messages.py</code>. La única diferencia es que es necesario que proveas un
parámetro <code>-d djangojs</code>, de la siguiente forma:</p>

<div class="code cli">
<pre class="cli">$ make-messages.py -d djangojs -l de</pre>
</div>

<p>Esto crea o actualiza el catálogo de traducción para JavaScript para alemán.
Luego de haber actualizado catálogos, sólo ejecuta <code>compile-messages.py</code> de la
misma manera que lo haces con los catálogos de traducción normales de Django.</p>



    
    <div id="book-pager">
        <ul class="row pager">
            <li class="col-xs-6 previous ">
                                    <a href="../capitulo_18/usando_traducciones_en_tus_propios_proyectos.html">
                        <strong>&larr; Anterior</strong>
                        <small>18.6. Usando traducciones en tus propios proyectos</small>
                    </a>
                            </li>

            <li class="col-xs-6 next ">
                                    <a href="../capitulo_18/notas_para_usuarios_familiarizados_con_gettext.html">
                        <strong>Siguiente &rarr;</strong>
                        <small>18.8. Notas para usuarios familiarizados con <code>gettext</code></small>
                    </a>
                            </li>
        </ul>
    </div>

                        </div>

                    <div id="sidebar" class="col-sm-3">
                        
            <div class="module module-share">
        <h3>Compartir</h3>
        <ul>
    <li><a id="share_twitter" href="#" title="Compartir en Twitter">Twitter</a></li>
    <li><a id="share_facebook" href="#" title="Compartir en Facebook">Facebook</a></li>
    <li><a id="share_google" href="#" title="Compartir en Google+">Google+</a></li>
</ul>

<script type="text/javascript">
var title    = '{{ item_social_title }}';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) {
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;

            ga('send', 'social', {
                'socialNetwork' : a.id.substr(6),
                'socialAction'  : 'share',
                'socialTarget'  : window.location
            });

            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

    </div>

    
    <div id="book-toc" class="module">
        <a id="indice"></a>

        <h3>Indice de contenidos</h3>
        <ul class="toc text-links">
                                            <li class="level-1">
                <span>1.</span> <a href="../capitulo_1.html"> Introducción a Django</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>2.</span> <a href="../capitulo_2.html"> Empezando</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>3.</span> <a href="../capitulo_3.html"> Los principios de las páginas Web dinámicas</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>4.</span> <a href="../capitulo_4.html"> El sistema de plantillas de Django</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>5.</span> <a href="../capitulo_5.html"> Interactuar con una base de datos: Modelos</a>
            </li>
                                                                                                                                                                                                                                                                            <li class="level-1">
                <span>6.</span> <a href="../capitulo_6.html"> El sitio de Administración Django</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>7.</span> <a href="../capitulo_7.html"> Procesamiento de formularios</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>8.</span> <a href="../capitulo_8.html"> Vistas avanzadas y URLconfs</a>
            </li>
                                                                                            <li class="level-1">
                <span>9.</span> <a href="../capitulo_9.html"> Vistas genéricas</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>10.</span> <a href="../capitulo_10.html"> Extender el sistema de plantillas</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>11.</span> <a href="../capitulo_11.html"> Generación de contenido no HTML</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>12.</span> <a href="../capitulo_12.html"> Sesiones, usuario e inscripciones</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>13.</span> <a href="../capitulo_13.html"> Cache</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>14.</span> <a href="../capitulo_14.html"> Otros sub-frameworks contribuidos</a>
            </li>
                                                                                                                                                                            <li class="level-1">
                <span>15.</span> <a href="../capitulo_15.html"> Middleware</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>16.</span> <a href="../capitulo_16.html"> Integración con Base de datos y Aplicaciones existentes</a>
            </li>
                                                                                                            <li class="level-1">
                <span>17.</span> <a href="../capitulo_17.html"> Extender la Interfaz de Administración de Django</a>
            </li>
                                                                                                                            <li class="level-1 ">
                <a href="../capitulo_18.html">
                    <span>Capítulo 18.</span> Internacionalización
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_18/especificando_cadenas_de_traduccion_en_codigo_python.html">
                    <span>18.1.</span> Especificando cadenas de traducción en código Python
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_18/especificando_cadenas_de_traduccion_en_codigo_de_plantillas.html">
                    <span>18.2.</span> Especificando cadenas de traducción en código de plantillas
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_18/creando_archivos_de_idioma.html">
                    <span>18.3.</span> Creando archivos de idioma
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_18/como_descubre_django_la_preferencia_de_idioma.html">
                    <span>18.4.</span> Cómo descubre Django la preferencia de idioma
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_18/la_vista_de_redireccion_set_language.html">
                    <span>18.5.</span> La vista de redirección set_language
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_18/usando_traducciones_en_tus_propios_proyectos.html">
                    <span>18.6.</span> Usando traducciones en tus propios proyectos
                </a>
            </li>
                                            <li class="level-2 active">
                <a href="../capitulo_18/traducciones_y_javascript.html">
                    <span>18.7.</span> Traducciones y JavaScript
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_18/notas_para_usuarios_familiarizados_con_gettext.html">
                    <span>18.8.</span> Notas para usuarios familiarizados con <code>gettext</code>
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_18/que_sigue.html">
                    <span>18.9.</span> ¿Qué sigue?
                </a>
            </li>
                                            <li class="level-1">
                <span>19.</span> <a href="../capitulo_19.html"> Seguridad</a>
            </li>
                                                                                                                                                                                                            <li class="level-1">
                <span>20.</span> <a href="../capitulo_20.html"> Puesta en marcha de Django en un servidor</a>
            </li>
                                                                                                                                        </ul>
    </div>
                    </div>
                            </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
