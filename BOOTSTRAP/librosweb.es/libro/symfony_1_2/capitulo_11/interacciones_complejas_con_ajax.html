<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>11.7. Interacciones complejas con Ajax (Symfony 1.2, la guía definitiva)</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                                                    <link rel="prev" href="../capitulo_11/json.html" />
                    <link rel="next" href="../capitulo_11/resumen.html" />
                <link rel="start" href="/libro/symfony_1_2/" />
                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="11.7. Interacciones complejas con Ajax (Symfony 1.2, la guía definitiva)">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-1-2" class="books book_page symfony_1_2"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                                    <div id="main" class="col-sm-9">
                        
    
    <div id="book-toc-anchor" class="well visible-xs">
        <a href="#indice">
            <i class="fa fa-book"></i> Ver índice de contenidos del libro
        </a>
    </div>

    <div id="breadcrumb" class="hidden-xs">
        <ol>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libros/" itemprop="url">
                    <span itemprop="title">Libros</span>
                </a>
            </li>

            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/symfony_1_2/" itemprop="url">
                    <span itemprop="title">Symfony 1.2, la guía definitiva</span>
                </a>
            </li>

                    <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/symfony_1_2/capitulo_11.html" itemprop="url">
                    <span itemprop="title">Capítulo 11. Integración con Ajax</span>
                </a>
            </li>
        
            <li class="active">
                <span>11.7. Interacciones complejas con Ajax</span>
            </li>
        </ol>
    </div>

    <h1 id="interacciones_complejas_con_ajax" class="title">
        <span>11.7.</span> Interacciones complejas con Ajax
    </h1>

    

<p>Entre los <em>helpers</em> de Ajax de Symfony, también existen utilidades que permiten construir interacciones complejas con una sola llamada a una función. Estas utilidades permiten mejorar la experiencia de usuario añadiendo características propias de las aplicaciones de escritorio (arrastrar y soltar, autocompletar, edición directa de contenidos, etc.) sin necesidad de escribir código JavaScript. En las siguientes secciones se describen los <em>helpers</em> de las interacciones complejas mediante ejemplos sencillos. Los parámetros adicionales y otras configuraciones se pueden consultar en la documentación de script.aculo.us.</p>

<div class="admonition caution"><p><strong class="title">Advertencia</strong> Aunque es sencillo incluir interacciones complejas, lo más complicado es configurarlas de forma que el usuario las perciba como algo natural en la página. Por tanto, solo se deben utilizar cuando se está seguro de que va a mejorar la experiencia de usuario. No deberían incluirse cuando su efecto es el de confundir al usuario.</p></div>

<h3 id="autocompletar">11.7.1. Autocompletar</h3>

<p>La interacción denominada "autocompletar" consiste en un cuadro de texto que muestra una lista de valores relacionados con los caracteres que teclea el usuario. Este efecto se puede conseguir con una única llamada al <em>helper</em> <code>input_auto_complete_tag()</code>, siempre que la acción remota devuelva una respuesta formateada como una lista de elementos HTML (<code>&lt;ul&gt;</code> y <code>&lt;li&gt;</code>) similar a la mostrada en el ejemplo 11-30.</p>

<p><strong>Listado 11-30 - Ejemplo de respuesta compatible con el <em>helper</em> de autocompletar</strong></p>

<div class="code html5">
<pre class="html5"><span class="sc2">&lt;<span class="kw2">ul</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">li</span>&gt;</span>sugerencia 1<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">li</span>&gt;</span>
  <span class="sc2">&lt;<span class="kw2">li</span>&gt;</span>sugerencia 2<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">li</span>&gt;</span>
  ...
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">ul</span>&gt;</span></pre>
</div>

<p>El <em>helper</em> se puede incluir en cualquier plantilla de la misma forma que se incluiría cualquier cuadro de texto, como se muestra en el ejemplo 11-31.</p>

<p><strong>Listado 11-31 - Uso del <em>helper</em> de autocompletar en una plantilla</strong></p>

<div class="code php">
<pre class="php"><span class="kw2">&lt;?php</span> <span class="kw1">echo</span> form_tag<span class="br0">&#40;</span><span class="st_h">'mimodulo/miaccion'</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>
  Buscar un autor en función de su nombre:
  <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> input_auto_complete_tag<span class="br0">&#40;</span><span class="st_h">'autor'</span><span class="sy0">,</span> <span class="st_h">'nombre por defecto'</span><span class="sy0">,</span>
    <span class="st_h">'autor/autocompletar'</span><span class="sy0">,</span>
    <span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'autocomplete'</span> <span class="sy0">=&gt;</span> <span class="st_h">'off'</span><span class="br0">&#41;</span><span class="sy0">,</span>
    <span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'use_style'</span>    <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="br0">&#41;</span>
  <span class="br0">&#41;</span> <span class="sy1">?&gt;</span>
  <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> submit_tag<span class="br0">&#40;</span><span class="st_h">'Buscar'</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>
&lt;/form&gt;</pre>
</div>

<p>Cada vez que el usuario teclee un carácter en el cuadro de texto <code>autor</code>, se realiza una llamada a la acción remota <code>autor/autocompletar</code>. El código de esa acción depende de cada caso y aplicación, pero debe obtener una lista de valores sugeridos en forma de lista de elementos HTML como la mostrada en el listado 11-30. El <em>helper</em> muestra la lista devuelta debajo del cuadro de texto <code>autor</code> y si el usuario pincha sobre un valor o lo selecciona mediante el teclado, el cuadro de texto se completa con ese valor, tal y como muestra la figura 11-3.</p>

<div class="figure" id="figure_11_3">
    <img src="/img/symfony_1_2/f1103.png" alt="Ejemplo de autocompletar" />

    <p class="caption"><strong>Figura 11.3</strong> Ejemplo de autocompletar</p>
</div>


<p>El tercer argumento del <em>helper</em> <code>input_auto_complete_tag()</code> puede tomar uno de los siguientes parámetros:</p>

<ul>
<li><code>use_style</code>: aplica estilos CSS de forma automática a la lista que se muestra.</li>
<li><code>frequency</code>: frecuencia con la que se realizan peticiones remotas (por defecto son 0.4 segundos).</li>
<li><code>indicator</code>: el valor del atributo <code>id</code> de un elemento que se muestra cuando comienza la carga de las sugerencias y se oculta cuando se ha completado.</li>
<li><code>tokens</code>: permite autocompletar por partes. Si el valor de este parámetro es <code>,</code> y el usuario introduce <code>pedro, juan</code> a la acción solo se le pasa el valor <code>juan</code> (siempre se le pasa el último valor después de trocear el cuadro de texto según el carácter definido por <code>tokens</code>).</li>
</ul>

<h3 id="arrastrar_y_soltar">11.7.2. Arrastrar y soltar</h3>

<p>En las aplicaciones de escritorio suele ser normal coger un elemento con el ratón, moverlo y soltarlo en otro lugar. Sin embargo, en las aplicaciones web es mucho más raro de ver esta técnica, ya que es bastante difícil de programarla a mano con JavaScript. Afortunadamente, en Symfony se puede incluir esta técnica solo con una línea de código.</p>

<p>El framework incluye 2 <em>helpers</em>, <code>draggable_element()</code> y <code>drop_receiving_element()</code>, que se encargan de modificar el comportamiento de los elementos; estos <em>helpers</em> "observan" a los elementos y les añaden nuevas habilidades. Se utilizan para declarar a los elementos como "arrastrable" o como "elemento en el que se pueden soltar los elementos arrastrables". Un elemento arrastrable se activa cuando se pulsa con el ratón sobre el. Mientras no se suelte el ratón, el elemento se mueve siguiendo la posición del ratón. Los elementos en los que se pueden soltar los elementos arrastrables llaman a una función remota cuando el elemento arrastrable se suelta sobre esa zona. El listado 11-32 muestra un ejemplo de esta interacción mediante un elemento que hace de carrito de la compra.</p>

<p><strong>Listado 11-32 - Elementos de arrastrar y soltar en un carrito de la compra</strong></p>

<div class="code php">
<pre class="php">&lt;ul id=&quot;elementos&quot;&gt;
  &lt;li id=&quot;elemento1&quot; class=&quot;comida&quot;&gt;Zanahoria&lt;/li&gt;
  <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> draggable_element<span class="br0">&#40;</span><span class="st_h">'elemento1'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'revert'</span> <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>
  &lt;li id=&quot;elemento2&quot; class=&quot;comida&quot;&gt;Manzana&lt;/li&gt;
  <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> draggable_element<span class="br0">&#40;</span><span class="st_h">'elemento2'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'revert'</span> <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>
  &lt;li id=&quot;elemento3&quot; class=&quot;comida&quot;&gt;Naranja&lt;/li&gt;
  <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> draggable_element<span class="br0">&#40;</span><span class="st_h">'elemento3'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span><span class="st_h">'revert'</span> <span class="sy0">=&gt;</span> <span class="kw4">true</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span>
&lt;/ul&gt;
&lt;div id=&quot;carrito&quot;&gt;
  &lt;p&gt;El carrito está vacío&lt;/p&gt;
  &lt;p&gt;Arrastra y suelta elementos aquí para añadirlos al carrito&lt;/p&gt;
&lt;/div&gt;
<span class="kw2">&lt;?php</span> <span class="kw1">echo</span> drop_receiving_element<span class="br0">&#40;</span><span class="st_h">'carrito'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
  <span class="st_h">'url'</span>        <span class="sy0">=&gt;</span> <span class="st_h">'carrito/anadir'</span><span class="sy0">,</span>
  <span class="st_h">'accept'</span>     <span class="sy0">=&gt;</span> <span class="st_h">'comida'</span><span class="sy0">,</span>
  <span class="st_h">'update'</span>     <span class="sy0">=&gt;</span> <span class="st_h">'carrito'</span><span class="sy0">,</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span></pre>
</div>

<p>Cada uno de los elementos de la lista se pueden coger con el ratón y moverlos por la ventana del navegador. Cuando se suelta el ratón, el elemento vuelve a su posición original. Si el elemento se suelta sobre el elemento cuyo atributo <code>id</code> es <code>carrito</code>, se realiza una llamada a la acción remota <code>carrito/anadir</code>. La acción puede determinar el elemento que se ha añadido mediante el parámetro de petición <code>id</code>. De esta forma, el listado 11-32 es una aproximación muy realista al proceso físico de compra de productos: se cogen los productos, se sueltan en el carrito y después se realiza el pago.</p>

<div class="admonition tip"><p><strong class="title">Truco</strong> En el lsitado 11-32, los <em>helpers</em> aparecen justo después del elemento que modifican, aunque no es obligatorio. Si se quiere, se pueden agrupar todos los <em>helpers</em> <code>draggable_element()</code> y <code>drop_receiving_element()</code> al final de la plantilla. Lo único importante es el primer argumento que se pasa al <em>helper</em> y que indica el elemento al que se aplica.</p></div>

<p>El <em>helper</em> <code>draggable_element()</code> acepta los siguientes parámetros:</p>

<ul>
<li><code>revert</code>: si vale <code>true</code>, el elemento vuelve a su posición original cuando se suelta el ratón. También se puede indicar el nombre de una función que se ejecuta cuando finaliza el arrastre del elemento.</li>
<li><code>ghosting</code>: realiza una copia del elemento original y el usuario mueve la copia, quedando inmóvil el elemento original.</li>
<li><code>snap</code>: si vale <code>false</code>, el movimiento del elemento es libre. En otro caso, el elemento solo se puede desplazar de forma escalonada como si estuviera una gran rejilla a la que se ajusta el elemento. El valor del desplazamiento horizontal (<code>x</code>) y vertical (<code>y</code>) del elemento se puede definir como <code>xy</code>, <code>[x,y]</code> o <code>function(x,y){ return [x,y] }</code>.</li>
</ul>

<p>El <em>helper</em> <code>drop_receiving_element()</code> acepta los siguientes parámetros:</p>

<ul>
<li><code>accept</code>: una cadena de texto o un array de cadenas de texto que representan a valores de clases CSS. Este elemento solo permitirá que se suelten sobre el los elementos cuyas clases CSS contengan al menos uno de los valores indicado.</li>
<li><code>hoverclass</code>: clase CSS que se añade al elemento cuando el usuario arrastra (sin soltarlo) un elemento sobre esta zona.</li>
</ul>

<h3 id="listas_ordenables">11.7.3. Listas ordenables</h3>

<p>Otra posibilidad que brindan los elementos arrastrables es la de ordenar una lista moviendo sus elementos con el ratón. El <em>helper</em> <code>sortable_element()</code> añade este comportamiento a los elementos de la lista, como se muestra en el ejemplo del listado 11-33.</p>

<p><strong>Listado 11-33 - Ejemplo de lista ordenable</strong></p>

<div class="code php">
<pre class="php">&lt;p&gt;What do you like most?&lt;/p&gt;
&lt;ul id=&quot;ordenar&quot;&gt;
  &lt;li id=&quot;elemento_1&quot; class=&quot;ordenable&quot;&gt;Zanahorias&lt;/li&gt;
  &lt;li id=&quot;elemento_2&quot; class=&quot;ordenable&quot;&gt;Manzanas&lt;/li&gt;
  &lt;li id=&quot;elemento_3&quot; class=&quot;ordenable&quot;&gt;Naranjas&lt;/li&gt;
  // A nadie le gustan las coles de Bruselas
  &lt;li id=&quot;elemento_4&quot;&gt;Coles de Bruselas&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&quot;respuesta&quot;&gt;&lt;/div&gt;
<span class="kw2">&lt;?php</span> <span class="kw1">echo</span> sortable_element<span class="br0">&#40;</span><span class="st_h">'ordenar'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
  <span class="st_h">'url'</span>    <span class="sy0">=&gt;</span> <span class="st_h">'elemento/ordenar'</span><span class="sy0">,</span>
  <span class="st_h">'update'</span> <span class="sy0">=&gt;</span> <span class="st_h">'respuesta'</span><span class="sy0">,</span>
  <span class="st_h">'only'</span>   <span class="sy0">=&gt;</span> <span class="st_h">'ordenable'</span><span class="sy0">,</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span></pre>
</div>

<p>Gracias a la magia del <em>helper</em> <code>sortable_element()</code>, la lista <code>&lt;ul&gt;</code> se transforma en una lista ordenable dinámicamente, de forma que sus elementos se pueden reordenar mediante la técnica de arrastras y soltar. Cada vez que el usuario mueve un elemento y lo suelta para reordenar la lista, se realiza una petición Ajax con los siguientes parámetros:</p>

<div class="code code">
<pre class="code">POST /sf_sandbox/web/frontend_dev.php/elemento/ordenar HTTP/1.1
  ordenar[]=1&amp;ordenar[]=3&amp;ordenar[]=2&amp;_=</pre>
</div>

<p>La lista completa se pasa como un array con el formato <code>ordenar[$rank]=$id</code>, el <code>$rank</code> empieza en <code>0</code> y el <code>$id</code> es el valor que se indica después del guión bajo (<code>_</code>) en el valor del atributo <code>id</code> de cada elemento de la lista. El atributo <code>id</code> de la lista completa (<code>ordenar</code> en este caso) se utiliza para el nombre del array de parámetros que se pasan al servidor.</p>

<p>El <em>helper</em> <code>sortable_element()</code> acepta los siguientes parámetros:</p>

<ul>
<li><code>only</code>: una cadena de texto o un array de cadenas de texto que representan a valores de clases CSS. Solamente se podrán mover los elementos de la lista que tengan este valor en su atributo <code>class</code>.</li>
<li><code>hoverclass</code>: clase CSS que se añade a la lista cuando el usuario posiciona el puntero del ratón encima de ella.</li>
<li><code>overlap</code>: su valor debería ser <code>horizontal</code> si los elementos de la lista se muestran de forma horizontal y su valor debería ser <code>vertical</code> (que es el valor por defecto) cuando los elementos se muestran cada uno en una línea (como se muestran por defecto las listas en HTML).</li>
<li><code>tag</code>: si la lista reordenable no contiene elemento <code>&lt;li&gt;</code>, se debe indicar la etiqueta que define los elementos que se van a hacer reordenables (por ejemplo <code>div</code> o <code>dl</code>).</li>
</ul>

<div class="admonition tip"><p><strong class="title">Truco</strong> A partir de Symfony 1.1 también se puede utilizar el <em>helper</em> <code>sortable_element()</code> sin la opción <code>url</code>. De esta forma, no se realiza ninguna petición AJAX después de cada reordenación. El uso más común es el de realizar todas las peticiones AJAX cuando el usuario pulsa sobre el botón de <code>Guardar</code> o similar.</p></div>

<h3 id="edicion_directa_de_contenidos">11.7.4. Edición directa de contenidos</h3>

<p>Cada vez más aplicaciones web permiten editar los contenidos de sus páginas sin necesidad de utilizar formularios que incluyen el contenido de la página. El funcionamiento de esta interacción es muy sencillo. Cuando el usuario pasa el ratón por encima de un bloque de texto, este se resalta. Si el usuario pincha sobre el bloque, el texto se convierte en un control de formulario llamado área de texto (<code>textarea</code>) que muestra el texto original. Además, se muestra un botón para guardar los cambios. El usuario realiza los cambios en el texto original y pulsa sobre el botón de guardar los cambios. Una vez guardado, el área de texto desaparece y el texto modificado se vuelve a mostrar de forma normal. Con Symfony, toda esta interacción se puede realizar aplicando el <em>helper</em> <code>input_in_place_editor_tag()</code> al elemento. El listado 11-34 muestra el uso de este <em>helper</em>.</p>

<p><strong>Listado 11-34 - Ejemplo de texto editable</strong></p>

<div class="code php">
<pre class="php">&lt;div id=&quot;modificame&quot;&gt;Puedes modificar este texto&lt;/div&gt;
<span class="kw2">&lt;?php</span> <span class="kw1">echo</span> input_in_place_editor_tag<span class="br0">&#40;</span><span class="st_h">'modificame'</span><span class="sy0">,</span> <span class="st_h">'mimodulo/miaccion'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
  <span class="st_h">'cols'</span>        <span class="sy0">=&gt;</span> <span class="nu0">40</span><span class="sy0">,</span>
  <span class="st_h">'rows'</span>        <span class="sy0">=&gt;</span> <span class="nu0">10</span><span class="sy0">,</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span></pre>
</div>

<p>Cuando el usuario pincha sobre el texto editable, se reemplaza por un cuadro de texto que contiene el texto original y que se puede modificar. Al guardar los cambios, se llama mediante Ajax a la acción <code>mimodulo/miaccion</code> con el contenido modificado como valor del parámetro <code>value</code>. El resultado de la acción actualiza el elemento editable. Se trata de una interacción muy rápida de incluir y muy poderosa.</p>

<p>El <em>helper</em> <code>input_in_place_editor_tag()</code> acepta los siguientes parámetros:</p>

<ul>
<li><code>cols</code> y <code>rows</code>: el tamaño (en filas y columnas) del área de texto que se muestra para editar el contenido original (si el valor de <code>rows</code> es mayor que <code>1</code>, se muestra un <code>&lt;textarea&gt;</code>; en otro caso, se muestra un <code>&lt;input type="text"&gt;</code>).</li>
<li><code>loadTextURL</code>: la URI de la acción que se llama para obtener el texto que se debe editar. Se trata de una opción útil cuando el contenido del elemento tiene un formato especial y se quiere que el usuario edite el texto sin ese formato aplicado.</li>
<li><code>save_text</code> y <code>cancel_text</code>: el texto del enlace para guardar los cambios (el valor por defecto es "ok") y el del enlace para cancelar los cambios (el valor por defecto es "cancel").</li>
</ul>

<p>Existen muchas otras opciones que se pueden consultar en <a href="http://github.com/madrobby/scriptaculous/wikis/ajax-inplaceeditor">la documentación de script.aculo.us sobre la edición directa de contenidos</a>.</p>



            <div class="module module-ad module-ad-responsive module-ad-bottom">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-pager">
        <ul class="row pager">
            <li class="col-xs-6 previous ">
                                    <a href="../capitulo_11/json.html">
                        <strong>&larr; Anterior</strong>
                        <small>11.6. JSON</small>
                    </a>
                            </li>

            <li class="col-xs-6 next ">
                                    <a href="../capitulo_11/resumen.html">
                        <strong>Siguiente &rarr;</strong>
                        <small>11.8. Resumen</small>
                    </a>
                            </li>
        </ul>
    </div>

                        </div>

                    <div id="sidebar" class="col-sm-3">
                        
            <div class="module module-share">
        <h3>Compartir</h3>
        <ul>
    <li><a id="share_twitter" href="#" title="Compartir en Twitter">Twitter</a></li>
    <li><a id="share_facebook" href="#" title="Compartir en Facebook">Facebook</a></li>
    <li><a id="share_google" href="#" title="Compartir en Google+">Google+</a></li>
</ul>

<script type="text/javascript">
var title    = '{{ item_social_title }}';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) {
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;

            ga('send', 'social', {
                'socialNetwork' : a.id.substr(6),
                'socialAction'  : 'share',
                'socialTarget'  : window.location
            });

            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

    </div>

            <div class="module module-ad module-ad-responsive module-ad-sidebar">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-toc" class="module">
        <a id="indice"></a>

        <h3>Indice de contenidos</h3>
        <ul class="toc text-links">
                                            <li class="level-1">
                <span>1.</span> <a href="../capitulo_1.html"> Introducción a Symfony</a>
            </li>
                                                                                            <li class="level-1">
                <span>2.</span> <a href="../capitulo_2.html"> Explorando el interior de Symfony</a>
            </li>
                                                                                                            <li class="level-1">
                <span>3.</span> <a href="../capitulo_3.html"> Ejecutar aplicaciones Symfony</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>4.</span> <a href="../capitulo_4.html"> Introducción a la creación de páginas</a>
            </li>
                                                                                                            <li class="level-1">
                <span>5.</span> <a href="../capitulo_5.html"> Configurar Symfony</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>6.</span> <a href="../capitulo_6.html"> El Controlador</a>
            </li>
                                                                                                                                                                                            <li class="level-1">
                <span>7.</span> <a href="../capitulo_7.html"> La Vista</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>8.</span> <a href="../capitulo_8.html"> El modelo</a>
            </li>
                                                                                                                                                                                            <li class="level-1">
                <span>9.</span> <a href="../capitulo_9.html"> Enlaces y sistema de enrutamiento</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>10.</span> <a href="../capitulo_10.html"> Formularios</a>
            </li>
                                                                                                                            <li class="level-1 ">
                <a href="../capitulo_11.html">
                    <span>Capítulo 11.</span> Integración con Ajax
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_11/helpers_basicos_de_javascript.html">
                    <span>11.1.</span> Helpers básicos de JavaScript
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_11/prototype.html">
                    <span>11.2.</span> Prototype
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_11/helpers_de_ajax.html">
                    <span>11.3.</span> Helpers de Ajax
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_11/parametros_para_la_ejecucion_remota.html">
                    <span>11.4.</span> Parámetros para la ejecución remota
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_11/creando_efectos_visuales.html">
                    <span>11.5.</span> Creando efectos visuales
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_11/json.html">
                    <span>11.6.</span> JSON
                </a>
            </li>
                                            <li class="level-2 active">
                <a href="../capitulo_11/interacciones_complejas_con_ajax.html">
                    <span>11.7.</span> Interacciones complejas con Ajax
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_11/resumen.html">
                    <span>11.8.</span> Resumen
                </a>
            </li>
                                            <li class="level-1">
                <span>12.</span> <a href="../capitulo_12.html"> Uso de la cache</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>13.</span> <a href="../capitulo_13.html"> Internacionalización y localización</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>14.</span> <a href="../capitulo_14.html"> Generador de la parte de administración</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>15.</span> <a href="../capitulo_15.html"> Pruebas unitarias y funcionales</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>16.</span> <a href="../capitulo_16.html"> Herramientas para la administración de aplicaciones</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>17.</span> <a href="../capitulo_17.html"> Personalizar Symfony</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>18.</span> <a href="../capitulo_18.html"> Rendimiento</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>19.</span> <a href="../capitulo_19.html"> Configuración avanzada</a>
            </li>
                                                                                                        </ul>
    </div>
                    </div>
                            </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
