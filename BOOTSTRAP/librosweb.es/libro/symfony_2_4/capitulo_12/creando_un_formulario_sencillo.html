<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>12.1.  Creando un formulario sencillo (Symfony 2.4, el libro oficial)</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                            
        <link rel="canonical" href="/libro/symfony_2_x/capitulo_12/creando_un_formulario_sencillo.html"/>
                                    <link rel="prev" href="../capitulo_12.html" />
                    <link rel="next" href="../capitulo_12/validando_formularios.html" />
                <link rel="start" href="/libro/symfony_2_4/" />
                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="12.1.  Creando un formulario sencillo (Symfony 2.4, el libro oficial)">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-1-2" class="books book_page symfony_2_4"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                                    <div id="main" class="col-sm-9">
                        
    
    <div id="book-toc-anchor" class="well visible-xs">
        <a href="#indice">
            <i class="fa fa-book"></i> Ver índice de contenidos del libro
        </a>
    </div>

    <div id="breadcrumb" class="hidden-xs">
        <ol>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libros/" itemprop="url">
                    <span itemprop="title">Libros</span>
                </a>
            </li>

            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/symfony_2_4/" itemprop="url">
                    <span itemprop="title">Symfony 2.4, el libro oficial</span>
                </a>
            </li>

                    <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/symfony_2_4/capitulo_12.html" itemprop="url">
                    <span itemprop="title">Capítulo 12. Formularios</span>
                </a>
            </li>
        
            <li class="active">
                <span>12.1.  Creando un formulario sencillo</span>
            </li>
        </ol>
    </div>

    <h1 id="creando_un_formulario_sencillo" class="title">
        <span>12.1.</span>  Creando un formulario sencillo
    </h1>

    

<p>Imagina que estás construyendo una aplicación lista de tareas. Como tus usuarios tendrán que editar y crear tareas, vas a necesitar un formulario. Pero antes de empezar, vamos a centrarnos en la clase genérica <code>Task</code> que representa y almacena los datos para una sola tarea:</p>

<div class="code php">
<pre class="php"><span class="co1">// src/Acme/TaskBundle/Entity/Task.php</span>
<span class="kw2">namespace</span> Acme\TaskBundle\Entity<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> Task
<span class="br0">&#123;</span>
    <span class="co1">// descripción de la tarea</span>
    <span class="kw2">protected</span> <span class="re0">$task</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// fecha en la que debe estar completada</span>
    <span class="kw2">protected</span> <span class="re0">$dueDate</span><span class="sy0">;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> getTask<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">task</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw2">public</span> <span class="kw2">function</span> setTask<span class="br0">&#40;</span><span class="re0">$task</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">task</span> <span class="sy0">=</span> <span class="re0">$task</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> getDueDate<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">dueDate</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> setDueDate<span class="br0">&#40;</span>\DateTime <span class="re0">$dueDate</span> <span class="sy0">=</span> <span class="kw4">null</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">dueDate</span> <span class="sy0">=</span> <span class="re0">$dueDate</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<div class="admonition note"><p><strong class="title">Nota</strong> Si estás programando este ejemplo a medida que lees el capítulo, primero crea el <em>bundle</em> <code>AcmeTaskBundle</code> ejecutando el siguiente comando (y acepta los valores por defecto de todas las opciones):</p>

<div class="code cli">
<pre class="cli">$ php app/console generate:bundle --namespace=Acme/TaskBundle</pre>
</div>

<p></p></div>

<p>Esta clase no es más que una clase PHP normal, ya que por el momento no tiene nada que ver ni con Symfony ni con ninguna otra librería. Se trata de una clase PHP adecuada para resolver el problema de tu aplicación. Al finalizar este capítulo, serás capaz de <em>enviar</em> información a una instancia de la clase <code>Task</code> mediante un formulario, validar sus datos y guardarlos en una base de datos.</p>

<h3 id="construyendo_el_formulario">12.1.1. Construyendo el formulario</h3>

<p>Ahora que has creado una clase <code>Task</code>, el siguiente paso consiste en crear y mostrar en el navegador el formulario HTML real. En Symfony2, esto se hace construyendo un objeto de tipo <code>Form</code> y luego renderizándolo en una plantilla. Por el momento vamos a hacer todos estos pasos dentro de un controlador:</p>

<div class="code php">
<pre class="php"><span class="co1">// src/Acme/TaskBundle/Controller/DefaultController.php</span>
<span class="kw2">namespace</span> Acme\TaskBundle\Controller<span class="sy0">;</span>
&nbsp;
<span class="kw2">use</span> Symfony\Bundle\FrameworkBundle\Controller\Controller<span class="sy0">;</span>
<span class="kw2">use</span> Acme\TaskBundle\Entity\Task<span class="sy0">;</span>
<span class="kw2">use</span> Symfony\Component\HttpFoundation\Request<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> DefaultController <span class="kw2">extends</span> Controller
<span class="br0">&#123;</span>
    <span class="kw2">public</span> <span class="kw2">function</span> newAction<span class="br0">&#40;</span>Request <span class="re0">$request</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="co1">// crea una task y le asigna algunos datos ficticios para este ejemplo</span>
        <span class="re0">$task</span> <span class="sy0">=</span> <span class="kw2">new</span> Task<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$task</span><span class="sy0">-&gt;</span><span class="me1">setTask</span><span class="br0">&#40;</span><span class="st_h">'Write a blog post'</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="re0">$task</span><span class="sy0">-&gt;</span><span class="me1">setDueDate</span><span class="br0">&#40;</span><span class="kw2">new</span> \DateTime<span class="br0">&#40;</span><span class="st_h">'tomorrow'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="re0">$form</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">createFormBuilder</span><span class="br0">&#40;</span><span class="re0">$task</span><span class="br0">&#41;</span>
            <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'task'</span><span class="sy0">,</span> <span class="st_h">'text'</span><span class="br0">&#41;</span>
            <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'dueDate'</span><span class="sy0">,</span> <span class="st_h">'date'</span><span class="br0">&#41;</span>
            <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'save'</span><span class="sy0">,</span> <span class="st_h">'submit'</span><span class="br0">&#41;</span>
            <span class="sy0">-&gt;</span><span class="me1">getForm</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
        <span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">render</span><span class="br0">&#40;</span><span class="st_h">'AcmeTaskBundle:Default:new.html.twig'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
            <span class="st_h">'form'</span> <span class="sy0">=&gt;</span> <span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">createView</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">,</span>
        <span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<div class="admonition tip"><p><strong class="title">Truco</strong> Este ejemplo muestra cómo crear el formulario directamente en el controlador. Más adelante en este mismo capítulo aprenderás a construir tu formulario en una clase independiente, lo que es muy recomendable para hacer que tu formulario sea reutilizable.</p></div>

<p>La creación de un formulario requiere de muy poco código, porque los objetos <code>Form</code> de Symfony2 se crean con un <em>"generador de formularios"</em> (o <em>form builder</em> en inglés). El generador de formularios te permite definir los formularios con unas instrucciones sencillas y después él se encarga de todo el trabajo duro de crear realmente el formulario.</p>

<p>En este ejemplo, se han añadido dos campos al formulario (<code>task</code> y <code>dueDate</code>) que se corresponden con las propiedades <code>task</code> y <code>dueDate</code> de la clase <code>Task</code>.
También se asigna un tipo de dato a cada campo (<code>text</code> y <code>date</code>), para que Symfony sepa qué tipo de etiqueta HTML debe mostrar para cada campo. Por último, se ha añadido un botón para enviar el formulario al servidor.</p>

<p>La opción de añadir botones a los formularios está disponible desde la versión 2.3 de Symfony. En las versiones anteriores tienes que añadir los botones a mano mediante el código HTML correspondiente.</p>

<p>Symfony2 incluye muchos tipos de datos, tal y como se explicará en las próximas secciones.</p>

<h3 id="mostrando_el_formulario">12.1.2. Mostrando el formulario</h3>

<p>Una vez creado el formulario, el siguiente paso es renderizarlo. Para ello puedes pasar a la plantilla un objeto especial de formulario (que se crea con el método <code>$form-&gt;createView()</code>) y también puedes utilizar los diferentes <em>helpers</em> definidos por Symfony:</p>

<div class="tabbable">
  <ul class="nav nav-tabs"><li id="select_tab_1_aac0a" class="active"><a data-toggle="tab active" href="#select_tab_1_aac0a" onclick="document.getElementById('select_tab_1_aac0a').className='active'; document.getElementById('tab_1_aac0a').className='tab-pane active';document.getElementById('select_tab_2_aac0a').className='';  document.getElementById('tab_2_aac0a').className='tab-pane';return false;">TWIG</a></li><li id="select_tab_2_aac0a"><a data-toggle="tab" href="#select_tab_2_aac0a" onclick="document.getElementById('select_tab_1_aac0a').className='';  document.getElementById('tab_1_aac0a').className='tab-pane';document.getElementById('select_tab_2_aac0a').className='active'; document.getElementById('tab_2_aac0a').className='tab-pane active';return false;">PHP</a></li></ul>
  <div class="tab-content">
    <div class="tab-pane active" id="tab_1_aac0a">
<div class="code twig">
<pre class="twig"><span class="sc1"><span class="coMULTI">{&#35; src/Acme/TaskBundle/Resources/views/Default/new.html.twig &#35;}</span></span>
&nbsp;
<span class="kw6"><span class="br0">&#123;</span><span class="br0">&#123;</span></span> <span class="re0">form</span><span class="br0">&#40;</span>form<span class="br0">&#41;</span> <span class="kw6"><span class="br0">&#125;</span><span class="br0">&#125;</span></span></pre>
</div>
</div>


<div class="tab-pane" id="tab_2_aac0a">
<div class="code php">
<pre class="php">&lt;!-- src/Acme/TaskBundle/Resources/views/Default/new.html.php --&gt;
&nbsp;
<span class="kw2">&lt;?php</span> <span class="kw1">echo</span> <span class="re0">$view</span><span class="br0">&#91;</span><span class="st_h">'form'</span><span class="br0">&#93;</span><span class="sy0">-&gt;</span><span class="me1">form</span><span class="br0">&#40;</span><span class="re0">$form</span><span class="br0">&#41;</span> <span class="sy1">?&gt;</span></pre>
</div>
</div>

  </div>
</div>

<div class="figure" id="figure_12_1">
    <img src="/img/symfony_2_0/form-simple.png" alt="Resultado de mostrar un formulario sencillo" />

    <p class="caption"><strong>Figura 12.1</strong> Resultado de mostrar un formulario sencillo</p>
</div>


<div class="admonition note"><p><strong class="title">Nota</strong> El código del ejemplo anterior supone que el formulario se envía mediante una petición <code>POST</code> a la misma URL que se accedió para mostrar el formulario. Más adelante se explicará cómo modificar el método utilizado y la URL a la que se envían los datos.</p></div>

<p>¡Y ya está! Al renderizar el <em>helper</em> <code>form(form)</code>, se renderizan todos los campos del formulario, cada uno con su etiqueta <code>&lt;label&gt;</code> y su mensaje de error (si es que se ha producido algún error). La función <code>form</code> también encierra todos los contenidos en la correspondiente etiqueta <code>&lt;form&gt;</code> de HTML. Aunque es una forma muy sencilla de mostrar un formulario completo, no es muy flexible. Normalmente es preferible renderizar cada campo individualmente para poder controlar con precisión cómo se muestra. Esto se explica más adelante en este mismo capítulo.</p>

<p>Antes de continuar, observa cómo el campo <code>task</code> renderizado tiene el valor de la propiedad <code>task</code> del objeto <code>$task</code> (en este ejemplo, verás el texto <em>Write a blog post</em>). Esta es la primera tarea importante del formulario: obtener los datos de un objeto y transformarlos para que se puedan mostrar correctamente en un formulario.</p>

<div class="admonition tip"><p><strong class="title">Truco</strong> El sistema de formularios es lo suficientemente inteligente como para acceder al valor de la propiedad protegida <code>task</code> a través de los métodos <code>getTask()</code> y <code>setTask()</code> de la clase <code>Task</code>. A menos que una propiedad sea pública, es obligatorio añadir los <em>getters</em> y <em>setters</em> para que el componente <code>Form</code> pueda obtener y guardar datos en la propiedad. Para las propiedades <em>booleanas</em>, puedes utilizar un método <em>isser</em> (por ejemplo, <code>isPublished()</code>) o <em>hasser</em> (por ejemplo, <code>hasReminder()</code>) en lugar de un <em>getter</em> (por ejemplo, <code>getPublished()</code> o <code>getReminder()</code>).</p></div>

<h3 id="procesando_el_envio_del_formulario">12.1.3. Procesando el envío del formulario</h3>

<p>La segunda responsabilidad del formulario consiste en traducir los datos enviados por el usuario a las propiedades del objeto. Para ello, primero se guardan en el formulario los datos enviados por el usuario, tal y como muestra el siguiente ejemplo:</p>

<div class="code php">
<pre class="php"><span class="co1">// ...</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">function</span> newAction<span class="br0">&#40;</span>Request <span class="re0">$request</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="co1">// crear un objeto $task nuevo (borra los datos de prueba)</span>
    <span class="re0">$task</span> <span class="sy0">=</span> <span class="kw2">new</span> Task<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="re0">$form</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">createFormBuilder</span><span class="br0">&#40;</span><span class="re0">$task</span><span class="br0">&#41;</span>
        <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'task'</span><span class="sy0">,</span> <span class="st_h">'text'</span><span class="br0">&#41;</span>
        <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'dueDate'</span><span class="sy0">,</span> <span class="st_h">'date'</span><span class="br0">&#41;</span>
        <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'save'</span><span class="sy0">,</span> <span class="st_h">'submit'</span><span class="br0">&#41;</span>
        <span class="sy0">-&gt;</span><span class="me1">getForm</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">handleRequest</span><span class="br0">&#40;</span><span class="re0">$request</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">isValid</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="co1">// guardar la tarea en la base de datos</span>
&nbsp;
        <span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">redirect</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">generateUrl</span><span class="br0">&#40;</span><span class="st_h">'task_success'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
</div>

<p>El método <code>handleRequest()</code> está disponible desde la versión 2.3 de Symfony. En las versiones anteriores se pasaba el objeto <code>$request</code> al método <code>submit()</code>. Este último comportamiento se ha declarado obsoleto y se eliminará en Symfony 3.0.</p>

<p>El controlador del ejemplo anterior sigue el flujo de trabajo habitual para el manejo de formularios, que consiste en:</p>

<ol>
<li>Cuando se carga por primera vez la página asociada a este controlador, se crea y renderiza el formulario. El método <code>handleRequest()</code> detecta que el formulario <strong>no</strong> se ha enviado y por tanto, no hace nada. El método <code>isValid()</code> devuelve <code>false</code> si el formulario no se ha enviado.</li>
<li>Cuando el usuario envía el formulario, el método <code>handleRequest()</code> lo detecta y guarda inmediatamente los datos enviados en las propiedades <code>task</code> y <code>dueDate</code> del objeto <code>$task</code>. Después se valida este objeto. Si no es válido, el método <code>isValid()</code> devuelve <code>false</code> otra vez, por lo que se vuelve a mostrar el formulario, esta vez con los mensajes de error correspondientes. Si solamente quieres comprobar si el formulario se ha enviado, independientemente de si es válido o no, utiliza el método <code>isSubmitted()</code>.</li>
<li>Cuando el usuario envía el formulario con datos válidos, los datos enviados se guardan de nuevo en el formulario, pero esta vez el método <code>isValid()</code> devuelve <code>true</code>. En este momento ya puedes trabajar con el objeto <code>$task</code> (por ejemplo guardándolo en una base de datos) antes de redirigir al usuario a otra página (por ejemplo a la página de agradecimiento o a la que muestra un mensaje determinado).</li>
</ol>

<div class="admonition note"><p><strong class="title">Nota</strong> Redirigir a un usuario después de enviar el formulario evita que el usuario pueda pulsar sobre el botón <em>Actualizar</em> del navegador provocando un nuevo envío del formulario.</p></div>

<h3 id="enviando_formularios_con_varios_botones">12.1.4. Enviando formularios con varios botones</h3>

<p>Esta característica solamente está disponible desde la versión 2.3 de Symfony.</p>

<p>Cuando el formulario contiene más de un botón de envío, es necesario comprobar en el controlador qué botón concreto se ha pulsado. En primer lugar, modifica ligeramente el formulario de los ejemplos anteriores para añadir un segundo botón llamado <em>"Save and add"</em>:</p>

<div class="code php">
<pre class="php"><span class="re0">$form</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">createFormBuilder</span><span class="br0">&#40;</span><span class="re0">$task</span><span class="br0">&#41;</span>
    <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'task'</span><span class="sy0">,</span> <span class="st_h">'text'</span><span class="br0">&#41;</span>
    <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'dueDate'</span><span class="sy0">,</span> <span class="st_h">'date'</span><span class="br0">&#41;</span>
    <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'save'</span><span class="sy0">,</span> <span class="st_h">'submit'</span><span class="br0">&#41;</span>
    <span class="sy0">-&gt;</span><span class="me1">add</span><span class="br0">&#40;</span><span class="st_h">'saveAndAdd'</span><span class="sy0">,</span> <span class="st_h">'submit'</span><span class="br0">&#41;</span>
    <span class="sy0">-&gt;</span><span class="me1">getForm</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>

<p>Dentro del controlador, utiliza el método <code>isClicked()</code> para comprobar si se ha pulsado el botón <em>"Save and add"</em>:</p>

<div class="code php">
<pre class="php"><span class="kw1">if</span> <span class="br0">&#40;</span><span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">isValid</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="co1">// ... haz algo con los datos, como por ejemplo guardarlos</span>
    <span class="co1">// en la base de datos ...</span>
&nbsp;
    <span class="re0">$nextAction</span> <span class="sy0">=</span> <span class="re0">$form</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'saveAndAdd'</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">isClicked</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
        ? <span class="st_h">'task_new'</span>
        <span class="sy0">:</span> <span class="st_h">'task_success'</span><span class="sy0">;</span>
&nbsp;
    <span class="kw1">return</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">redirect</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">generateUrl</span><span class="br0">&#40;</span><span class="re0">$nextAction</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre>
</div>



            <div class="module module-ad module-ad-responsive module-ad-bottom">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-pager">
        <ul class="row pager">
            <li class="col-xs-6 previous ">
                                    <a href="../capitulo_12.html">
                        <strong>&larr; Anterior</strong>
                        <small>Capítulo 12. Formularios</small>
                    </a>
                            </li>

            <li class="col-xs-6 next ">
                                    <a href="../capitulo_12/validando_formularios.html">
                        <strong>Siguiente &rarr;</strong>
                        <small>12.2. Validando formularios</small>
                    </a>
                            </li>
        </ul>
    </div>

                        </div>

                    <div id="sidebar" class="col-sm-3">
                        
            <div class="module module-share">
        <h3>Compartir</h3>
        <ul>
    <li><a id="share_twitter" href="#" title="Compartir en Twitter">Twitter</a></li>
    <li><a id="share_facebook" href="#" title="Compartir en Facebook">Facebook</a></li>
    <li><a id="share_google" href="#" title="Compartir en Google+">Google+</a></li>
</ul>

<script type="text/javascript">
var title    = '{{ item_social_title }}';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) {
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;

            ga('send', 'social', {
                'socialNetwork' : a.id.substr(6),
                'socialAction'  : 'share',
                'socialTarget'  : window.location
            });

            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

    </div>

            <div class="module module-ad module-ad-responsive module-ad-sidebar">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-toc" class="module">
        <a id="indice"></a>

        <h3>Indice de contenidos</h3>
        <ul class="toc text-links">
                                            <li class="level-1">
                <span>1.</span> <a href="../capitulo_1.html"> Symfony2 y los fundamentos de HTTP</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>2.</span> <a href="../capitulo_2.html"> De PHP a Symfony2</a>
            </li>
                                                                                                            <li class="level-1">
                <span>3.</span> <a href="../capitulo_3.html"> Instalando y configurando Symfony2</a>
            </li>
                                                                                            <li class="level-1">
                <span>4.</span> <a href="../capitulo_4.html"> Creando páginas en Symfony2</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>5.</span> <a href="../capitulo_5.html"> El controlador</a>
            </li>
                                                                                                                                                                                                            <li class="level-1">
                <span>6.</span> <a href="../capitulo_6.html"> El enrutamiento</a>
            </li>
                                                                                                                                                                                            <li class="level-1">
                <span>7.</span> <a href="../capitulo_7.html"> Creando y utilizando plantillas</a>
            </li>
                                                                                                                                                                                                                                                                            <li class="level-1">
                <span>8.</span> <a href="../capitulo_8.html"> La base de datos y Doctrine</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>9.</span> <a href="../capitulo_9.html"> La base de datos y Propel</a>
            </li>
                                            <li class="level-1">
                <span>10.</span> <a href="../capitulo_10.html"> Tests unitarios y funcionales</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>11.</span> <a href="../capitulo_11.html"> Validación</a>
            </li>
                                                                                                                                                                                            <li class="level-1 ">
                <a href="../capitulo_12.html">
                    <span>Capítulo 12.</span> Formularios
                </a>
            </li>
                                            <li class="level-2 active">
                <a href="../capitulo_12/creando_un_formulario_sencillo.html">
                    <span>12.1.</span>  Creando un formulario sencillo
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/validando_formularios.html">
                    <span>12.2.</span> Validando formularios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/tipos_de_campo_predefinidos.html">
                    <span>12.3.</span> Tipos de campo predefinidos
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/deduciendo_el_tipo_de_campo.html">
                    <span>12.4.</span> Deduciendo el tipo de campo
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/mostrando_un_formulario_en_una_plantilla.html">
                    <span>12.5.</span> Mostrando un formulario en una plantilla
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/modificando_la_accion_y_el_metodo_de_un_formulario.html">
                    <span>12.6.</span> Modificando la acción y el método de un formulario
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/creando_clases_de_formulario.html">
                    <span>12.7.</span> Creando clases de formulario
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/definiendo_formularios_como_servicios.html">
                    <span>12.8.</span> Definiendo formularios como servicios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/formularios_y_doctrine.html">
                    <span>12.9.</span> Formularios y Doctrine
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/embebiendo_formularios.html">
                    <span>12.10.</span> Embebiendo formularios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/temas_para_formularios.html">
                    <span>12.11.</span> Temas para formularios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/proteccion_csrf.html">
                    <span>12.12.</span> Protección CSRF
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/usando_un_formulario_sin_clase.html">
                    <span>12.13.</span> Usando un formulario sin clase
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_12/consideraciones_finales.html">
                    <span>12.14.</span> Consideraciones finales
                </a>
            </li>
                                            <li class="level-1">
                <span>13.</span> <a href="../capitulo_13.html"> Seguridad</a>
            </li>
                                                                                                                                                                                                                                            <li class="level-1">
                <span>14.</span> <a href="../capitulo_14.html"> La caché de HTTP</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>15.</span> <a href="../capitulo_15.html"> Internacionalización</a>
            </li>
                                                                                                                                                                                                                            <li class="level-1">
                <span>16.</span> <a href="../capitulo_16.html"> El contenedor de servicios</a>
            </li>
                                                                                                                                                                                                            <li class="level-1">
                <span>17.</span> <a href="../capitulo_17.html"> Mejorando el rendimiento</a>
            </li>
                                                                                                            <li class="level-1">
                <span>18.</span> <a href="../capitulo_18.html"> El interior de Symfony2</a>
            </li>
                                                                                                            <li class="level-1">
                <span>19.</span> <a href="../capitulo_19.html"> La API estable de Symfony2</a>
            </li>
                        </ul>
    </div>
                    </div>
                            </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
