<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml" xml:lang="es" lang="es">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <title>16.6. Inyectando servicios (Symfony 2.4, el libro oficial)</title>
                                    <link rel="stylesheet" href="/css/app.css" />
                        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82842-2', 'librosweb.es');
            ga('require', 'displayfeatures');
            ga('send', 'pageview');
        </script>
                        <link rel="apple-touch-icon" type="image/png" href="/apple-touch-icon.png">
        <link rel="apple-touch-icon-precomposed" type="image/png" href="/apple-touch-icon.png">
        <meta name="apple-mobile-web-app-title" content="LibrosWeb">
        <link rel="shortcut icon" type="image/png" href="/favicon.png">
        <meta name="site-version" content="a7f65a4">
                <link rel="publisher" href="http://plus.google.com/112008023125011571577">
                            
        <link rel="canonical" href="/libro/symfony_2_x/capitulo_16/inyectando_servicios.html"/>
                                    <link rel="prev" href="../capitulo_16/importando_otros_recursos_para_configurar_el_contenedor.html" />
                    <link rel="next" href="../capitulo_16/inyectando_servicios_opcionales.html" />
                <link rel="start" href="/libro/symfony_2_4/" />
                <meta name="twitter:site" content="@librosweb">
                <link rel="search" type="application/opensearchdescription+xml" href="http://librosweb.es/opensearch/documentation.xml" title="LibrosWeb">
                <meta property="fb:page_id" content="437758756273955">
                <meta property="fb:app_id" content="437758756273955">
        <meta property="og:type" content="website">
        <meta property="og:title" content="16.6. Inyectando servicios (Symfony 2.4, el libro oficial)">
        <meta property="og:image" content="http://www.gravatar.com/avatar/9f219b4dfaa677bfd0f47753c02d5126.png?s=200">
                <meta name="msapplication-TileColor" content="#CC1414">
        <meta name="application-name" content="LibrosWeb">
        <meta name="msapplication-tooltip" content="Libros y tutoriales sobre HTML, CSS, JavaScript, PHP y otras tecnologías web.">
    </head>

    <body id="p-1-2" class="books book_page symfony_2_4"><script type="text/javascript">
//<![CDATA[
try{(function(a){var b="http://",c="librosweb.es",d="/cdn-cgi/cl/",e="img.gif",f=new a;f.src=[b,c,d,e].join("")})(Image)}catch(e){}
//]]>
</script>
        <div class="content-background"></div>

        <div id="header">
            <div class="navbar navbar-default navbar-static-top">
              <div class="container">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-menu">
                    <span class="sr-only">Desplegar menú</span>
                    <i class="fa fa-menu"></i>
                  </button>
                  <a class="navbar-brand" href="/" title="LibrosWeb.es">
                      <svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 132 32" preserveAspectRatio="xMinYMin meet">
<g fill="#CC1414" transform="translate(-21.738 -21.148)">
<path d="m24.062 23.486v28h9.64v-5h-4.04v-23h-5.6"/>
<path d="m40.796 23.486h-5.6v28h5.6v-28"/>
<path d="m53.932 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32 1-1 1h-1.32v-6.64h1.32c0.68 0 1 0.32 1 1m-2.32 10.32h1.4c0.68 0 1 0.32 1 1v5.08c0 0.68-0.32 1-1 1h-1.4v-7.08"/>
<path d="m69.284 38.246c1.52-0.56 2.4-1.76 2.4-4.16v-5.4c0-3.48-1.72-5.2-5.2-5.2h-8.36v28h5.6v-10.6h1.4c0.68 0 1 0.32 1 1v9.6h5.6v-9.64c0-2.04-0.72-3.12-2.44-3.6m-3.2-8.88v5.76c0 0.68-0.32 1-1 1h-1.36v-7.76h1.36c0.68 0 1 0.32 1 1"/>
<path d="m87.513 46.526v-18.08c0-3.48-1.72-5.2-5.2-5.2h-3.6c-3.48 0-5.2 1.72-5.2 5.2v18.08c0 3.48 1.72 5.2 5.2 5.2h3.6c3.48 0 5.2-1.72 5.2-5.2m-5.6-17.48v16.88c0 0.68-0.32 1-1 1h-0.8c-0.68 0-1-0.32-1-1v-16.88c0-0.68 0.32-1 1-1h0.8c0.68 0 1 0.32 1 1"/>
<path d="m100.57 36.966-4.8-3.56c-0.68-0.48-0.96-0.92-0.96-1.8v-2.64c0-0.68 0.32-1 1-1h0.44c0.68 0 1 0.32 1 1v4.6h5.48v-5.12c0-3.48-1.72-5.2-5.2-5.2h-3.04c-3.48 0-5.2 1.72-5.2 5.2v4.44c0 2 0.52 3.16 2.24 4.4l4.8 3.56c0.68 0.48 0.96 0.92 0.96 1.8v3.36c0 0.68-0.32 1-1 1h-0.52c-0.68 0-1-0.32-1-1v-5.44h-5.48v5.96c0 3.48 1.72 5.2 5.2 5.2h3.12c3.48 0 5.2-1.72 5.2-5.2v-5.16c0-2.08-0.52001-3.16-2.24-4.4"/>
<path d="m106.98 51.486h6.16l1.44-12.72 1.44 12.72h6.16l3.4-28h-4.96l-1.44 14.88-1.6-14.88h-5.28l-1.6 14.92-1.44-14.92h-5.68l3.4 28"/>
<path d="m126.87 23.486v28h10.48v-5h-4.88v-6.72h4.6v-5h-4.6v-6.28h4.8v-5h-10.4"/>
<path d="m150.26 37.006c1.48-0.56 2.32-1.76 2.32-4.16v-4.16c0-3.48-1.72-5.2-5.2-5.2h-8.24v28h8.32c3.48 0 5.2-1.72 5.2-5.2v-5.68c0-2.04-0.72001-3.12-2.4-3.6m-3.24-7.72v4.64c0 0.68-0.32001 1-1 1h-1.32v-6.64h1.32c0.67999 0 1 0.32 1 1m-2.32 10.32h1.4c0.67999 0 1 0.32 1 1v5.08c0 0.68-0.32001 1-1 1h-1.4v-7.08"/>
</g>
</svg>
                      <span>LibrosWeb</span>
                  </a>
                </div>

                <div class="collapse navbar-collapse navbar-right" id="header-menu">
                  <ul class="nav navbar-nav pull-right">
                    
                                                <li class="">
                            <a href="/">
                                Inicio
                            </a>
                        </li>
                                                <li class="active">
                            <a href="/libros/">
                                Libros
                            </a>
                        </li>
                                                <li class="">
                            <a href="/tutoriales/">
                                Tutoriales
                            </a>
                        </li>
                                                <li class="">
                            <a href="/eventos/">
                                Eventos
                            </a>
                        </li>
                                                <li class="">
                            <a href="/foro/">
                                Foro
                            </a>
                        </li>
                                                <li class="">
                            <a href="/buscar">
                                Buscar
                            </a>
                        </li>
                                          </ul>
                </div>
              </div>
            </div>
        </div>

        <div id="wrapper" class="container">

            <div id="content" class="row">
                                    <div id="main" class="col-sm-9">
                        
    
    <div id="book-toc-anchor" class="well visible-xs">
        <a href="#indice">
            <i class="fa fa-book"></i> Ver índice de contenidos del libro
        </a>
    </div>

    <div id="breadcrumb" class="hidden-xs">
        <ol>
            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libros/" itemprop="url">
                    <span itemprop="title">Libros</span>
                </a>
            </li>

            <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/symfony_2_4/" itemprop="url">
                    <span itemprop="title">Symfony 2.4, el libro oficial</span>
                </a>
            </li>

                    <li itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
                <a href="/libro/symfony_2_4/capitulo_16.html" itemprop="url">
                    <span itemprop="title">Capítulo 16. El contenedor de servicios</span>
                </a>
            </li>
        
            <li class="active">
                <span>16.6. Inyectando servicios</span>
            </li>
        </ol>
    </div>

    <h1 id="inyectando_servicios" class="title">
        <span>16.6.</span> Inyectando servicios
    </h1>

    

<p>Hasta el momento, nuestro servicio original <code>my_mailer</code> es muy sencillo ya que sólo toma un argumento (fácilmente configurable) en su constructor. No obstante, el verdadero poder del contenedor se obtiene cuando al crear un servicio es necesario crear otros servicios de los que depende.</p>

<p>Supongamos por ejemplo que tienes un nuevo servicio, <code>NewsletterManager</code>, que facilita el envío de <em>newsletters</em> a una serie de direcciones de email. Como ya disponemos del servicio <code>my_mailer</code> para enviar emails, vamos a utilizarlo dentro de <code>NewsletterManager</code> para manejar el envío de los mensajes. Esta clase podría tener el siguiente aspecto:</p>

<div class="code php">
<pre class="php"><span class="co1">// src/Acme/HelloBundle/Newsletter/NewsletterManager.php</span>
<span class="kw2">namespace</span> Acme\HelloBundle\Newsletter<span class="sy0">;</span>
&nbsp;
<span class="kw2">use</span> Acme\HelloBundle\Mailer<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> NewsletterManager
<span class="br0">&#123;</span>
    <span class="kw2">protected</span> <span class="re0">$mailer</span><span class="sy0">;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> __construct<span class="br0">&#40;</span>Mailer <span class="re0">$mailer</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">mailer</span> <span class="sy0">=</span> <span class="re0">$mailer</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Sin utilizar el contenedor de servicios, puedes crear fácilmente un nuevo <code>NewsletterManager</code> dentro de un controlador:</p>

<div class="code php">
<pre class="php"><span class="kw2">use</span> Acme\HelloBundle\Newsletter\NewsletterManager<span class="sy0">;</span>
&nbsp;
<span class="co1">// ...</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">function</span> sendNewsletterAction<span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="re0">$mailer</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">&#40;</span><span class="st_h">'my_mailer'</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="re0">$newsletter</span> <span class="sy0">=</span> <span class="kw2">new</span> NewsletterManager<span class="br0">&#40;</span><span class="re0">$mailer</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
</div>

<p>El código anterior es correcto, pero, ¿si más adelante decides que la clase <code>NewsletterManager</code> necesita un segundo o tercer argumento en su constructor? ¿Y si decides reconstruir tu código y cambiar el nombre de la clase? En ambos casos, habría que encontrar todos los lugares donde se crea una instancia de <code>NewsletterManager</code> y modificarla. Obviamente, el contenedor de servicios te ofrece una alternativa mucho más interesante:</p>

<div class="tabbable">
  <ul class="nav nav-tabs"><li id="select_tab_1_c0312" class="active"><a data-toggle="tab active" href="#select_tab_1_c0312" onclick="document.getElementById('select_tab_1_c0312').className='active'; document.getElementById('tab_1_c0312').className='tab-pane active';document.getElementById('select_tab_2_c0312').className='';  document.getElementById('tab_2_c0312').className='tab-pane';document.getElementById('select_tab_3_c0312').className='';  document.getElementById('tab_3_c0312').className='tab-pane';return false;">YAML</a></li><li id="select_tab_2_c0312"><a data-toggle="tab" href="#select_tab_2_c0312" onclick="document.getElementById('select_tab_1_c0312').className='';  document.getElementById('tab_1_c0312').className='tab-pane';document.getElementById('select_tab_2_c0312').className='active'; document.getElementById('tab_2_c0312').className='tab-pane active';document.getElementById('select_tab_3_c0312').className='';  document.getElementById('tab_3_c0312').className='tab-pane';return false;">XML</a></li><li id="select_tab_3_c0312"><a data-toggle="tab" href="#select_tab_3_c0312" onclick="document.getElementById('select_tab_1_c0312').className='';  document.getElementById('tab_1_c0312').className='tab-pane';document.getElementById('select_tab_2_c0312').className='';  document.getElementById('tab_2_c0312').className='tab-pane';document.getElementById('select_tab_3_c0312').className='active'; document.getElementById('tab_3_c0312').className='tab-pane active';return false;">PHP</a></li></ul>
  <div class="tab-content">
    <div class="tab-pane active" id="tab_1_c0312">
<div class="code yaml">
<pre class="yaml"><span class="co1"># src/Acme/HelloBundle/Resources/config/services.yml</span><span class="co4">
parameters</span><span class="sy2">:
</span>    <span class="co1"># ...</span><span class="co3">
    newsletter_manager.class</span><span class="sy2">: </span>Acme\HelloBundle\Newsletter\NewsletterManager
<span class="co4">
services</span>:<span class="co4">
    my_mailer</span><span class="sy2">:
</span>        <span class="co1"># ...</span><span class="co4">
    newsletter_manager</span>:<span class="co3">
        class</span><span class="sy2">: </span>    <span class="co2">%newsletter_manager.class%</span><span class="co3">
        arguments</span><span class="sy2">: </span><span class="br0">&#91;</span><span class="st0">&quot;@my_mailer&quot;</span><span class="br0">&#93;</span></pre>
</div>
</div>


<div class="tab-pane" id="tab_2_c0312">
<div class="code xml">
<pre class="xml"><span class="sc-1">&lt;!-- src/Acme/HelloBundle/Resources/config/services.xml --&gt;</span>
<span class="sc3"><span class="re1">&lt;parameters<span class="re2">&gt;</span></span></span>
    <span class="sc-1">&lt;!-- ... --&gt;</span>
    <span class="sc3"><span class="re1">&lt;parameter</span> <span class="re0">key</span>=<span class="st0">&quot;newsletter_manager.class&quot;</span><span class="re2">&gt;</span></span>Acme\HelloBundle\Newsletter\NewsletterManager<span class="sc3"><span class="re1">&lt;/parameter<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/parameters<span class="re2">&gt;</span></span></span>
&nbsp;
<span class="sc3"><span class="re1">&lt;services<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;service</span> <span class="re0">id</span>=<span class="st0">&quot;my_mailer&quot;</span> ...<span class="re2">&gt;</span></span>
      <span class="sc-1">&lt;!-- ... --&gt;</span>
    <span class="sc3"><span class="re1">&lt;/service<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;service</span> <span class="re0">id</span>=<span class="st0">&quot;newsletter_manager&quot;</span> <span class="re0">class</span>=<span class="st0">&quot;%newsletter_manager.class%&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;argument</span> <span class="re0">type</span>=<span class="st0">&quot;service&quot;</span> <span class="re0">id</span>=<span class="st0">&quot;my_mailer&quot;</span><span class="re2">/&gt;</span></span>
    <span class="sc3"><span class="re1">&lt;/service<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/services<span class="re2">&gt;</span></span></span></pre>
</div>
</div>


<div class="tab-pane" id="tab_3_c0312">
<div class="code php">
<pre class="php"><span class="co1">// src/Acme/HelloBundle/Resources/config/services.php</span>
<span class="kw2">use</span> Symfony\Component\DependencyInjection\Definition<span class="sy0">;</span>
<span class="kw2">use</span> Symfony\Component\DependencyInjection\Reference<span class="sy0">;</span>
&nbsp;
<span class="co1">// ...</span>
<span class="re0">$container</span><span class="sy0">-&gt;</span><span class="me1">setParameter</span><span class="br0">&#40;</span>
    <span class="st_h">'newsletter_manager.class'</span><span class="sy0">,</span>
    <span class="st_h">'Acme\HelloBundle\Newsletter\NewsletterManager'</span>
<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="re0">$container</span><span class="sy0">-&gt;</span><span class="me1">setDefinition</span><span class="br0">&#40;</span><span class="st_h">'my_mailer'</span><span class="sy0">,</span> <span class="sy0">...</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$container</span><span class="sy0">-&gt;</span><span class="me1">setDefinition</span><span class="br0">&#40;</span><span class="st_h">'newsletter_manager'</span><span class="sy0">,</span> <span class="kw2">new</span> Definition<span class="br0">&#40;</span>
    <span class="st_h">'%newsletter_manager.class%'</span><span class="sy0">,</span>
    <span class="kw3">array</span><span class="br0">&#40;</span><span class="kw2">new</span> Reference<span class="br0">&#40;</span><span class="st_h">'my_mailer'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>
</div>

  </div>
</div>

<p>En YAML, la sintaxis especial <code>@my_mailer</code> le dice al contenedor que busque un servicio llamado <code>my_mailer</code> y pase ese objeto al constructor de <code>NewsletterManager</code>. Si el servicio especificado (<code>my_mailer</code>) no existe, se muestra una excepción. Por eso puedes marcar tus dependencias como opcionales, tal y como se explicará en la siguiente sección.</p>

<p>La utilización de referencias es una herramienta muy poderosa que te permite crear clases independientes con dependencias bien definidas. En este ejemplo, el servicio <code>newsletter_manager</code> necesita del servicio <code>my_mailer</code> para poder funcionar. Al definir esta dependencia en el contenedor de servicios, el contenedor se encarga de todo el trabajo de instanciar los objetos.</p>

<h3 id="utilizando_el_componente_expressionlanguage">16.6.1. Utilizando el componente ExpressionLanguage</h3>

<p>El contenedor de servicios también soporta el uso de expresiones desde la versión 2.4 de Symfony. Mediante el uso de expresiones es posible inyectar valores muy específicos en un servicio.</p>

<p>Imagina que dispones de un servicio llamado <code>mailer_configuration</code> que contiene un método <code>getMailerMethod()</code> que devuelve una cadena de texto como <code>sendmail</code> en función de las opciones de configuración. Volviendo al ejemplo mostrado al principio de este capítulo, otro servicio llamado <code>my_mailer</code> requiere como primer argumento una cadena de texto como <code>sendmail</code>.</p>

<p>En vez de escribir esta cadena de texto a mano como argumento del servicio <code>my_mailer</code>, puedes obtener el valor directamente a través del método <code>getMailerMethod()</code> del servicio <code>mailer_configuration</code>. Para ello, utiliza la siguiente expresión:</p>

<div class="tabbable">
  <ul class="nav nav-tabs"><li id="select_tab_1_c049d" class="active"><a data-toggle="tab active" href="#select_tab_1_c049d" onclick="document.getElementById('select_tab_1_c049d').className='active'; document.getElementById('tab_1_c049d').className='tab-pane active';document.getElementById('select_tab_2_c049d').className='';  document.getElementById('tab_2_c049d').className='tab-pane';document.getElementById('select_tab_3_c049d').className='';  document.getElementById('tab_3_c049d').className='tab-pane';return false;">YAML</a></li><li id="select_tab_2_c049d"><a data-toggle="tab" href="#select_tab_2_c049d" onclick="document.getElementById('select_tab_1_c049d').className='';  document.getElementById('tab_1_c049d').className='tab-pane';document.getElementById('select_tab_2_c049d').className='active'; document.getElementById('tab_2_c049d').className='tab-pane active';document.getElementById('select_tab_3_c049d').className='';  document.getElementById('tab_3_c049d').className='tab-pane';return false;">XML</a></li><li id="select_tab_3_c049d"><a data-toggle="tab" href="#select_tab_3_c049d" onclick="document.getElementById('select_tab_1_c049d').className='';  document.getElementById('tab_1_c049d').className='tab-pane';document.getElementById('select_tab_2_c049d').className='';  document.getElementById('tab_2_c049d').className='tab-pane';document.getElementById('select_tab_3_c049d').className='active'; document.getElementById('tab_3_c049d').className='tab-pane active';return false;">PHP</a></li></ul>
  <div class="tab-content">
    <div class="tab-pane active" id="tab_1_c049d">
<div class="code yaml">
<pre class="yaml"><span class="co1"># app/config/config.yml</span><span class="co4">
services</span>:<span class="co4">
    my_mailer</span>:<span class="co3">
        class</span><span class="sy2">: </span>       Acme\HelloBundle\Mailer<span class="co3">
        arguments</span><span class="sy2">: </span>   <span class="br0">&#91;</span><span class="st0">&quot;@=service('mailer_configuration').getMailerMethod()&quot;</span><span class="br0">&#93;</span></pre>
</div>
</div>


<div class="tab-pane" id="tab_2_c049d">
<div class="code xml">
<pre class="xml"><span class="sc-1">&lt;!-- app/config/config.xml --&gt;</span>
<span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;UTF-8&quot;</span> <span class="re2">?&gt;</span></span>
<span class="sc3"><span class="re1">&lt;container</span> <span class="re0">xmlns</span>=<span class="st0">&quot;http://symfony.com/schema/dic/services&quot;</span></span>
<span class="sc3">    <span class="re0">xmlns:xsi</span>=<span class="st0">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="sc3">    <span class="re0">xsi:schemaLocation</span>=<span class="st0">&quot;http://symfony.com/schema/dic/services</span>
<span class="sc3">        http://symfony.com/schema/dic/services/services-1.0.xsd&quot;</span></span>
<span class="sc3">    <span class="re2">&gt;</span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;services<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;service</span> <span class="re0">id</span>=<span class="st0">&quot;my_mailer&quot;</span> <span class="re0">class</span>=<span class="st0">&quot;Acme\HelloBundle\Mailer&quot;</span><span class="re2">&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;argument</span> <span class="re0">type</span>=<span class="st0">&quot;expression&quot;</span><span class="re2">&gt;</span></span>service('mailer_configuration').getMailerMethod()<span class="sc3"><span class="re1">&lt;/argument<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;/service<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/services<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/container<span class="re2">&gt;</span></span></span></pre>
</div>
</div>


<div class="tab-pane" id="tab_3_c049d">
<div class="code php">
<pre class="php"><span class="co1">// app/config/config.php</span>
<span class="kw2">use</span> Symfony\Component\DependencyInjection\Definition<span class="sy0">;</span>
<span class="kw2">use</span> Symfony\Component\ExpressionLanguage\Expression<span class="sy0">;</span>
&nbsp;
<span class="re0">$container</span><span class="sy0">-&gt;</span><span class="me1">setDefinition</span><span class="br0">&#40;</span><span class="st_h">'my_mailer'</span><span class="sy0">,</span> <span class="kw2">new</span> Definition<span class="br0">&#40;</span>
    <span class="st_h">'Acme\HelloBundle\Mailer'</span><span class="sy0">,</span>
    <span class="kw3">array</span><span class="br0">&#40;</span><span class="kw2">new</span> Expression<span class="br0">&#40;</span><span class="st_h">'service(&quot;mailer_configuration&quot;).getMailerMethod()'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>
</div>

  </div>
</div>

<p>Consulta la <a href="http://symfony.com/doc/2.4/components/expression_language/introduction.html#expression-syntax">documentación del componente ExpressionLanguage</a> para conocer todas las opciones de su sintaxis.</p>

<p>Dentro de una expresión del contenedor de servicios, tienes acceso a las dos siguientes funciones:</p>

<ul>
<li><code>service</code>, devuelve el servicio cuyo <code>id</code> se indica.</li>
<li><code>parameter</code>, devuelve el valor del parámetro indicado (la sintaxis es idéntica a la de la función <code>service</code> anterior)</li>
</ul>

<p>Las expresiones también tienen acceso a una variable de tipo <code>Symfony\Component\DependencyInjection\ContainerBuilder</code> llamada <code>container</code>. El siguiente ejemplo muestra otro posible uso de las expresiones en el contenedor de servicios:</p>

<div class="tabbable">
  <ul class="nav nav-tabs"><li id="select_tab_1_c0607" class="active"><a data-toggle="tab active" href="#select_tab_1_c0607" onclick="document.getElementById('select_tab_1_c0607').className='active'; document.getElementById('tab_1_c0607').className='tab-pane active';document.getElementById('select_tab_2_c0607').className='';  document.getElementById('tab_2_c0607').className='tab-pane';document.getElementById('select_tab_3_c0607').className='';  document.getElementById('tab_3_c0607').className='tab-pane';return false;">YAML</a></li><li id="select_tab_2_c0607"><a data-toggle="tab" href="#select_tab_2_c0607" onclick="document.getElementById('select_tab_1_c0607').className='';  document.getElementById('tab_1_c0607').className='tab-pane';document.getElementById('select_tab_2_c0607').className='active'; document.getElementById('tab_2_c0607').className='tab-pane active';document.getElementById('select_tab_3_c0607').className='';  document.getElementById('tab_3_c0607').className='tab-pane';return false;">XML</a></li><li id="select_tab_3_c0607"><a data-toggle="tab" href="#select_tab_3_c0607" onclick="document.getElementById('select_tab_1_c0607').className='';  document.getElementById('tab_1_c0607').className='tab-pane';document.getElementById('select_tab_2_c0607').className='';  document.getElementById('tab_2_c0607').className='tab-pane';document.getElementById('select_tab_3_c0607').className='active'; document.getElementById('tab_3_c0607').className='tab-pane active';return false;">PHP</a></li></ul>
  <div class="tab-content">
    <div class="tab-pane active" id="tab_1_c0607">
<div class="code yaml">
<pre class="yaml"><span class="co4">services</span>:<span class="co4">
    my_mailer</span>:<span class="co3">
        class</span><span class="sy2">: </span>    Acme\HelloBundle\Mailer<span class="co3">
        arguments</span><span class="sy2">: </span><span class="br0">&#91;</span><span class="st0">&quot;@=container.hasParameter('some_param') ? parameter('some_param') : 'default_value'&quot;</span><span class="br0">&#93;</span></pre>
</div>
</div>


<div class="tab-pane" id="tab_2_c0607">
<div class="code xml">
<pre class="xml"><span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;UTF-8&quot;</span> <span class="re2">?&gt;</span></span>
<span class="sc3"><span class="re1">&lt;container</span> <span class="re0">xmlns</span>=<span class="st0">&quot;http://symfony.com/schema/dic/services&quot;</span></span>
<span class="sc3">    <span class="re0">xmlns:xsi</span>=<span class="st0">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="sc3">    <span class="re0">xsi:schemaLocation</span>=<span class="st0">&quot;http://symfony.com/schema/dic/services</span>
<span class="sc3">        http://symfony.com/schema/dic/services/services-1.0.xsd&quot;</span></span>
<span class="sc3">    <span class="re2">&gt;</span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;services<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;service</span> <span class="re0">id</span>=<span class="st0">&quot;my_mailer&quot;</span> <span class="re0">class</span>=<span class="st0">&quot;Acme\HelloBundle\Mailer&quot;</span><span class="re2">&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;argument</span> <span class="re0">type</span>=<span class="st0">&quot;expression&quot;</span><span class="re2">&gt;</span></span>@=container.hasParameter('some_param') ? parameter('some_param') : 'default_value'<span class="sc3"><span class="re1">&lt;/argument<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;/service<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/services<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/container<span class="re2">&gt;</span></span></span></pre>
</div>
</div>


<div class="tab-pane" id="tab_3_c0607">
<div class="code php">
<pre class="php"><span class="kw2">use</span> Symfony\Component\DependencyInjection\Definition<span class="sy0">;</span>
<span class="kw2">use</span> Symfony\Component\ExpressionLanguage\Expression<span class="sy0">;</span>
&nbsp;
<span class="re0">$container</span><span class="sy0">-&gt;</span><span class="me1">setDefinition</span><span class="br0">&#40;</span><span class="st_h">'my_mailer'</span><span class="sy0">,</span> <span class="kw2">new</span> Definition<span class="br0">&#40;</span>
    <span class="st_h">'Acme\HelloBundle\Mailer'</span><span class="sy0">,</span>
    <span class="kw3">array</span><span class="br0">&#40;</span><span class="kw2">new</span> Expression<span class="br0">&#40;</span>
        <span class="st0">&quot;@=container.hasParameter('some_param') ? parameter('some_param') : 'default_value'&quot;</span>
    <span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>
</div>

  </div>
</div>

<p>Las expresiones se pueden utilizar en <code>arguments</code> y <code>properties</code>, como argumentos de <code>configurator</code> y también como argumento de <code>calls</code>.</p>

<h3 id="dependencias_opcionales">16.6.2. Dependencias opcionales</h3>

<p>Inyectar dependencias en el constructor de esta manera es una excelente manera de asegurarte que la dependencia está disponible para usarla. No obstante, si las dependencias de una clase son opcionales, entonces es mucho mejor inyectarlas mediante métodos de tipo <em>setter</em>. Esto significa que la dependencia se inyecta mediante una llamada a un método en vez de a través del constructor. La clase ahora sería así:</p>

<div class="code php">
<pre class="php"><span class="kw2">namespace</span> Acme\HelloBundle\Newsletter<span class="sy0">;</span>
&nbsp;
<span class="kw2">use</span> Acme\HelloBundle\Mailer<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> NewsletterManager
<span class="br0">&#123;</span>
    <span class="kw2">protected</span> <span class="re0">$mailer</span><span class="sy0">;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> setMailer<span class="br0">&#40;</span>Mailer <span class="re0">$mailer</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">mailer</span> <span class="sy0">=</span> <span class="re0">$mailer</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Para inyectar el servicio de esta manera, sólo tienes que hacer un pequeño cambio en la sintaxis de la definición del servicio:</p>

<div class="tabbable">
  <ul class="nav nav-tabs"><li id="select_tab_1_c07b6" class="active"><a data-toggle="tab active" href="#select_tab_1_c07b6" onclick="document.getElementById('select_tab_1_c07b6').className='active'; document.getElementById('tab_1_c07b6').className='tab-pane active';document.getElementById('select_tab_2_c07b6').className='';  document.getElementById('tab_2_c07b6').className='tab-pane';document.getElementById('select_tab_3_c07b6').className='';  document.getElementById('tab_3_c07b6').className='tab-pane';return false;">YAML</a></li><li id="select_tab_2_c07b6"><a data-toggle="tab" href="#select_tab_2_c07b6" onclick="document.getElementById('select_tab_1_c07b6').className='';  document.getElementById('tab_1_c07b6').className='tab-pane';document.getElementById('select_tab_2_c07b6').className='active'; document.getElementById('tab_2_c07b6').className='tab-pane active';document.getElementById('select_tab_3_c07b6').className='';  document.getElementById('tab_3_c07b6').className='tab-pane';return false;">XML</a></li><li id="select_tab_3_c07b6"><a data-toggle="tab" href="#select_tab_3_c07b6" onclick="document.getElementById('select_tab_1_c07b6').className='';  document.getElementById('tab_1_c07b6').className='tab-pane';document.getElementById('select_tab_2_c07b6').className='';  document.getElementById('tab_2_c07b6').className='tab-pane';document.getElementById('select_tab_3_c07b6').className='active'; document.getElementById('tab_3_c07b6').className='tab-pane active';return false;">PHP</a></li></ul>
  <div class="tab-content">
    <div class="tab-pane active" id="tab_1_c07b6">
<div class="code yaml">
<pre class="yaml"><span class="co1"># src/Acme/HelloBundle/Resources/config/services.yml</span><span class="co4">
parameters</span><span class="sy2">:
</span>    <span class="co1"># ...</span><span class="co3">
    newsletter_manager.class</span><span class="sy2">: </span>Acme\HelloBundle\Newsletter\NewsletterManager
<span class="co4">
services</span>:<span class="co4">
    my_mailer</span><span class="sy2">:
</span>        <span class="co1"># ...</span><span class="co4">
    newsletter_manager</span>:<span class="co3">
        class</span><span class="sy2">: </span>    <span class="co2">%newsletter_manager.class%</span><span class="co4">
        calls</span><span class="sy2">:
</span>            - <span class="br0">&#91;</span>setMailer, <span class="br0">&#91;</span><span class="st0">&quot;@my_mailer&quot;</span><span class="br0">&#93;</span><span class="br0">&#93;</span></pre>
</div>
</div>


<div class="tab-pane" id="tab_2_c07b6">
<div class="code xml">
<pre class="xml"><span class="sc-1">&lt;!-- src/Acme/HelloBundle/Resources/config/services.xml --&gt;</span>
<span class="sc3"><span class="re1">&lt;parameters<span class="re2">&gt;</span></span></span>
    <span class="sc-1">&lt;!-- ... --&gt;</span>
    <span class="sc3"><span class="re1">&lt;parameter</span> <span class="re0">key</span>=<span class="st0">&quot;newsletter_manager.class&quot;</span><span class="re2">&gt;</span></span>Acme\HelloBundle\Newsletter\NewsletterManager<span class="sc3"><span class="re1">&lt;/parameter<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/parameters<span class="re2">&gt;</span></span></span>
&nbsp;
<span class="sc3"><span class="re1">&lt;services<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;service</span> <span class="re0">id</span>=<span class="st0">&quot;my_mailer&quot;</span> ...<span class="re2">&gt;</span></span>
      <span class="sc-1">&lt;!-- ... --&gt;</span>
    <span class="sc3"><span class="re1">&lt;/service<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;service</span> <span class="re0">id</span>=<span class="st0">&quot;newsletter_manager&quot;</span> <span class="re0">class</span>=<span class="st0">&quot;%newsletter_manager.class%&quot;</span><span class="re2">&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;call</span> <span class="re0">method</span>=<span class="st0">&quot;setMailer&quot;</span><span class="re2">&gt;</span></span>
             <span class="sc3"><span class="re1">&lt;argument</span> <span class="re0">type</span>=<span class="st0">&quot;service&quot;</span> <span class="re0">id</span>=<span class="st0">&quot;my_mailer&quot;</span> <span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;/call<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/service<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/services<span class="re2">&gt;</span></span></span></pre>
</div>
</div>


<div class="tab-pane" id="tab_3_c07b6">
<div class="code php">
<pre class="php"><span class="co1">// src/Acme/HelloBundle/Resources/config/services.php</span>
<span class="kw2">use</span> Symfony\Component\DependencyInjection\Definition<span class="sy0">;</span>
<span class="kw2">use</span> Symfony\Component\DependencyInjection\Reference<span class="sy0">;</span>
&nbsp;
<span class="co1">// ...</span>
<span class="re0">$container</span><span class="sy0">-&gt;</span><span class="me1">setParameter</span><span class="br0">&#40;</span>
    <span class="st_h">'newsletter_manager.class'</span><span class="sy0">,</span>
    <span class="st_h">'Acme\HelloBundle\Newsletter\NewsletterManager'</span>
<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="re0">$container</span><span class="sy0">-&gt;</span><span class="me1">setDefinition</span><span class="br0">&#40;</span><span class="st_h">'my_mailer'</span><span class="sy0">,</span> <span class="sy0">...</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="re0">$container</span><span class="sy0">-&gt;</span><span class="me1">setDefinition</span><span class="br0">&#40;</span><span class="st_h">'newsletter_manager'</span><span class="sy0">,</span> <span class="kw2">new</span> Definition<span class="br0">&#40;</span>
    <span class="st_h">'%newsletter_manager.class%'</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">-&gt;</span><span class="me1">addMethodCall</span><span class="br0">&#40;</span><span class="st_h">'setMailer'</span><span class="sy0">,</span> <span class="kw3">array</span><span class="br0">&#40;</span>
    <span class="kw2">new</span> Reference<span class="br0">&#40;</span><span class="st_h">'my_mailer'</span><span class="br0">&#41;</span><span class="sy0">,</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>
</div>

  </div>
</div>

<div class="admonition note"><p><strong class="title">Nota</strong> Los dos métodos anteriores se denominan inyección en el constructor (<em>constructor injection</em>) e inyección por método <em>setter</em> (<em>setter injection</em>). El contenedor de servicios de Symfony2 también soporta la inyección mediante las propiedades de la clase (<em>property injection</em>).</p></div>

<h3 id="inyectando_la_peticion">16.6.3. Inyectando la petición</h3>

<p>A partir de la versión 2.4 de Symfony, en vez de inyectar el servicio <code>request</code> en tus servicios, deberías inyectar el servicio <code>request_stack</code> y obtener la petición mediante el método <code>getCurrentRequest()</code>:</p>

<div class="code php">
<pre class="php"><span class="kw2">namespace</span> Acme\HelloBundle\Newsletter<span class="sy0">;</span>
&nbsp;
<span class="kw2">use</span> Symfony\Component\HttpFoundation\RequestStack<span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> NewsletterManager
<span class="br0">&#123;</span>
    <span class="kw2">protected</span> <span class="re0">$requestStack</span><span class="sy0">;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> __construct<span class="br0">&#40;</span>RequestStack <span class="re0">$requestStack</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">requestStack</span> <span class="sy0">=</span> <span class="re0">$requestStack</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="kw2">public</span> <span class="kw2">function</span> anyMethod<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="re0">$request</span> <span class="sy0">=</span> <span class="re0">$this</span><span class="sy0">-&gt;</span><span class="me1">requestStack</span><span class="sy0">-&gt;</span><span class="me1">getCurrentRequest</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
        <span class="co1">// ... do something with the request</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">// ...</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Para inyectar el servicio <code>request_stack</code>, utiliza la misma sintaxis que para cualquier otro servicio:</p>

<div class="tabbable">
  <ul class="nav nav-tabs"><li id="select_tab_1_c095c" class="active"><a data-toggle="tab active" href="#select_tab_1_c095c" onclick="document.getElementById('select_tab_1_c095c').className='active'; document.getElementById('tab_1_c095c').className='tab-pane active';document.getElementById('select_tab_2_c095c').className='';  document.getElementById('tab_2_c095c').className='tab-pane';document.getElementById('select_tab_3_c095c').className='';  document.getElementById('tab_3_c095c').className='tab-pane';return false;">YAML</a></li><li id="select_tab_2_c095c"><a data-toggle="tab" href="#select_tab_2_c095c" onclick="document.getElementById('select_tab_1_c095c').className='';  document.getElementById('tab_1_c095c').className='tab-pane';document.getElementById('select_tab_2_c095c').className='active'; document.getElementById('tab_2_c095c').className='tab-pane active';document.getElementById('select_tab_3_c095c').className='';  document.getElementById('tab_3_c095c').className='tab-pane';return false;">XML</a></li><li id="select_tab_3_c095c"><a data-toggle="tab" href="#select_tab_3_c095c" onclick="document.getElementById('select_tab_1_c095c').className='';  document.getElementById('tab_1_c095c').className='tab-pane';document.getElementById('select_tab_2_c095c').className='';  document.getElementById('tab_2_c095c').className='tab-pane';document.getElementById('select_tab_3_c095c').className='active'; document.getElementById('tab_3_c095c').className='tab-pane active';return false;">PHP</a></li></ul>
  <div class="tab-content">
    <div class="tab-pane active" id="tab_1_c095c">
<div class="code yaml">
<pre class="yaml"><span class="co1"># src/Acme/HelloBundle/Resources/config/services.yml</span><span class="co4">
services</span>:<span class="co4">
    newsletter_manager</span>:<span class="co3">
        class</span><span class="sy2">: </span>    Acme\HelloBundle\Newsletter\NewsletterManager<span class="co3">
        arguments</span><span class="sy2">: </span><span class="br0">&#91;</span><span class="st0">&quot;@request_stack&quot;</span><span class="br0">&#93;</span></pre>
</div>
</div>


<div class="tab-pane" id="tab_2_c095c">
<div class="code xml">
<pre class="xml"><span class="sc-1">&lt;!-- src/Acme/HelloBundle/Resources/config/services.xml --&gt;</span>
<span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;UTF-8&quot;</span> <span class="re2">?&gt;</span></span>
<span class="sc3"><span class="re1">&lt;container</span> <span class="re0">xmlns</span>=<span class="st0">&quot;http://symfony.com/schema/dic/services&quot;</span></span>
<span class="sc3">    <span class="re0">xmlns:xsi</span>=<span class="st0">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="sc3">    <span class="re0">xsi:schemaLocation</span>=<span class="st0">&quot;http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd&quot;</span><span class="re2">&gt;</span></span>
&nbsp;
    <span class="sc3"><span class="re1">&lt;services<span class="re2">&gt;</span></span></span>
        <span class="sc3"><span class="re1">&lt;service</span></span>
<span class="sc3">            <span class="re0">id</span>=<span class="st0">&quot;newsletter_manager&quot;</span></span>
<span class="sc3">            <span class="re0">class</span>=<span class="st0">&quot;Acme\HelloBundle\Newsletter\NewsletterManager&quot;</span></span>
<span class="sc3">        <span class="re2">&gt;</span></span>
            <span class="sc3"><span class="re1">&lt;argument</span> <span class="re0">type</span>=<span class="st0">&quot;service&quot;</span> <span class="re0">id</span>=<span class="st0">&quot;request_stack&quot;</span><span class="re2">/&gt;</span></span>
        <span class="sc3"><span class="re1">&lt;/service<span class="re2">&gt;</span></span></span>
    <span class="sc3"><span class="re1">&lt;/services<span class="re2">&gt;</span></span></span>
<span class="sc3"><span class="re1">&lt;/container<span class="re2">&gt;</span></span></span></pre>
</div>
</div>


<div class="tab-pane" id="tab_3_c095c">
<div class="code php">
<pre class="php"><span class="co1">// src/Acme/HelloBundle/Resources/config/services.php</span>
<span class="kw2">use</span> Symfony\Component\DependencyInjection\Definition<span class="sy0">;</span>
<span class="kw2">use</span> Symfony\Component\DependencyInjection\Reference<span class="sy0">;</span>
&nbsp;
<span class="co1">// ...</span>
<span class="re0">$container</span><span class="sy0">-&gt;</span><span class="me1">setDefinition</span><span class="br0">&#40;</span><span class="st_h">'newsletter_manager'</span><span class="sy0">,</span> <span class="kw2">new</span> Definition<span class="br0">&#40;</span>
    <span class="st_h">'Acme\HelloBundle\Newsletter\NewsletterManager'</span><span class="sy0">,</span>
    <span class="kw3">array</span><span class="br0">&#40;</span><span class="kw2">new</span> Reference<span class="br0">&#40;</span><span class="st_h">'request_stack'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre>
</div>
</div>

  </div>
</div>

<div class="admonition sidebar"><p><strong class="title"> ¿Por qué no se debe inyectar el servicio <code>request</code>?</strong> La mayoría de servicios propios de Symfony2 funcionan de la siguiente manera: el contenedor instancia una sola vez la clase del servicio y devuelve esa misma instancia cada vez que la aplicación solicita el servicio o cada vez que se inyecta en otros servicios.</p>

<p>De todos los servicios propios de Symfony2, el único que no sigue este comportamiento es el servicio <code>request</code>. Si tratas de inyectar el servicio <code>request</code> en otro servicio, seguramente te encontrarás con una excepción de tipo <code>Symfony\Component\DependencyInjection\Exception\ScopeWideningInjectionException</code>. El motivo es que la respuesta puede cambiar durante el tiempo de vida del contendor, por ejemplo cuando se crea una sub-petición dentro de una página.</p></div>

<div class="admonition tip"><p><strong class="title">Truco</strong> Si defines un controlador como servicio, puedes obtener el objeto <code>Request</code> que representa a la petición sin tener que inyectar el contenedor o sin tener que pasarlo como argumento del método de tu acción. Consulta la sección <a href="http://symfony.com/doc/current/book/controller.html#book-controller-request-argument">The Request as a Controller Argument¶</a> para saber cómo hacerlo.</p></div>



            <div class="module module-ad module-ad-responsive module-ad-bottom">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-pager">
        <ul class="row pager">
            <li class="col-xs-6 previous ">
                                    <a href="../capitulo_16/importando_otros_recursos_para_configurar_el_contenedor.html">
                        <strong>&larr; Anterior</strong>
                        <small>16.5. Importando otros recursos para configurar el contenedor</small>
                    </a>
                            </li>

            <li class="col-xs-6 next ">
                                    <a href="../capitulo_16/inyectando_servicios_opcionales.html">
                        <strong>Siguiente &rarr;</strong>
                        <small>16.7. Inyectando servicios opcionales</small>
                    </a>
                            </li>
        </ul>
    </div>

                        </div>

                    <div id="sidebar" class="col-sm-3">
                        
            <div class="module module-share">
        <h3>Compartir</h3>
        <ul>
    <li><a id="share_twitter" href="#" title="Compartir en Twitter">Twitter</a></li>
    <li><a id="share_facebook" href="#" title="Compartir en Facebook">Facebook</a></li>
    <li><a id="share_google" href="#" title="Compartir en Google+">Google+</a></li>
</ul>

<script type="text/javascript">
var title    = '{{ item_social_title }}';
var page_url = encodeURIComponent(window.location);
var options  = 'menubar=no,toolbar=no,resizable=yes,scrollbars=no,width=640,height=350';
var services = {
    share_twitter:  'https://twitter.com/share?text=' + title + '&lang=es',
    share_facebook: 'http://www.facebook.com/sharer.php?u=' + page_url + '&t=' + title,
    share_google:   'https://plus.google.com/share?url=' + page_url + '&hl=es'
};

for (var id in services) {
    if (services.hasOwnProperty(id)) {
        document.getElementById(id).href = services[id];
        document.getElementById(id).onclick = function(a) {
            a = a || window.event;
            a = a.target || a.srcElement;

            ga('send', 'social', {
                'socialNetwork' : a.id.substr(6),
                'socialAction'  : 'share',
                'socialTarget'  : window.location
            });

            window.open(services[a.id], a.title, options);

            return false;
        };
    }
}
</script>

    </div>

            <div class="module module-ad module-ad-responsive module-ad-sidebar">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-1491000300253750"
         data-ad-slot="3770792827"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>

    
    <div id="book-toc" class="module">
        <a id="indice"></a>

        <h3>Indice de contenidos</h3>
        <ul class="toc text-links">
                                            <li class="level-1">
                <span>1.</span> <a href="../capitulo_1.html"> Symfony2 y los fundamentos de HTTP</a>
            </li>
                                                                                                                            <li class="level-1">
                <span>2.</span> <a href="../capitulo_2.html"> De PHP a Symfony2</a>
            </li>
                                                                                                            <li class="level-1">
                <span>3.</span> <a href="../capitulo_3.html"> Instalando y configurando Symfony2</a>
            </li>
                                                                                            <li class="level-1">
                <span>4.</span> <a href="../capitulo_4.html"> Creando páginas en Symfony2</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>5.</span> <a href="../capitulo_5.html"> El controlador</a>
            </li>
                                                                                                                                                                                                            <li class="level-1">
                <span>6.</span> <a href="../capitulo_6.html"> El enrutamiento</a>
            </li>
                                                                                                                                                                                            <li class="level-1">
                <span>7.</span> <a href="../capitulo_7.html"> Creando y utilizando plantillas</a>
            </li>
                                                                                                                                                                                                                                                                            <li class="level-1">
                <span>8.</span> <a href="../capitulo_8.html"> La base de datos y Doctrine</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>9.</span> <a href="../capitulo_9.html"> La base de datos y Propel</a>
            </li>
                                            <li class="level-1">
                <span>10.</span> <a href="../capitulo_10.html"> Tests unitarios y funcionales</a>
            </li>
                                                                                                                                            <li class="level-1">
                <span>11.</span> <a href="../capitulo_11.html"> Validación</a>
            </li>
                                                                                                                                                                                            <li class="level-1">
                <span>12.</span> <a href="../capitulo_12.html"> Formularios</a>
            </li>
                                                                                                                                                                                                                                                                            <li class="level-1">
                <span>13.</span> <a href="../capitulo_13.html"> Seguridad</a>
            </li>
                                                                                                                                                                                                                                            <li class="level-1">
                <span>14.</span> <a href="../capitulo_14.html"> La caché de HTTP</a>
            </li>
                                                                                                                                                            <li class="level-1">
                <span>15.</span> <a href="../capitulo_15.html"> Internacionalización</a>
            </li>
                                                                                                                                                                                                                            <li class="level-1 ">
                <a href="../capitulo_16.html">
                    <span>Capítulo 16.</span> El contenedor de servicios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_16/que_es_un_servicio.html">
                    <span>16.1.</span> ¿Qué es un servicio?
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_16/que_es_un_contenedor_de_servicios.html">
                    <span>16.2.</span> ¿Qué es un contenedor de servicios?
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_16/creando_y_configurando_servicios_en_el_contenedor.html">
                    <span>16.3.</span> Creando y configurando servicios en el contenedor
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_16/parametros_de_servicio.html">
                    <span>16.4.</span> Parámetros de servicio
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_16/importando_otros_recursos_para_configurar_el_contenedor.html">
                    <span>16.5.</span> Importando otros recursos para configurar el contenedor
                </a>
            </li>
                                            <li class="level-2 active">
                <a href="../capitulo_16/inyectando_servicios.html">
                    <span>16.6.</span> Inyectando servicios
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_16/inyectando_servicios_opcionales.html">
                    <span>16.7.</span> Inyectando servicios opcionales
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_16/servicios_internos_de_symfony_y_servicios_de_bundles_de_terceros.html">
                    <span>16.8.</span> Servicios internos de Symfony y servicios de <em>bundles</em> de terceros
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_16/etiquetas.html">
                    <span>16.9.</span> Etiquetas
                </a>
            </li>
                                            <li class="level-2 ">
                <a href="../capitulo_16/depurando_servicios.html">
                    <span>16.10.</span> Depurando servicios
                </a>
            </li>
                                            <li class="level-1">
                <span>17.</span> <a href="../capitulo_17.html"> Mejorando el rendimiento</a>
            </li>
                                                                                                            <li class="level-1">
                <span>18.</span> <a href="../capitulo_18.html"> El interior de Symfony2</a>
            </li>
                                                                                                            <li class="level-1">
                <span>19.</span> <a href="../capitulo_19.html"> La API estable de Symfony2</a>
            </li>
                        </ul>
    </div>
                    </div>
                            </div>

            <div id="footer">
                <div class="row">
                    <div class="col-xs-12 col-sm-9">
                        &copy; 2015 LibrosWeb.es
                        <a href="/sitio/contacto">Contacto</a>
                        <a href="https://plus.google.com/+librosweb">Novedades</a>
                        <a href="/sitio/condiciones">Condiciones</a>
                        <a href="/sitio/privacidad">Privacidad</a>
                    </div>
                    <div class="col-xs-12 col-sm-3 uptime">
                        3.111 días online
                    </div>
                </div>
            </div>

        </div>

                                    <script src="/js/app.js"></script>
            
            <script type="text/javascript">
                console.log($(window).width());
            </script>
            </body>
</html>
